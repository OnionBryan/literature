<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Strength of Weak Ties - Granovetter (1973)</title>
    <!--
      Review of:
      Granovetter, M. S. (1973).
      The Strength of Weak Ties.
      American Journal of Sociology, 78(6), 1360-1380.

      This is a PROCESS MODEL explaining the mechanism by which weak social ties
      provide advantages in information diffusion and opportunity access.
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e8ba3 100%);
            color: #333;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Typography */
        h1, h2, h3, .definition-term, .result-box-label, .card h4, .breakdown-header {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }

        /* Page Navigation */
        .page-nav-container {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .page-nav {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .page-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            font-family: 'Lato', sans-serif;
            font-weight: 700;
        }

        .page-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .page-btn.active {
            background: white;
            color: #1e3c72;
            border-color: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            text-align: center;
            color: white;
            padding: 60px 20px;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 40px;
            animation: fadeIn 1s ease;
        }

        .header h1 {
            font-size: 3.2em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, #ffffff, #d4e9fd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            font-size: 1.4em;
            opacity: 0.95;
            margin-bottom: 10px;
        }

        .header .stats-preview {
            font-size: 1.1em;
            background: rgba(255,255,255,0.1);
            display: inline-block;
            padding: 10px 25px;
            border-radius: 25px;
            margin-top: 15px;
        }

        /* Section Styles */
        .section {
            background: #fdfdff;
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.8s ease;
        }

        .section h2 {
            color: #1e3c72;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 4px solid #1e3c72;
            font-size: 2.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 {
            color: #2a5298;
            margin: 25px 0 15px;
            font-size: 1.6em;
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        /* Card Styles */
        .card {
            background: #ffffff;
            padding: 25px;
            border-radius: 15px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            border-top: 4px solid #2a5298;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 24px rgba(30,60,114,0.15);
            border-color: #2a5298;
        }

        .card h4 {
            color: #1e3c72;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* Stat Box Styles */
        .stat-box {
            background: linear-gradient(135deg, #1d3557 0%, #457b9d 100%);
            color: #f1faee;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-box::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(30,60,114,0.4);
        }

        .stat-value {
            font-size: 2.8em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 1.1em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        /* Key Finding Box */
        .key-finding {
            background: linear-gradient(135deg, #e67e22 0%, #f39c12 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            font-size: 1.15em;
            box-shadow: 0 8px 20px rgba(230, 126, 34, 0.3);
            border-left: 5px solid #d35400;
        }

        /* Insight Box */
        .insight-box {
            background: linear-gradient(135deg, #005f73 0%, #0a9396 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 20px rgba(0, 95, 115, 0.3);
        }

        /* Tab System */
        .tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: #f0f4f8;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 700;
            font-family: 'Lato', sans-serif;
        }

        .tab:hover {
            background: #e0e6ed;
            transform: translateY(-2px);
        }

        .tab.active {
            background: #1e3c72;
            color: white;
            border-color: #1e3c72;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e6ed;
        }

        th {
            background: #1e3c72;
            color: white;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* Process Flow Styles */
        .process-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .process-step {
            display: flex;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .process-step:hover {
            transform: translateX(10px);
            box-shadow: 0 4px 12px rgba(30,60,114,0.2);
        }

        .process-number {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .process-content h4 {
            color: #1e3c72;
            margin-bottom: 8px;
        }

        .process-arrow {
            text-align: center;
            font-size: 2em;
            color: #2a5298;
            margin: 10px 0;
        }

        /* Network Visualization */
        .network-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .network-svg {
            max-width: 100%;
            height: auto;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1001;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .dark-mode-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }

        body.dark-mode .section {
            background: #1e293b;
            color: #e2e8f0;
        }

        body.dark-mode .section h2,
        body.dark-mode .section h3 {
            color: #60a5fa;
        }

        body.dark-mode .card {
            background: #0f172a;
            color: #e2e8f0;
            border-top-color: #60a5fa;
        }

        body.dark-mode .card h4 {
            color: #93c5fd;
        }

        body.dark-mode .process-step {
            background: #0f172a;
            color: #e2e8f0;
        }

        body.dark-mode .process-content h4 {
            color: #93c5fd;
        }

        body.dark-mode table {
            background: #0f172a;
        }

        body.dark-mode th {
            background: #1e3c72;
        }

        body.dark-mode td {
            color: #e2e8f0;
        }

        body.dark-mode tr:hover {
            background: #334155;
        }

        body.dark-mode .tab {
            background: #334155;
            color: #e2e8f0;
            border-color: #475569;
        }

        body.dark-mode .tab.active {
            background: #3b82f6;
            border-color: #3b82f6;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Attribution */
        .attribution {
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-top: 40px;
        }

        .attribution a {
            color: #93c5fd;
            text-decoration: none;
            font-weight: 700;
        }

        .attribution a:hover {
            text-decoration: underline;
        }

        /* Network Simulator Styles */
        .network-simulator {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        body.dark-mode .network-simulator {
            background: #0f172a;
        }

        .simulator-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-btn {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(30, 60, 114, 0.3);
            font-family: 'Lato', sans-serif;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(30, 60, 114, 0.4);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .control-btn.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }

        .control-btn.secondary {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
        }

        .control-btn.danger {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
        }

        .control-btn.edge-type-btn {
            padding: 10px 20px;
            font-size: 0.9em;
        }

        /* Timeline Scrubber Styling */
        #timeline-scrubber {
            -webkit-appearance: none;
            appearance: none;
        }

        #timeline-scrubber::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.5);
            transition: all 0.2s ease;
        }

        #timeline-scrubber::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.7);
        }

        #timeline-scrubber::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.5);
            transition: all 0.2s ease;
        }

        #timeline-scrubber::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.7);
        }

        #networkCanvas {
            width: 100%;
            height: 600px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            cursor: default;
            display: block;
        }

        body.dark-mode #networkCanvas {
            background: #1e293b;
        }

        .network-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 25px;
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #2a5298;
            transition: all 0.3s ease;
        }

        body.dark-mode .metric-card {
            background: #334155;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .metric-label {
            font-size: 0.8em;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        body.dark-mode .metric-label {
            color: #94a3b8;
        }

        .metric-value {
            font-size: 2em;
            font-weight: 700;
            color: #1e3c72;
            font-family: 'Playfair Display', serif;
        }

        body.dark-mode .metric-value {
            color: #93c5fd;
        }

        .legend {
            display: flex;
            gap: 25px;
            margin-top: 20px;
            padding: 18px;
            background: white;
            border-radius: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        body.dark-mode .legend {
            background: #334155;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95em;
            font-weight: 500;
        }

        .legend-line {
            width: 40px;
            height: 3px;
            border-radius: 2px;
        }

        .legend-line.strong {
            background: #1e3c72;
            height: 4px;
        }

        .legend-line.weak {
            height: 2px;
            border-top: 2px dashed #94a3b8;
            background: none;
        }

        .help-text {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            font-size: 0.95em;
        }

        body.dark-mode .help-text {
            background: rgba(255, 193, 7, 0.1);
            border-left-color: #fbbf24;
            color: #e2e8f0;
        }

        /* Phase 2.1: Triadic Closure Animation - Dark Mode */
        body.dark-mode #triad-animation {
            filter: brightness(0.9);
        }

        /* Phase 2.1: Gradient container backgrounds */
        body.dark-mode .section > div[style*="background: linear-gradient(135deg, #f8f9fa"] {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%) !important;
        }

        /* Phase 2.1: White animation and metrics containers */
        body.dark-mode .section div[style*="background: white"] {
            background: #0f172a !important;
            color: #e2e8f0 !important;
        }

        /* Phase 2.1: Timeline scrubber background */
        body.dark-mode div[style*="background: #f1f5f9"] {
            background: #334155 !important;
        }

        /* Phase 2.1: What If builder - yellow gradient to dark */
        body.dark-mode #whatif-builder {
            background: linear-gradient(135deg, #422006 0%, #713f12 100%) !important;
            border-color: #d97706 !important;
        }

        body.dark-mode #whatif-builder h3 {
            color: #fbbf24 !important;
        }

        body.dark-mode #whatif-builder p {
            color: #fde68a !important;
        }

        body.dark-mode #whatif-builder h4 {
            color: #e2e8f0 !important;
        }

        /* Phase 2.1: What If connection cards */
        body.dark-mode #whatif-builder div[style*="background: white"] {
            background: #1e293b !important;
        }

        /* Phase 2.1: What If prediction panel */
        body.dark-mode #whatif-prediction {
            background: #1e293b !important;
        }

        body.dark-mode #whatif-prediction h4 {
            color: #a78bfa !important;
        }

        body.dark-mode #whatif-prediction-text {
            color: #cbd5e1 !important;
        }

        /* Phase 2.1: Quick presets background */
        body.dark-mode #whatif-builder div[style*="background: rgba(255,255,255,0.7)"] {
            background: rgba(30, 41, 59, 0.7) !important;
        }

        /* Phase 2.1: Scenario comparison cards - red/green backgrounds */
        body.dark-mode div[style*="background: #fef2f2"] {
            background: rgba(220, 38, 38, 0.1) !important;
            border-color: #ef4444 !important;
        }

        body.dark-mode div[style*="background: #f0fdf4"] {
            background: rgba(22, 163, 74, 0.1) !important;
            border-color: #22c55e !important;
        }

        body.dark-mode div[style*="background: #eff6ff"] {
            background: rgba(37, 99, 235, 0.1) !important;
            border-color: #3b82f6 !important;
        }

        /* Phase 2.1: Live metrics color coding */
        body.dark-mode div[style*="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)"] {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(37, 99, 235, 0.15) 100%) !important;
        }

        body.dark-mode div[style*="background: linear-gradient(135deg, #fef3c7 0%, #fef08a 100%)"] {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(217, 119, 6, 0.15) 100%) !important;
        }

        body.dark-mode div[style*="background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)"] {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%) !important;
        }

        body.dark-mode div[style*="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)"] {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(22, 163, 74, 0.15) 100%) !important;
        }

        /* Phase 2.2: Information Diffusion - Dark Mode */
        body.dark-mode #diffusion-canvas {
            background: #1e293b !important;
        }

        /* Phase 2.2: Diffusion control panels */
        body.dark-mode div[style*="padding: 25px"][style*="background: #ffffff"] {
            background: #0f172a !important;
        }

        /* Phase 2.2: Diffusion metrics badges */
        body.dark-mode div[style*="background: #fee2e2"] {
            background: rgba(239, 68, 68, 0.1) !important;
            border-color: #ef4444 !important;
        }

        body.dark-mode div[style*="background: #dcfce7"] {
            background: rgba(34, 197, 94, 0.1) !important;
            border-color: #22c55e !important;
        }

        body.dark-mode div[style*="background: #dbeafe"] {
            background: rgba(59, 130, 246, 0.1) !important;
            border-color: #3b82f6 !important;
        }

        body.dark-mode div[style*="background: #fef3c7"] {
            background: rgba(245, 158, 11, 0.1) !important;
            border-color: #f59e0b !important;
        }

        /* Phase 2.3: Bridge Identification - Dark Mode */
        body.dark-mode #bridge-canvas {
            background: #1e293b !important;
        }

        /* Phase 2.3: Bridge metrics and selection panels */
        body.dark-mode div[style*="background: linear-gradient(135deg, #f3e8ff"] {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(124, 58, 237, 0.15) 100%) !important;
        }

        /* General: All inline styled divs with white backgrounds in sections */
        body.dark-mode .section > div > div[style*="background: #ffffff"],
        body.dark-mode .section > div > div[style*="background: white"] {
            background: #0f172a !important;
        }

        /* General: Text colors for inline styled elements */
        body.dark-mode div[style*="color: #64748b"] {
            color: #94a3b8 !important;
        }

        body.dark-mode div[style*="color: #4b5563"] {
            color: #cbd5e1 !important;
        }

        body.dark-mode div[style*="color: #1f2937"] {
            color: #e2e8f0 !important;
        }

        body.dark-mode h4[style*="color: #1f2937"] {
            color: #e2e8f0 !important;
        }

        body.dark-mode h4[style*="color: #1e3c72"] {
            color: #60a5fa !important;
        }

        body.dark-mode p[style*="color: #4b5563"] {
            color: #cbd5e1 !important;
        }

        body.dark-mode p[style*="color: #64748b"] {
            color: #94a3b8 !important;
        }

        /* SVG canvas backgrounds in all Phase 2 tools */
        body.dark-mode svg[style*="background: white"] {
            background: #1e293b !important;
        }

        /* Control panel backgrounds (#f8fafc and #f8f9fa) */
        body.dark-mode div[style*="background: #f8fafc"],
        body.dark-mode div[style*="background: #f8f9fa"] {
            background: #1e293b !important;
        }

        /* Speed control panels (white backgrounds inside controls) */
        body.dark-mode div[style*="background: white"][style*="box-shadow: 0 2px 8px"] {
            background: #334155 !important;
        }

        /* Phase 2.3: Instruction banner - light blue gradient */
        body.dark-mode div[style*="background: linear-gradient(135deg, #dbeafe"] {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(37, 99, 235, 0.15) 100%) !important;
        }

        body.dark-mode div[style*="color: #1e40af"] {
            color: #60a5fa !important;
        }

        body.dark-mode div[style*="color: #1e3a8a"] {
            color: #93c5fd !important;
        }

        body.dark-mode h4[style*="color: #1e40af"] {
            color: #60a5fa !important;
        }

        body.dark-mode p[style*="color: #1e3a8a"] {
            color: #93c5fd !important;
        }

        /* Information Diffusion & Bridge metrics panels - right side */
        body.dark-mode .section div[style*="grid-template-columns: 3fr 1fr"] > div[style*="background: white"] {
            background: #0f172a !important;
        }

        /* Color-coded small backgrounds within metrics */
        body.dark-mode div[style*="background: #f5f3ff"] {
            background: rgba(139, 92, 246, 0.1) !important;
        }

        body.dark-mode div[style*="background: #fffbeb"] {
            background: rgba(245, 158, 11, 0.1) !important;
            border-left-color: #f59e0b !important;
        }

        body.dark-mode div[style*="color: #92400e"] {
            color: #fde68a !important;
        }

        body.dark-mode h4[style*="color: #6d28d9"] {
            color: #a78bfa !important;
        }

        body.dark-mode h4[style*="color: #dc2626"] {
            color: #fca5a5 !important;
        }

        body.dark-mode h4[style*="color: #16a34a"] {
            color: #86efac !important;
        }

        body.dark-mode h4[style*="color: #2563eb"] {
            color: #60a5fa !important;
        }

        /* Legend boxes inside SVGs */
        body.dark-mode svg rect[fill="white"] {
            fill: #1e293b !important;
        }

        /* SVG text colors */
        body.dark-mode svg text[fill="#374151"],
        body.dark-mode svg text[fill="#6b7280"] {
            fill: #cbd5e1 !important;
        }

        /* About These Interactive Tools section - specific panels */
        body.dark-mode div[style*="background: white"][style*="border: 2px solid #fbbf24"] {
            background: #1e293b !important;
        }

        body.dark-mode div[style*="background: #fffbeb"] {
            background: rgba(245, 158, 11, 0.1) !important;
        }

        body.dark-mode div[style*="background: white"][style*="border: 2px solid #e0e6ed"] {
            background: #0f172a !important;
        }

        /* Section with yellow gradient background */
        body.dark-mode .section[style*="background: linear-gradient(135deg, #fff9e6"] {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(217, 119, 6, 0.1) 100%) !important;
        }

        /* Green research-backed panel */
        body.dark-mode div[style*="background: #f0fdf4"][style*="border-left: 4px solid #10b981"] {
            background: rgba(34, 197, 94, 0.1) !important;
        }

        body.dark-mode div[style*="background: #f0fdf4"][style*="border-left: 4px solid #10b981"] h3 {
            color: #86efac !important;
        }

        body.dark-mode div[style*="background: #f0fdf4"][style*="border-left: 4px solid #10b981"] p,
        body.dark-mode div[style*="background: #f0fdf4"][style*="border-left: 4px solid #10b981"] li {
            color: #cbd5e1 !important;
        }

        /* Red illustrative panel */
        body.dark-mode div[style*="background: #fef2f2"][style*="border-left: 4px solid #ef4444"] {
            background: rgba(239, 68, 68, 0.1) !important;
        }

        body.dark-mode div[style*="background: #fef2f2"][style*="border-left: 4px solid #ef4444"] h3 {
            color: #fca5a5 !important;
        }

        body.dark-mode div[style*="background: #fef2f2"][style*="border-left: 4px solid #ef4444"] p,
        body.dark-mode div[style*="background: #fef2f2"][style*="border-left: 4px solid #ef4444"] li {
            color: #cbd5e1 !important;
        }

        /* Research foundation white panel */
        body.dark-mode div[style*="background: white"][style*="padding: 20px"][style*="border-radius: 12px"][style*="border: 2px solid #e0e6ed"] {
            background: #0f172a !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 20px"][style*="border-radius: 12px"][style*="border: 2px solid #e0e6ed"] h3 {
            color: #60a5fa !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 20px"][style*="border-radius: 12px"][style*="border: 2px solid #e0e6ed"] p {
            color: #cbd5e1 !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 20px"][style*="border-radius: 12px"][style*="border: 2px solid #e0e6ed"] strong {
            color: #e2e8f0 !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 20px"][style*="border-radius: 12px"][style*="border: 2px solid #e0e6ed"] span[style*="color: #64748b"] {
            color: #94a3b8 !important;
        }

        /* Calculator panels - Job Search */
        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"][style*="border-left: 5px solid #2a5298"] {
            background: #0f172a !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"][style*="margin-bottom: 25px"] {
            background: #0f172a !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"] h3 {
            color: #60a5fa !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"] h3[style*="color: #1e3c72"] {
            color: #60a5fa !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"] p {
            color: #cbd5e1 !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"] label {
            color: #cbd5e1 !important;
        }

        body.dark-mode div[style*="background: white"][style*="padding: 25px"][style*="border-radius: 12px"] p[style*="color: #64748b"] {
            color: #94a3b8 !important;
        }

        /* Small white boxes inside scenarios */
        body.dark-mode div[style*="padding: 10px"][style*="background: white"][style*="border-radius: 6px"] {
            background: #1e293b !important;
        }

        body.dark-mode div[style*="padding: 10px"][style*="background: white"][style*="border-radius: 6px"] strong {
            color: #e2e8f0 !important;
        }

        /* What If scenario white boxes */
        body.dark-mode div[style*="padding: 20px"][style*="background: white"][style*="border-radius: 10px"][style*="box-shadow: 0 2px 8px"] {
            background: #1e293b !important;
        }

        body.dark-mode div[style*="padding: 20px"][style*="background: white"][style*="border-radius: 10px"][style*="box-shadow: 0 2px 8px"] h4 {
            color: #e2e8f0 !important;
        }

        .quality-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            color: white;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: linear-gradient(135deg, #e67e22 0%, #f39c12 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(230, 126, 34, 0.3);
        }

        .preset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 126, 34, 0.4);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .section h2 {
                font-size: 1.6em;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            #networkCanvas {
                height: 400px;
            }

            .simulator-controls {
                gap: 8px;
            }

            .control-btn {
                padding: 10px 16px;
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()">üåô Dark Mode</button>

    <!-- Page Navigation -->
    <div class="page-nav-container">
        <div class="page-nav">
            <button class="page-btn active" onclick="switchPage('main', this)">Main Study Overview</button>
            <button class="page-btn" onclick="switchPage('process', this)">Process Model & Theory</button>
            <button class="page-btn" onclick="switchPage('analysis', this)">Empirical Findings</button>
            <button class="page-btn" onclick="switchPage('interactive', this)">üéÆ Interactive Tools</button>
        </div>
    </div>

    <!-- MAIN PAGE -->
    <div id="main">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <h1>The Strength of Weak Ties</h1>
                <p class="subtitle">Bridging Social Cliques Through Casual Connections</p>
                <p class="subtitle">Granovetter (1973) - A Process Model</p>
                <div class="stats-preview">
                    üìä 282 Job Seekers | üèÜ One of the Most Cited Papers in Sociology
                </div>
            </div>

            <!-- Key Statistics -->
            <div class="section">
                <h2>üìä Key Empirical Findings</h2>
                <div class="grid">
                    <div class="stat-box">
                        <div class="stat-value">83.4%</div>
                        <div class="stat-label">Found Jobs Through Weak or Moderate Ties</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">16.7%</div>
                        <div class="stat-label">Found Jobs Through Strong Ties (‚â•2x/week contact)</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">282</div>
                        <div class="stat-label">Men Surveyed in Newton, Massachusetts</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">54</div>
                        <div class="stat-label">Found Jobs Through Personal Contacts</div>
                    </div>
                </div>

                <div class="key-finding">
                    <strong>üéØ Core Finding:</strong> Weak ties‚Äîcasual acquaintances seen occasionally or rarely‚Äîwere significantly more helpful than strong ties (close friends and family) in helping people find new jobs. This contradicted the common assumption that close relationships are always more valuable.
                </div>

                <div class="insight-box">
                    <p><strong>üí° Why This Matters:</strong> This paper revolutionized network theory by showing that the structure of social networks, not just the strength of individual relationships, determines access to information and opportunities. It provided the theoretical foundation for understanding how information diffuses through societies and how individuals can access resources beyond their immediate social circle.</p>
                </div>
            </div>

            <!-- Model Type -->
            <div class="section">
                <h2>üîç Model Type: Process Model</h2>
                <p><strong>This is a PROCESS MODEL</strong> rather than a variance model. It explains the <em>mechanism</em> and <em>process</em> by which weak ties provide advantages:</p>

                <div class="grid">
                    <div class="card">
                        <h4>What Process Models Do</h4>
                        <p>Explain <strong>HOW</strong> and <strong>WHY</strong> something happens through a sequence of events or mechanisms. They focus on the underlying process that connects causes to effects.</p>
                    </div>
                    <div class="card">
                        <h4>Granovetter's Process</h4>
                        <p>Explains how <strong>weak ties serve as bridges</strong> between dense social clusters, providing access to <strong>novel, non-redundant information</strong> that strong ties cannot provide due to network overlap.</p>
                    </div>
                    <div class="card">
                        <h4>Key Mechanism</h4>
                        <p><strong>Structural bridging:</strong> Weak ties connect otherwise disconnected groups (local bridges), while strong ties create closed, redundant information networks (forbidden triads).</p>
                    </div>
                </div>
            </div>

            <!-- Core Concepts -->
            <div class="section">
                <h2>üìö Core Theoretical Concepts</h2>

                <div class="grid">
                    <div class="card">
                        <h4>Tie Strength Definition</h4>
                        <p><strong>Definition:</strong> A combination of the amount of time, emotional intensity, intimacy (mutual confiding), and reciprocal services which characterize the tie.</p>
                        <p style="margin-top: 10px;"><strong>Operationalized as:</strong> Frequency of contact</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Strong:</strong> ‚â•2 times per week</li>
                            <li><strong>Moderate:</strong> >1x/year but <2x/week</li>
                            <li><strong>Weak:</strong> ‚â§1 time per year</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>The Forbidden Triad</h4>
                        <p>If person A has strong ties to both B and C, then B and C will almost certainly have a tie to each other (triadic closure). A triad where A-B and A-C are strong but B-C doesn't exist is "forbidden" because it's unstable and rare.</p>
                        <p style="margin-top: 10px;"><strong>Implication:</strong> Strong ties create dense, closed clusters where everyone knows everyone.</p>
                    </div>

                    <div class="card">
                        <h4>Local Bridges</h4>
                        <p><strong>Definition:</strong> A tie between two people that represents the <strong>only path</strong> (or shortest path) connecting their respective social circles.</p>
                        <p style="margin-top: 10px;"><strong>Key insight:</strong> All bridges are weak ties. Strong ties cannot be bridges because the forbidden triad principle ensures redundant paths.</p>
                    </div>

                    <div class="card">
                        <h4>Overlap Principle</h4>
                        <p>The degree of overlap in two individuals' friendship networks varies <strong>directly</strong> with the strength of their tie to one another.</p>
                        <p style="margin-top: 10px;"><strong>Result:</strong> Strong ties = high overlap = redundant information. Weak ties = low overlap = novel information.</p>
                    </div>
                </div>
            </div>

            <!-- Implications -->
            <div class="section">
                <h2>üåç Macro-Level Implications</h2>
                <p>Granovetter's insight connects individual behavior to large-scale social structure:</p>

                <div class="grid">
                    <div class="card">
                        <h4>Information Diffusion</h4>
                        <p>Weak ties are crucial for spreading information across a society. Without them, information would remain trapped in isolated cliques, slowing innovation and social change.</p>
                    </div>

                    <div class="card">
                        <h4>Social Fragmentation</h4>
                        <p>Communities with few weak ties become fragmented into disconnected subgroups. This leads to polarization, miscommunication, and conflict between groups separated by race, class, or geography.</p>
                    </div>

                    <div class="card">
                        <h4>Opportunity & Mobility</h4>
                        <p>Access to opportunities (jobs, resources, ideas) depends on network position. Those with diverse weak ties have systematic advantages over those embedded only in strong-tie networks.</p>
                    </div>

                    <div class="card">
                        <h4>Community Organization</h4>
                        <p>Effective community organizing requires both strong ties (for trust and mobilization) and weak ties (for reaching new people and building coalitions across groups).</p>
                    </div>
                </div>
            </div>

            <!-- Citation & Attribution -->
            <div class="attribution">
                <p><strong>Original Paper:</strong> Granovetter, M. S. (1973). The Strength of Weak Ties. <em>American Journal of Sociology</em>, 78(6), 1360-1380.</p>
                <p style="margin-top: 10px;">
                    <a href="https://doi.org/10.1086/225469" target="_blank">DOI: 10.1086/225469</a> |
                    <a href="https://scholar.google.com/scholar?q=The+Strength+of+Weak+Ties+Granovetter" target="_blank">Google Scholar</a>
                </p>
                <p style="margin-top: 15px; font-size: 0.9em; opacity: 0.8;">
                    Interactive review created for educational purposes. All findings and data from the original publication.
                </p>
            </div>
        </div>
    </div>

    <!-- PROCESS PAGE -->
    <div id="process" style="display: none;">
        <div class="container">
            <div class="header">
                <h1>The Process Model</h1>
                <p class="subtitle">How Weak Ties Create Advantages Through Structural Bridging</p>
            </div>

            <!-- The Process -->
            <div class="section">
                <h2>‚öôÔ∏è The Weak Ties Process Mechanism</h2>
                <p>Granovetter's theory explains a multi-step process by which weak ties provide informational advantages:</p>

                <div class="process-container">
                    <div class="process-step">
                        <div class="process-number">1</div>
                        <div class="process-content">
                            <h4>Network Formation</h4>
                            <p>People naturally form strong ties with close friends and family who share similar backgrounds, interests, and social contexts.</p>
                        </div>
                    </div>

                    <div class="process-arrow">‚Üì</div>

                    <div class="process-step">
                        <div class="process-number">2</div>
                        <div class="process-content">
                            <h4>Triadic Closure Creates Clusters</h4>
                            <p>The "forbidden triad" principle means that when A has strong ties to B and C, B and C will develop a tie. This creates dense, closed clusters of mutual friends.</p>
                        </div>
                    </div>

                    <div class="process-arrow">‚Üì</div>

                    <div class="process-step">
                        <div class="process-number">3</div>
                        <div class="process-content">
                            <h4>Information Redundancy Within Clusters</h4>
                            <p>Because everyone in a strong-tie cluster knows each other (high overlap), they share the same information pool. Information circulates internally but doesn't escape the cluster.</p>
                        </div>
                    </div>

                    <div class="process-arrow">‚Üì</div>

                    <div class="process-step">
                        <div class="process-number">4</div>
                        <div class="process-content">
                            <h4>Weak Ties Act as Bridges</h4>
                            <p>Weak ties (acquaintances, former colleagues) connect to different social clusters. They cannot form redundant paths (no forbidden triads), so they serve as unique bridges.</p>
                        </div>
                    </div>

                    <div class="process-arrow">‚Üì</div>

                    <div class="process-step">
                        <div class="process-number">5</div>
                        <div class="process-content">
                            <h4>Novel Information Access</h4>
                            <p>When seeking information (e.g., job openings), weak ties provide access to knowledge circulating in different social circles‚Äîinformation your close friends don't have.</p>
                        </div>
                    </div>

                    <div class="process-arrow">‚Üì</div>

                    <div class="process-step">
                        <div class="process-number">6</div>
                        <div class="process-content">
                            <h4>Advantage Realization</h4>
                            <p>Individuals with diverse weak-tie bridges gain systematic advantages: more job leads, faster access to innovations, greater influence across groups.</p>
                        </div>
                    </div>
                </div>

                <div class="insight-box">
                    <h3 style="margin-top: 0;">üîë The Core Mechanism</h3>
                    <p>The advantage of weak ties comes from their <strong>structural position</strong> in the network, not from the relationship itself. Weak ties provide access to <strong>non-redundant information</strong> because they bridge <strong>otherwise disconnected social clusters</strong>. Strong ties, despite being emotionally closer, provide <strong>redundant information</strong> because triadic closure creates overlap in what everyone already knows.</p>
                </div>
            </div>

            <!-- Visual Network Comparison -->
            <div class="section">
                <h2>üï∏Ô∏è Visual Comparison: Strong vs. Weak Tie Networks</h2>

                <div class="grid">
                    <div class="card">
                        <h4>Strong Tie Network (Closed Cluster)</h4>
                        <div class="network-container">
                            <svg class="network-svg" viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg">
                                <!-- Dense cluster with all connections -->
                                <line x1="150" y1="100" x2="100" y2="150" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="150" y1="100" x2="200" y2="150" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="150" y1="100" x2="150" y2="200" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="100" y1="150" x2="200" y2="150" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="100" y1="150" x2="150" y2="200" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="200" y1="150" x2="150" y2="200" stroke="#e74c3c" stroke-width="4"/>

                                <!-- Nodes -->
                                <circle cx="150" cy="100" r="15" fill="#c0392b"/>
                                <circle cx="100" cy="150" r="15" fill="#c0392b"/>
                                <circle cx="200" cy="150" r="15" fill="#c0392b"/>
                                <circle cx="150" cy="200" r="15" fill="#c0392b"/>

                                <!-- Labels -->
                                <text x="150" y="105" text-anchor="middle" fill="white" font-size="12" font-weight="bold">YOU</text>
                                <text x="100" y="155" text-anchor="middle" fill="white" font-size="12" font-weight="bold">A</text>
                                <text x="200" y="155" text-anchor="middle" fill="white" font-size="12" font-weight="bold">B</text>
                                <text x="150" y="205" text-anchor="middle" fill="white" font-size="12" font-weight="bold">C</text>
                            </svg>
                        </div>
                        <p style="margin-top: 15px;"><strong>High Redundancy:</strong> Everyone knows everyone. Information circulates but doesn't escape. Triadic closure ensures all possible connections exist.</p>
                    </div>

                    <div class="card">
                        <h4>Weak Tie Network (Bridges)</h4>
                        <div class="network-container">
                            <svg class="network-svg" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                                <!-- Left cluster -->
                                <line x1="80" y1="150" x2="50" y2="100" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="80" y1="150" x2="50" y2="200" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="50" y1="100" x2="50" y2="200" stroke="#e74c3c" stroke-width="4"/>

                                <!-- Bridge (weak tie) -->
                                <line x1="80" y1="150" x2="200" y2="150" stroke="#27ae60" stroke-width="3" stroke-dasharray="5,5"/>

                                <!-- Right cluster -->
                                <line x1="200" y1="150" x2="280" y2="100" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="200" y1="150" x2="280" y2="200" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="280" y1="100" x2="280" y2="200" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="200" y1="150" x2="350" y2="150" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="280" y1="100" x2="350" y2="150" stroke="#e74c3c" stroke-width="4"/>
                                <line x1="280" y1="200" x2="350" y2="150" stroke="#e74c3c" stroke-width="4"/>

                                <!-- Nodes -->
                                <circle cx="80" cy="150" r="15" fill="#c0392b"/>
                                <circle cx="50" cy="100" r="12" fill="#c0392b"/>
                                <circle cx="50" cy="200" r="12" fill="#c0392b"/>
                                <circle cx="200" cy="150" r="15" fill="#27ae60"/>
                                <circle cx="280" cy="100" r="12" fill="#2980b9"/>
                                <circle cx="280" cy="200" r="12" fill="#2980b9"/>
                                <circle cx="350" cy="150" r="12" fill="#2980b9"/>

                                <!-- Labels -->
                                <text x="80" y="155" text-anchor="middle" fill="white" font-size="12" font-weight="bold">YOU</text>
                                <text x="200" y="155" text-anchor="middle" fill="white" font-size="10" font-weight="bold">BRIDGE</text>
                            </svg>
                        </div>
                        <p style="margin-top: 15px;"><strong>Novel Information:</strong> The weak tie (green dashed line) is a bridge between clusters. It provides access to information circulating in a completely different social circle.</p>
                    </div>
                </div>
            </div>

            <!-- Theoretical Propositions -->
            <div class="section">
                <h2>üìú Core Theoretical Propositions</h2>

                <table>
                    <thead>
                        <tr>
                            <th>Proposition</th>
                            <th>Explanation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>P1: Triadic Closure</strong></td>
                            <td>If A-B and A-C are strong ties, a B-C tie will develop. Strong ties lead to transitivity and network closure.</td>
                        </tr>
                        <tr>
                            <td><strong>P2: All Bridges are Weak</strong></td>
                            <td>Because strong ties create triadic closure, they cannot be bridges. Only weak ties can connect otherwise disconnected clusters.</td>
                        </tr>
                        <tr>
                            <td><strong>P3: Overlap Varies with Strength</strong></td>
                            <td>The proportion of A's friends who are also B's friends increases with the strength of the A-B tie.</td>
                        </tr>
                        <tr>
                            <td><strong>P4: Information Advantage</strong></td>
                            <td>Individuals with more weak-tie bridges have access to more diverse, non-redundant information.</td>
                        </tr>
                        <tr>
                            <td><strong>P5: Macro Integration</strong></td>
                            <td>Networks lacking weak ties fragment into isolated clusters, reducing overall social cohesion and information diffusion.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Attribution -->
            <div class="attribution">
                <p><strong>Process Model Framework:</strong> This page visualizes the theoretical mechanism proposed by Granovetter (1973)</p>
            </div>
        </div>
    </div>

    <!-- ANALYSIS PAGE -->
    <div id="analysis" style="display: none;">
        <div class="container">
            <div class="header">
                <h1>Empirical Evidence</h1>
                <p class="subtitle">The Job Search Study & Findings</p>
            </div>

            <!-- Methodology -->
            <div class="section">
                <h2>üî¨ Research Methodology</h2>

                <div class="tabs">
                    <button class="tab active" onclick="showMethodTab('sample')">Sample & Design</button>
                    <button class="tab" onclick="showMethodTab('measures')">Measures</button>
                    <button class="tab" onclick="showMethodTab('context')">Historical Context</button>
                </div>

                <div id="sample" class="tab-content active">
                    <h3>Sample Characteristics</h3>
                    <table>
                        <tr>
                            <th>Characteristic</th>
                            <th>Details</th>
                        </tr>
                        <tr>
                            <td><strong>Total Sample Size</strong></td>
                            <td>282 men</td>
                        </tr>
                        <tr>
                            <td><strong>Location</strong></td>
                            <td>Newton, Massachusetts (Boston suburb)</td>
                        </tr>
                        <tr>
                            <td><strong>Occupations</strong></td>
                            <td>Professional, technical, and managerial workers</td>
                        </tr>
                        <tr>
                            <td><strong>Personal Interviews</strong></td>
                            <td>100 respondents (subset of 282)</td>
                        </tr>
                        <tr>
                            <td><strong>Data on Job Contacts</strong></td>
                            <td>54 respondents who found jobs through personal contacts</td>
                        </tr>
                        <tr>
                            <td><strong>Research Method</strong></td>
                            <td>Survey questionnaire + follow-up personal interviews</td>
                        </tr>
                    </table>

                    <div class="insight-box" style="margin-top: 20px;">
                        <p><strong>Study Design:</strong> Granovetter surveyed men who had recently changed jobs, asking them how they found their new position. For those who used personal contacts, he measured the strength of the tie (frequency of contact) between the job-seeker and the person who provided the crucial information.</p>
                    </div>
                </div>

                <div id="measures" class="tab-content">
                    <h3>Measurement of Tie Strength</h3>
                    <p><strong>Key Variable:</strong> Frequency of contact at the time the job information was obtained</p>

                    <table style="margin-top: 20px;">
                        <thead>
                            <tr>
                                <th>Tie Strength</th>
                                <th>Frequency Definition</th>
                                <th>Percentage of Jobs</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Strong</strong></td>
                                <td>Saw contact "often" (‚â•2 times per week)</td>
                                <td><strong>16.7%</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Moderate</strong></td>
                                <td>Saw contact "occasionally" (>1x/year but <2x/week)</td>
                                <td><strong>55.6%</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Weak</strong></td>
                                <td>Saw contact "rarely" (‚â§1 time per year)</td>
                                <td><strong>27.8%</strong></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="key-finding" style="margin-top: 20px;">
                        <strong>Critical Finding:</strong> 83.4% of jobs obtained through personal contacts came from moderate or weak ties. Only 16.7% came from strong ties. This directly contradicted the intuition that close friends are the most helpful in job searches.
                    </div>

                    <h3 style="margin-top: 30px;">Additional Findings</h3>
                    <ul style="margin-left: 20px; line-height: 1.8;">
                        <li>Those who found jobs through <strong>strong ties</strong> were far more likely to have experienced a period of unemployment between jobs</li>
                        <li>Weak ties were more likely to provide information about job openings in <strong>different companies or industries</strong></li>
                        <li>Information from weak ties was more often described as <strong>"novel"</strong> or <strong>"unexpected"</strong></li>
                        <li>Strong ties tended to provide information the job seeker <strong>already knew</strong> or would have learned anyway</li>
                    </ul>
                </div>

                <div id="context" class="tab-content">
                    <h3>Historical Context & Publication</h3>

                    <div class="card">
                        <h4>Publication Journey</h4>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li><strong>1969:</strong> Initially submitted to the <em>American Sociological Review</em> and rejected</li>
                            <li><strong>1973:</strong> Published in the <em>American Journal of Sociology</em>, Vol. 78, No. 6, pp. 1360-1380</li>
                            <li><strong>Impact:</strong> Became one of the most cited papers in sociology and formed the foundation for modern social network analysis</li>
                        </ul>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h4>Theoretical Innovation</h4>
                        <p>Before Granovetter, social network research focused primarily on strong ties and cohesive groups. The idea that <strong>weak ties could be more valuable</strong> was counterintuitive and revolutionary.</p>
                        <p style="margin-top: 10px;">Granovetter's key insight was to focus on the <strong>structure</strong> of networks rather than just the quality of individual relationships. He showed that your <strong>position</strong> in a network (whether you bridge clusters) matters more than the strength of any single relationship.</p>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h4>Modern Validation</h4>
                        <p>A 2022 LinkedIn study with <strong>20 million users</strong> over 5 years‚Äîthe largest empirical test of weak tie theory in history‚Äîconfirmed Granovetter's hypothesis: weak ties were the most helpful for career advancement and job transitions.</p>
                    </div>
                </div>
            </div>

            <!-- Detailed Results -->
            <div class="section">
                <h2>üìà Detailed Results Breakdown</h2>

                <h3>Distribution of Job Finding Methods</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Count (N=54 with contact data)</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Strong Ties</strong> (‚â•2x/week)</td>
                            <td>9</td>
                            <td><strong>16.7%</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Moderate Ties</strong> (Occasional)</td>
                            <td>30</td>
                            <td><strong>55.6%</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Weak Ties</strong> (‚â§1x/year)</td>
                            <td>15</td>
                            <td><strong>27.8%</strong></td>
                        </tr>
                    </tbody>
                </table>

                <div class="key-finding" style="margin-top: 30px;">
                    <strong>üìä Statistical Insight:</strong> If job information were distributed randomly across all contacts, we would expect strong ties to provide more leads (simply because people interact with them more often). Instead, the data showed the <em>opposite</em>: weak ties provided disproportionately more useful information relative to interaction frequency.
                </div>
            </div>

            <!-- Qualitative Insights -->
            <div class="section">
                <h2>üí¨ Qualitative Insights from Interviews</h2>

                <div class="grid">
                    <div class="card">
                        <h4>Nature of Information from Weak Ties</h4>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>Job leads in different industries or companies</li>
                            <li>Information the respondent "would never have heard otherwise"</li>
                            <li>Contacts to people outside respondent's usual circle</li>
                            <li>Opportunities that required "being in the right place at the right time"</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>Nature of Information from Strong Ties</h4>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>Information respondent already knew</li>
                            <li>Opportunities in same company or industry</li>
                            <li>Redundant with other sources</li>
                            <li>Emotional support but less novel information</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>Why Weak Ties Were More Effective</h4>
                        <p><strong>1. Different Social Circles:</strong> Weak ties connected respondents to people with different employers, industries, and professional networks.</p>
                        <p style="margin-top: 10px;"><strong>2. Non-Redundant Information:</strong> Because weak ties don't share the same friendship networks, their information didn't overlap with what the job seeker already knew.</p>
                    </div>

                    <div class="card">
                        <h4>The Role of Moderate Ties</h4>
                        <p>The majority (55.6%) came from <strong>moderate ties</strong>‚Äîpeople seen "occasionally." These are the sweet spot: still recent enough to remember you and willing to help, but distant enough to have access to different information.</p>
                    </div>
                </div>
            </div>

            <!-- Implications -->
            <div class="section">
                <h2>üéØ Practical Implications</h2>

                <div class="insight-box">
                    <h3 style="margin-top: 0;">For Job Seekers</h3>
                    <ul style="margin-left: 20px; line-height: 1.8;">
                        <li><strong>Don't just rely on close friends:</strong> They likely know the same opportunities you do</li>
                        <li><strong>Reconnect with old acquaintances:</strong> Former colleagues, classmates, and distant contacts have access to different information</li>
                        <li><strong>Diversify your network:</strong> Seek contacts in different industries, companies, and geographic areas</li>
                        <li><strong>Maintain weak ties:</strong> Occasional check-ins with distant contacts can pay dividends</li>
                    </ul>
                </div>

                <div class="insight-box">
                    <h3 style="margin-top: 0;">For Organizations</h3>
                    <ul style="margin-left: 20px; line-height: 1.8;">
                        <li><strong>Employee referral programs:</strong> Encourage employees to reach beyond their immediate circles</li>
                        <li><strong>Cross-functional collaboration:</strong> Create opportunities for weak ties to form across departments</li>
                        <li><strong>Alumni networks:</strong> Maintain connections with former employees who now work elsewhere</li>
                        <li><strong>Information diffusion:</strong> Recognize that innovation spreads through weak ties, not just formal channels</li>
                    </ul>
                </div>
            </div>

            <!-- Attribution -->
            <div class="attribution">
                <p><strong>Data Source:</strong> All statistics and findings from Granovetter (1973), American Journal of Sociology</p>
            </div>
        </div>
    </div>

    <!-- INTERACTIVE TOOLS PAGE -->
    <div id="interactive" style="display: none;">
        <div class="container">
            <div class="header">
                <h1>üéÆ Interactive Network Simulator</h1>
                <p class="subtitle">Build and Analyze Your Own Networks</p>
                <p class="subtitle">Commercial BI-Quality Tool</p>
            </div>

            <!-- ABOUT THIS TOOL - Research Disclaimer -->
            <div class="section" style="background: linear-gradient(135deg, #fff9e6 0%, #fffbf0 100%); border-left: 6px solid #f59e0b;">
                <h2 style="color: #d97706; border-bottom-color: #f59e0b;">üìö About These Interactive Tools</h2>

                <!-- Mode Toggle -->
                <div style="text-align: center; margin: 25px 0; padding: 20px; background: white; border-radius: 12px; border: 2px solid #fbbf24;">
                    <h3 style="margin-top: 0; color: #1e3c72;">Choose Your Mode:</h3>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 15px; flex-wrap: wrap;">
                        <button id="mode-illustrative" class="control-btn" onclick="toggleMode('illustrative')" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); font-size: 1.1em; padding: 15px 30px;">
                            üé® Illustrative Mode (Default)
                        </button>
                        <button id="mode-research" class="control-btn secondary" onclick="toggleMode('research')" style="font-size: 1.1em; padding: 15px 30px;">
                            üî¨ Research-Only Mode
                        </button>
                    </div>
                    <div id="mode-description" style="margin-top: 15px; padding: 15px; background: #fffbeb; border-radius: 8px; text-align: left;">
                        <strong style="color: #d97706;">Current: Illustrative Mode</strong>
                        <p style="margin: 10px 0 0 0; line-height: 1.6;">Shows educational models with conceptual thresholds to help you understand network principles. Calculations are illustrative and based on Granovetter's concepts, but specific numerical thresholds are not empirically validated.</p>
                    </div>
                </div>

                <!-- What's Research-Backed -->
                <div class="grid" style="margin-bottom: 25px;">
                    <div style="background: #f0fdf4; padding: 20px; border-radius: 12px; border-left: 4px solid #10b981;">
                        <h3 style="color: #166534; margin-top: 0;">‚úÖ Research-Backed Elements</h3>
                        <p style="margin-bottom: 12px;"><strong>From Granovetter (1973):</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li><strong>16.7% / 55.6% / 27.8%</strong> empirical distribution (N=54 job seekers)</li>
                            <li>Weak ties more effective than strong ties for job search</li>
                            <li>Tie strength = frequency of contact</li>
                            <li>Overlap increases with tie strength (qualitative principle)</li>
                            <li>Triadic closure creates redundancy</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 0.9em;"><em>üìñ Source: Granovetter, M. S. (1973). "The Strength of Weak Ties." American Journal of Sociology, 78(6), 1360-1380.</em></p>
                    </div>

                    <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border-left: 4px solid #ef4444;">
                        <h3 style="color: #991b1b; margin-top: 0;">‚ö†Ô∏è Illustrative Model Elements</h3>
                        <p style="margin-bottom: 12px;"><strong>Educational concepts (not empirically validated):</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>Specific % thresholds (e.g., "0-30% = sparse")</li>
                            <li>Overlap calculation formulas</li>
                            <li>"Optimal" network configurations</li>
                            <li>Numerical bridge count recommendations</li>
                            <li>Network quality scoring algorithms</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 0.9em; color: #991b1b;"><strong>Why?</strong> Research shows network interpretation is highly context-dependent. There are NO universal thresholds - all metrics depend on network size, purpose, and comparison to random baselines.</p>
                    </div>
                </div>

                <!-- Research Notes -->
                <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #e0e6ed;">
                    <h3 style="color: #1e3c72; margin-top: 0;">üìä Research Foundation</h3>
                    <p style="line-height: 1.8; margin-bottom: 15px;">
                        These tools are based on extensive literature review including:
                    </p>
                    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; font-size: 0.9em;">
                        <div>
                            <strong>‚Ä¢ Granovetter (1973)</strong><br>
                            <span style="color: #64748b;">Original weak ties study</span>
                        </div>
                        <div>
                            <strong>‚Ä¢ Burt (2000, 2004)</strong><br>
                            <span style="color: #64748b;">Structural holes theory</span>
                        </div>
                        <div>
                            <strong>‚Ä¢ Watts-Strogatz (1998)</strong><br>
                            <span style="color: #64748b;">Small-world networks</span>
                        </div>
                        <div>
                            <strong>‚Ä¢ Recent studies (2021-2024)</strong><br>
                            <span style="color: #64748b;">Network density & diffusion</span>
                        </div>
                    </div>
                    <p style="margin-top: 15px; font-size: 0.9em; color: #64748b;">
                        <strong>üìÑ Full research documentation:</strong> See <code>network-metrics-research-kb.md</code> for complete literature review and source citations.
                    </p>
                </div>

                <!-- Key Takeaway -->
                <div class="key-finding" style="margin-top: 25px; margin-bottom: 0;">
                    <strong>üéØ Key Takeaway:</strong> Use Illustrative Mode to learn and explore network concepts. The qualitative relationships (weak ties ‚Üí less overlap ‚Üí novel information) are research-backed. Specific numerical thresholds are educational models to help understanding, not empirical guidelines for your personal network.
                </div>
            </div>

            <!-- Interactive Network Simulator -->
            <div class="section">
                <h2>üï∏Ô∏è Network Builder & Analyzer</h2>
                <p>Create your own networks and watch the metrics update in real-time. Understand the power of weak ties by building different network structures.</p>

                <div class="network-simulator">
                    <!-- Controls -->
                    <div class="simulator-controls">
                        <h3 style="width: 100%; margin: 0 0 15px 0; font-size: 1.1em;">Controls:</h3>

                        <button id="draw-mode-btn" class="control-btn" onclick="NetworkSimulator.toggleDrawMode()">
                            ‚úèÔ∏è Enable Drawing Mode
                        </button>

                        <button id="edge-weak" class="control-btn edge-type-btn active" onclick="NetworkSimulator.setEdgeType('weak')">
                            Weak Tie
                        </button>

                        <button id="edge-strong" class="control-btn edge-type-btn" onclick="NetworkSimulator.setEdgeType('strong')">
                            Strong Tie
                        </button>

                        <button class="control-btn secondary" onclick="NetworkSimulator.removeSelectedNode()">
                            üóëÔ∏è Delete Selected
                        </button>

                        <button class="control-btn danger" onclick="NetworkSimulator.clearNetwork()">
                            ‚ö†Ô∏è Clear All
                        </button>
                    </div>

                    <div class="preset-buttons" style="margin-bottom: 20px;">
                        <h4 style="width: 100%; margin: 0 0 12px 0; font-size: 1em; font-weight: 600;">Load Preset Networks:</h4>
                        <button class="preset-btn" onclick="NetworkSimulator.loadPresetNetwork('basic')">
                            üìç Basic (Strong Ties Only)
                        </button>
                        <button class="preset-btn" onclick="NetworkSimulator.loadPresetNetwork('bridges')">
                            üåâ Weak Tie Bridges
                        </button>
                        <button class="preset-btn" onclick="NetworkSimulator.loadPresetNetwork('realistic')">
                            üåê Realistic Mixed Network
                        </button>
                    </div>

                    <!-- Canvas -->
                    <canvas id="networkCanvas"></canvas>

                    <!-- Legend -->
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-line strong"></div>
                            <span>Strong Tie (close friend, frequent contact)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-line weak"></div>
                            <span>Weak Tie (acquaintance, occasional contact)</span>
                        </div>
                        <div class="legend-item">
                            <span style="display: inline-block; width: 20px; height: 20px; border-radius: 50%; background: #1e3c72; border: 2px solid white;"></span>
                            <span>Person (drag to move)</span>
                        </div>
                    </div>

                    <!-- Help Text -->
                    <div class="help-text">
                        <strong>üéØ How to use:</strong>
                        <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                            <li><strong>Load presets:</strong> Click the preset buttons above to instantly load example networks</li>
                            <li><strong>Add a person:</strong> Double-click anywhere on the canvas</li>
                            <li><strong>Move a person:</strong> Click and drag any node (when drawing mode is OFF)</li>
                            <li><strong>Add a connection:</strong>
                                <ol style="margin-left: 20px; margin-top: 5px;">
                                    <li>Click "Enable Drawing Mode" button</li>
                                    <li>Choose tie type (Weak Tie or Strong Tie)</li>
                                    <li>Click the first person</li>
                                    <li>Click the second person to create the connection</li>
                                </ol>
                            </li>
                            <li><strong>Delete a person:</strong> Turn off drawing mode, click to select (yellow glow), then click "Delete Selected"</li>
                            <li><strong>Clear everything:</strong> Click "Clear All" to start fresh</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Real-Time Network Metrics -->
            <div class="section">
                <h2>üìä Network Metrics Dashboard</h2>
                <p>These metrics update in real-time as you modify the network. Watch how weak ties, bridges, and clustering change your network's structure.</p>

                <div style="text-align: center; margin: 20px 0;">
                    <h3 style="margin-bottom: 10px;">Network Quality Score</h3>
                    <span id="network-quality" class="quality-badge" style="background: #64748b;">Waiting for data...</span>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #64748b;">Based on weak tie ratio, bridges, and clustering coefficient</p>
                </div>

                <div class="network-metrics">
                    <div class="metric-card">
                        <div class="metric-label">People</div>
                        <div class="metric-value" id="metric-nodes">0</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Connections</div>
                        <div class="metric-value" id="metric-edges">0</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Network Density</div>
                        <div class="metric-value" id="metric-density">0%</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Avg. Connections</div>
                        <div class="metric-value" id="metric-avgdegree">0</div>
                    </div>

                    <div class="metric-card" style="border-left-color: #1e3c72;">
                        <div class="metric-label">Strong Ties</div>
                        <div class="metric-value" id="metric-strong">0%</div>
                    </div>

                    <div class="metric-card" style="border-left-color: #94a3b8;">
                        <div class="metric-label">Weak Ties</div>
                        <div class="metric-value" id="metric-weak">0%</div>
                    </div>

                    <div class="metric-card" style="border-left-color: #10b981;">
                        <div class="metric-label">Bridges</div>
                        <div class="metric-value" id="metric-bridges">0</div>
                    </div>

                    <div class="metric-card" style="border-left-color: #f59e0b;">
                        <div class="metric-label">Clustering</div>
                        <div class="metric-value" id="metric-clustering">0%</div>
                    </div>
                </div>

                <div class="insight-box" style="margin-top: 30px;">
                    <h3 style="margin-top: 0; font-size: 1.8em; color: #1e3c72;">üí° Understanding the Metrics</h3>
                    <p style="font-size: 1.05em; color: #64748b; margin-bottom: 30px; line-height: 1.7;">
                        Each metric reveals different aspects of your network structure. Here's how to interpret the numbers you see above.
                    </p>

                    <div class="grid" style="gap: 30px;">
                        <!-- Network Density -->
                        <div class="card" style="background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-top: 5px solid #3b82f6; padding: 28px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 18px;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5em;">üìä</div>
                                <h4 style="margin: 0; font-size: 1.4em; color: #1e3c72;">Network Density</h4>
                            </div>

                            <p style="font-size: 1.05em; line-height: 1.7; margin-bottom: 18px; color: #334155;">
                                <strong style="color: #1e3c72;">What it measures:</strong> Percentage of all possible connections that actually exist in your network.
                            </p>

                            <div class="illustrative-only" style="margin-top: 18px; padding: 18px; background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%); border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <div style="font-weight: 700; color: #1e3c72; margin-bottom: 12px; font-size: 1.05em; letter-spacing: 0.3px;">ILLUSTRATIVE THRESHOLDS:</div>
                                <div style="line-height: 2; font-size: 0.95em;">
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #0ea5e9;">Low (0-30%):</span>
                                        <span style="color: #475569;">Sparse network, diverse connections, high bridging potential</span>
                                    </div>
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #3b82f6;">Medium (30-60%):</span>
                                        <span style="color: #475569;">Balanced mix of clustering and diversity</span>
                                    </div>
                                    <div>
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #1e40af;">High (60-100%):</span>
                                        <span style="color: #475569;">Dense cluster, high information redundancy</span>
                                    </div>
                                </div>
                            </div>

                            <div class="research-warning" style="display: none; margin-top: 18px; padding: 18px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-weight: 700; color: #166534; margin-bottom: 8px;">‚úÖ RESEARCH FINDING:</div>
                                <p style="margin: 0; color: #166534; line-height: 1.7;">Interpretation is context-dependent. Compare your network's density to a random network of the same size. Higher density = more clustering, lower density = more potential for bridges.</p>
                            </div>

                            <p style="margin-top: 15px; font-size: 0.95em; color: #64748b; font-style: italic; line-height: 1.6;">
                                üí° Research shows no universal "optimal" - large networks tend to be sparse, interpretation depends on network size and purpose.
                            </p>
                        </div>

                        <!-- Bridges -->
                        <div class="card" style="background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-top: 5px solid #10b981; padding: 28px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 18px;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5em;">üåâ</div>
                                <h4 style="margin: 0; font-size: 1.4em; color: #1e3c72;">Bridges</h4>
                            </div>

                            <p style="font-size: 1.05em; line-height: 1.7; margin-bottom: 18px; color: #334155;">
                                <strong style="color: #1e3c72;">What it measures:</strong> Weak ties that are the only connection between otherwise disconnected groups.
                            </p>

                            <div class="illustrative-only" style="margin-top: 18px; padding: 18px; background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%); border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-weight: 700; color: #1e3c72; margin-bottom: 12px; font-size: 1.05em; letter-spacing: 0.3px;">ILLUSTRATIVE THRESHOLDS:</div>
                                <div style="line-height: 2; font-size: 0.95em;">
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 100px; font-weight: 600; color: #ef4444;">0 bridges:</span>
                                        <span style="color: #475569;">Limited novel information access</span>
                                    </div>
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 100px; font-weight: 600; color: #f59e0b;">1-2 bridges:</span>
                                        <span style="color: #475569;">Some access to different circles</span>
                                    </div>
                                    <div>
                                        <span style="display: inline-block; width: 100px; font-weight: 600; color: #10b981;">3+ bridges:</span>
                                        <span style="color: #475569;">Excellent diversity, multiple distinct groups</span>
                                    </div>
                                </div>
                            </div>

                            <div class="research-warning" style="display: none; margin-top: 18px; padding: 18px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-weight: 700; color: #166534; margin-bottom: 8px;">‚úÖ GRANOVETTER'S KEY INSIGHT:</div>
                                <p style="margin: 0; color: #166534; line-height: 1.7;">Bridges connect otherwise disconnected groups, providing access to non-redundant information. More bridges = more diverse information sources. No empirical threshold for "optimal" number exists.</p>
                            </div>

                            <p style="margin-top: 15px; font-size: 0.95em; color: #64748b; font-style: italic; line-height: 1.6;">
                                üî¨ Granovetter's core finding: Weak ties act as bridges between social clusters, enabling information flow across groups.
                            </p>
                        </div>

                        <!-- Clustering Coefficient -->
                        <div class="card" style="background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-top: 5px solid #f59e0b; padding: 28px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 18px;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5em;">üîó</div>
                                <h4 style="margin: 0; font-size: 1.4em; color: #1e3c72;">Clustering Coefficient</h4>
                            </div>

                            <p style="font-size: 1.05em; line-height: 1.7; margin-bottom: 18px; color: #334155;">
                                <strong style="color: #1e3c72;">What it measures:</strong> How much your friends are also friends with each other (triadic closure).
                            </p>

                            <div class="illustrative-only" style="margin-top: 18px; padding: 18px; background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%); border-radius: 10px; border-left: 4px solid #f59e0b;">
                                <div style="font-weight: 700; color: #1e3c72; margin-bottom: 12px; font-size: 1.05em; letter-spacing: 0.3px;">ILLUSTRATIVE THRESHOLDS:</div>
                                <div style="line-height: 2; font-size: 0.95em;">
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #10b981;">Low (0-30%):</span>
                                        <span style="color: #475569;">Spread-out, friends in different circles</span>
                                    </div>
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #f59e0b;">Medium (30-60%):</span>
                                        <span style="color: #475569;">Mix of closed groups and diverse ties</span>
                                    </div>
                                    <div>
                                        <span style="display: inline-block; width: 120px; font-weight: 600; color: #ef4444;">High (60-100%):</span>
                                        <span style="color: #475569;">Tight-knit, "forbidden triads", redundancy</span>
                                    </div>
                                </div>
                            </div>

                            <div class="research-warning" style="display: none; margin-top: 18px; padding: 18px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-weight: 700; color: #166534; margin-bottom: 8px;">‚úÖ RESEARCH FINDING:</div>
                                <p style="margin: 0; color: #166534; line-height: 1.7;">Compare to random network baseline. Higher clustering than random = more "small-world" properties. Triadic closure principle: if A-B and A-C are strong, B-C will form (creating redundancy).</p>
                            </div>

                            <p style="margin-top: 15px; font-size: 0.95em; color: #64748b; font-style: italic; line-height: 1.6;">
                                üìö Watts-Strogatz research: Small-world networks have high clustering but short path lengths. Compare to random baseline, not absolute values.
                            </p>
                        </div>

                        <!-- Weak Tie Ratio -->
                        <div class="card" style="background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-top: 5px solid #8b5cf6; padding: 28px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 18px;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5em;">üìà</div>
                                <h4 style="margin: 0; font-size: 1.4em; color: #1e3c72;">Weak Tie Ratio</h4>
                            </div>

                            <p style="font-size: 1.05em; line-height: 1.7; margin-bottom: 18px; color: #334155;">
                                <strong style="color: #1e3c72;">What it measures:</strong> Percentage of all connections that are weak ties (vs. strong ties).
                            </p>

                            <div class="illustrative-only" style="margin-top: 18px; padding: 18px; background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%); border-radius: 10px; border-left: 4px solid #8b5cf6;">
                                <div style="font-weight: 700; color: #1e3c72; margin-bottom: 12px; font-size: 1.05em; letter-spacing: 0.3px;">ILLUSTRATIVE THRESHOLDS:</div>
                                <div style="line-height: 2; font-size: 0.95em;">
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 110px; font-weight: 600; color: #ef4444;">Low (0-20%):</span>
                                        <span style="color: #475569;">Too few weak ties, missing opportunities</span>
                                    </div>
                                    <div style="margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 110px; font-weight: 600; color: #3b82f6;">Medium (20-50%):</span>
                                        <span style="color: #475569;">Balanced network with good diversity</span>
                                    </div>
                                    <div>
                                        <span style="display: inline-block; width: 110px; font-weight: 600; color: #10b981;">High (50-100%):</span>
                                        <span style="color: #475569;">Excellent information access, many contacts</span>
                                    </div>
                                </div>
                            </div>

                            <div class="research-warning" style="display: none; margin-top: 18px; padding: 18px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-weight: 700; color: #166534; margin-bottom: 8px;">‚úÖ EMPIRICAL FINDING:</div>
                                <p style="margin: 0; color: #166534; line-height: 1.7;"><strong>83.4% of jobs</strong> came through weak/moderate ties, not strong ties (Granovetter, 1973). Higher weak tie ratio generally correlates with more diverse information access, but no universal "optimal" percentage exists.</p>
                            </div>

                            <p style="margin-top: 15px; font-size: 0.95em; color: #64748b; font-style: italic; line-height: 1.6;">
                                ‚≠ê Granovetter's seminal finding: 16.7% strong / 55.6% moderate / 27.8% weak in successful job searches (N=54).
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparison & Analysis -->
            <div class="section">
                <h2>üî¨ Compare Network Structures</h2>
                <p>Try building these different network types and see how the metrics change:</p>

                <div class="grid">
                    <div class="card">
                        <h4>All Strong Ties (Closed Cluster)</h4>
                        <p><strong>Characteristics:</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>High clustering (70-100%)</li>
                            <li>High density</li>
                            <li>Zero bridges</li>
                            <li>All strong ties (100%)</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Result:</strong> Information redundancy, limited novel information access.</p>
                    </div>

                    <div class="card">
                        <h4>Weak Tie Bridges</h4>
                        <p><strong>Characteristics:</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>Low to moderate clustering (20-40%)</li>
                            <li>Lower density</li>
                            <li>Multiple bridges (3+)</li>
                            <li>High weak tie ratio (50%+)</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Result:</strong> Access to diverse, non-redundant information.</p>
                    </div>

                    <div class="card">
                        <h4>Realistic Mixed Network</h4>
                        <p><strong>Characteristics:</strong></p>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>Moderate clustering (40-60%)</li>
                            <li>Moderate density</li>
                            <li>Some bridges (1-3)</li>
                            <li>Mixed ties (30-50% weak)</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Result:</strong> Balance of trust (strong ties) and opportunity (weak ties).</p>
                    </div>
                </div>

                <div class="key-finding" style="margin-top: 30px;">
                    <strong>üéØ Granovetter's Insight:</strong> In real job searches, 83.4% of successful job leads came from weak or moderate ties, not strong ties. Build a network with bridges to access opportunities you wouldn't otherwise hear about!
                </div>
            </div>

            <!-- Job Search Probability Calculator -->
            <div class="section">
                <h2>üé≤ Job Search Probability Calculator</h2>
                <p>Based on Granovetter's empirical findings, calculate your likelihood of finding a job through different types of contacts.</p>

                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin-top: 25px;">

                    <!-- Empirical Baseline Display -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 30px; border-left: 5px solid #2a5298;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">üìä Granovetter's Study Results (N=54)</h3>
                        <p style="margin-bottom: 20px; color: #64748b;">Percentage of jobs found through each tie type:</p>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border-radius: 10px;">
                                <div style="font-size: 2.5em; font-weight: bold;">16.7%</div>
                                <div style="font-size: 1.1em; margin-top: 5px;">Strong Ties</div>
                                <div style="font-size: 0.85em; opacity: 0.9; margin-top: 5px;">Saw often (‚â•2x/week)</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; border-radius: 10px;">
                                <div style="font-size: 2.5em; font-weight: bold;">55.6%</div>
                                <div style="font-size: 1.1em; margin-top: 5px;">Moderate Ties</div>
                                <div style="font-size: 0.85em; opacity: 0.9; margin-top: 5px;">Saw occasionally</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; border-radius: 10px;">
                                <div style="font-size: 2.5em; font-weight: bold;">27.8%</div>
                                <div style="font-size: 1.1em; margin-top: 5px;">Weak Ties</div>
                                <div style="font-size: 0.85em; opacity: 0.9; margin-top: 5px;">Saw rarely (‚â§1x/year)</div>
                            </div>
                        </div>
                    </div>

                    <!-- User Input Section -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">üéØ Your Network Composition</h3>
                        <p style="margin-bottom: 25px; color: #64748b;">Adjust the sliders to match your network. They auto-normalize to 100%.</p>

                        <!-- Strong Ties Slider -->
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <label style="font-weight: 600; color: #1e3c72;">Strong Ties (Close friends, family):</label>
                                <span id="strong-value" style="font-size: 1.3em; font-weight: bold; color: #e74c3c; min-width: 60px; text-align: right;">33%</span>
                            </div>
                            <input type="range" id="strong-slider" min="0" max="100" value="33"
                                   style="width: 100%; height: 8px; border-radius: 5px; outline: none; background: linear-gradient(to right, #e74c3c 0%, #e74c3c 33%, #e0e6ed 33%, #e0e6ed 100%);"
                                   oninput="JobSearchCalculator.updateSlider('strong', this.value)">
                        </div>

                        <!-- Moderate Ties Slider -->
                        <div style="margin-bottom: 25px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <label style="font-weight: 600; color: #1e3c72;">Moderate Ties (Acquaintances):</label>
                                <span id="moderate-value" style="font-size: 1.3em; font-weight: bold; color: #3498db; min-width: 60px; text-align: right;">34%</span>
                            </div>
                            <input type="range" id="moderate-slider" min="0" max="100" value="34"
                                   style="width: 100%; height: 8px; border-radius: 5px; outline: none; background: linear-gradient(to right, #3498db 0%, #3498db 34%, #e0e6ed 34%, #e0e6ed 100%);"
                                   oninput="JobSearchCalculator.updateSlider('moderate', this.value)">
                        </div>

                        <!-- Weak Ties Slider -->
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <label style="font-weight: 600; color: #1e3c72;">Weak Ties (Distant contacts):</label>
                                <span id="weak-value" style="font-size: 1.3em; font-weight: bold; color: #2ecc71; min-width: 60px; text-align: right;">33%</span>
                            </div>
                            <input type="range" id="weak-slider" min="0" max="100" value="33"
                                   style="width: 100%; height: 8px; border-radius: 5px; outline: none; background: linear-gradient(to right, #2ecc71 0%, #2ecc71 33%, #e0e6ed 33%, #e0e6ed 100%);"
                                   oninput="JobSearchCalculator.updateSlider('weak', this.value)">
                        </div>

                        <div style="text-align: center; padding: 12px; background: #f8f9fa; border-radius: 8px; margin-top: 15px;">
                            <strong>Total:</strong> <span id="total-percentage" style="font-size: 1.2em; font-weight: bold; color: #1e3c72;">100%</span>
                        </div>
                    </div>

                    <!-- Results Display -->
                    <div style="background: white; padding: 25px; border-radius: 12px;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">üìà Your Job Search Success Probability</h3>

                        <!-- Probability Meter -->
                        <div style="margin: 25px 0;">
                            <div style="text-align: center; margin-bottom: 15px;">
                                <div id="success-probability" style="font-size: 3.5em; font-weight: bold; color: #10b981;">100%</div>
                                <div style="font-size: 1.1em; color: #64748b;">Relative Success Rate</div>
                            </div>

                            <div style="background: #e0e6ed; height: 40px; border-radius: 20px; overflow: hidden; position: relative;">
                                <div id="probability-bar" style="background: linear-gradient(90deg, #10b981 0%, #059669 100%); height: 100%; width: 100%; transition: width 0.3s ease, background 0.3s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.1em;">
                                    Excellent
                                </div>
                            </div>
                        </div>

                        <!-- Comparison -->
                        <div id="comparison-result" style="margin-top: 25px; padding: 20px; background: #f0f9ff; border-left: 4px solid #3b82f6; border-radius: 8px;">
                            <strong style="color: #1e3c72;">üí° Analysis:</strong>
                            <p id="comparison-text" style="margin-top: 10px; line-height: 1.8; color: #334155;">
                                Your network composition matches the study average perfectly.
                            </p>
                        </div>

                        <!-- Breakdown -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #1e3c72; margin-bottom: 15px;">Expected Job Leads by Source:</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                                <div style="padding: 15px; background: #fef2f2; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 0.85em; color: #991b1b; margin-bottom: 5px;">From Strong Ties</div>
                                    <div id="strong-leads" style="font-size: 1.8em; font-weight: bold; color: #dc2626;">17%</div>
                                </div>
                                <div style="padding: 15px; background: #eff6ff; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 0.85em; color: #1e40af; margin-bottom: 5px;">From Moderate Ties</div>
                                    <div id="moderate-leads" style="font-size: 1.8em; font-weight: bold; color: #2563eb;">56%</div>
                                </div>
                                <div style="padding: 15px; background: #f0fdf4; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 0.85em; color: #166534; margin-bottom: 5px;">From Weak Ties</div>
                                    <div id="weak-leads" style="font-size: 1.8em; font-weight: bold; color: #16a34a;">28%</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="help-text" style="margin-top: 20px;">
                    <strong>üí° How to interpret:</strong> This calculator uses Granovetter's empirical data showing that weak and moderate ties were significantly more helpful than strong ties. A higher percentage of weak/moderate ties generally leads to more diverse job opportunities.
                </div>
            </div>

            <!-- Information Reach Calculator -->
            <div class="section">
                <h2>üåê Information Reach Calculator</h2>
                <p>Calculate how many unique people you can reach through your network, accounting for overlap and redundancy. This demonstrates why weak ties provide access to more diverse information.</p>

                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin-top: 25px;">

                    <!-- Input Section -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">üë• Your Network Size</h3>
                        <p style="margin-bottom: 25px; color: #64748b;">Enter the number of people in your direct network and their average overlap.</p>

                        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                            <!-- Strong Ties Input -->
                            <div>
                                <label style="font-weight: 600; color: #1e3c72; display: block; margin-bottom: 10px;">
                                    Strong Ties (close friends, family):
                                </label>
                                <input type="number" id="strong-ties-count" min="0" max="100" value="5"
                                       style="width: 100%; padding: 12px; border: 2px solid #e0e6ed; border-radius: 8px; font-size: 1.1em; font-weight: 600;"
                                       oninput="ReachCalculator.calculate()">
                                <p style="font-size: 0.85em; color: #64748b; margin-top: 5px;">People you see ‚â•2x/week</p>
                            </div>

                            <!-- Weak Ties Input -->
                            <div>
                                <label style="font-weight: 600; color: #1e3c72; display: block; margin-bottom: 10px;">
                                    Weak Ties (acquaintances, distant contacts):
                                </label>
                                <input type="number" id="weak-ties-count" min="0" max="500" value="15"
                                       style="width: 100%; padding: 12px; border: 2px solid #e0e6ed; border-radius: 8px; font-size: 1.1em; font-weight: 600;"
                                       oninput="ReachCalculator.calculate()">
                                <p style="font-size: 0.85em; color: #64748b; margin-top: 5px;">Distant or occasional contacts</p>
                            </div>

                            <!-- Overlap Percentage -->
                            <div>
                                <label style="font-weight: 600; color: #1e3c72; display: block; margin-bottom: 10px;">
                                    Average Network Overlap:
                                    <span id="overlap-display" style="color: #f59e0b;">50%</span>
                                </label>
                                <input type="range" id="overlap-slider" min="0" max="100" value="50"
                                       style="width: 100%; height: 8px; border-radius: 5px; outline: none; background: linear-gradient(to right, #10b981 0%, #f59e0b 50%, #ef4444 100%);"
                                       oninput="ReachCalculator.updateOverlap(this.value)">
                                <p style="font-size: 0.85em; color: #64748b; margin-top: 5px;">% of contacts that know each other</p>
                            </div>
                        </div>
                    </div>

                    <!-- Results Display -->
                    <div style="background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">üìä Your Information Reach</h3>

                        <!-- Main Reach Number -->
                        <div style="text-align: center; margin: 25px 0;">
                            <div id="total-reach" style="font-size: 4em; font-weight: bold; color: #10b981;">20</div>
                            <div style="font-size: 1.2em; color: #64748b; margin-top: 5px;">Unique People You Can Reach</div>
                        </div>

                        <!-- Concentric Circles Visualization -->
                        <div style="margin: 30px 0;">
                            <svg id="reach-viz" width="100%" height="300" viewBox="0 0 600 300" style="max-width: 600px; margin: 0 auto; display: block;">
                                <!-- Background -->
                                <defs>
                                    <radialGradient id="reachGrad1" cx="50%" cy="50%">
                                        <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.2" />
                                        <stop offset="100%" style="stop-color:#10b981;stop-opacity:0.05" />
                                    </radialGradient>
                                    <radialGradient id="reachGrad2" cx="50%" cy="50%">
                                        <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3" />
                                        <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0.05" />
                                    </radialGradient>
                                </defs>

                                <!-- Circles -->
                                <circle id="reach-circle-outer" cx="300" cy="150" r="140" fill="url(#reachGrad1)" stroke="#10b981" stroke-width="2" opacity="0.6"/>
                                <circle id="reach-circle-middle" cx="300" cy="150" r="90" fill="url(#reachGrad2)" stroke="#3b82f6" stroke-width="2" opacity="0.7"/>
                                <circle cx="300" cy="150" r="40" fill="#1e3c72" stroke="white" stroke-width="3"/>

                                <!-- Labels -->
                                <text x="300" y="155" text-anchor="middle" fill="white" font-size="16" font-weight="bold">YOU</text>
                                <text id="reach-label-direct" x="300" y="110" text-anchor="middle" fill="#1e3c72" font-size="14" font-weight="600">Direct: 20</text>
                                <text id="reach-label-extended" x="300" y="40" text-anchor="middle" fill="#10b981" font-size="14" font-weight="600">Extended: ~200</text>
                            </svg>
                        </div>

                        <!-- Breakdown -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #1e3c72; margin-bottom: 15px;">Network Breakdown:</h4>
                            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                                <div style="padding: 20px; background: #fef2f2; border-radius: 10px; border-left: 4px solid #dc2626;">
                                    <div style="font-size: 0.9em; color: #991b1b; margin-bottom: 8px; font-weight: 600;">Strong Tie Network</div>
                                    <div id="strong-reach" style="font-size: 2em; font-weight: bold; color: #dc2626;">5</div>
                                    <div style="font-size: 0.85em; color: #991b1b; margin-top: 5px;">direct contacts</div>
                                    <div id="strong-overlap-info" style="font-size: 0.8em; color: #64748b; margin-top: 8px;">High overlap (80%)</div>
                                </div>
                                <div style="padding: 20px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #16a34a;">
                                    <div style="font-size: 0.9em; color: #166534; margin-bottom: 8px; font-weight: 600;">Weak Tie Network</div>
                                    <div id="weak-reach" style="font-size: 2em; font-weight: bold; color: #16a34a;">15</div>
                                    <div style="font-size: 0.85em; color: #166534; margin-top: 5px;">direct contacts</div>
                                    <div id="weak-overlap-info" style="font-size: 0.8em; color: #64748b; margin-top: 8px;">Low overlap (20%)</div>
                                </div>
                                <div style="padding: 20px; background: #eff6ff; border-radius: 10px; border-left: 4px solid #2563eb;">
                                    <div style="font-size: 0.9em; color: #1e40af; margin-bottom: 8px; font-weight: 600;">Unique Reach</div>
                                    <div id="unique-reach" style="font-size: 2em; font-weight: bold; color: #2563eb;">18</div>
                                    <div style="font-size: 0.85em; color: #1e40af; margin-top: 5px;">non-redundant contacts</div>
                                    <div id="redundancy-info" style="font-size: 0.8em; color: #64748b; margin-top: 8px;">2 redundant (10%)</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario Comparison -->
                    <div style="background: white; padding: 25px; border-radius: 12px;">
                        <h3 style="margin-top: 0; color: #1e3c72; font-size: 1.3em;">‚öñÔ∏è Scenario Comparison</h3>
                        <p style="margin-bottom: 20px; color: #64748b;">See how different network configurations affect your reach.</p>

                        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="padding: 20px; background: #fef2f2; border-radius: 10px; border: 2px solid #fca5a5;">
                                <h4 style="color: #dc2626; margin-top: 0; font-size: 1.1em;">‚ùå All Strong Ties</h4>
                                <p style="font-size: 0.9em; color: #64748b; margin-bottom: 15px;">20 close friends who all know each other</p>
                                <div style="font-size: 2.5em; font-weight: bold; color: #dc2626;" id="scenario-all-strong">20</div>
                                <div style="font-size: 0.85em; color: #991b1b; margin-top: 5px;">unique reach</div>
                                <div style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 0.85em; color: #64748b;">
                                    High overlap = <strong style="color: #dc2626;">low diversity</strong>
                                </div>
                            </div>

                            <div style="padding: 20px; background: #f0fdf4; border-radius: 10px; border: 2px solid #86efac;">
                                <h4 style="color: #16a34a; margin-top: 0; font-size: 1.1em;">‚úÖ All Weak Ties</h4>
                                <p style="font-size: 0.9em; color: #64748b; margin-bottom: 15px;">20 acquaintances in different circles</p>
                                <div style="font-size: 2.5em; font-weight: bold; color: #16a34a;" id="scenario-all-weak">20</div>
                                <div style="font-size: 0.85em; color: #166534; margin-top: 5px;">unique reach</div>
                                <div style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 0.85em; color: #64748b;">
                                    Low overlap = <strong style="color: #16a34a;">high diversity</strong>
                                </div>
                            </div>

                            <div style="padding: 20px; background: #eff6ff; border-radius: 10px; border: 2px solid #93c5fd;">
                                <h4 style="color: #2563eb; margin-top: 0; font-size: 1.1em;">‚≠ê Your Network</h4>
                                <p style="font-size: 0.9em; color: #64748b; margin-bottom: 15px;">Current configuration</p>
                                <div style="font-size: 2.5em; font-weight: bold; color: #2563eb;" id="scenario-current">18</div>
                                <div style="font-size: 0.85em; color: #1e40af; margin-top: 5px;">unique reach</div>
                                <div id="scenario-comparison" style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 0.85em; color: #64748b;">
                                    Calculating...
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="help-text" style="margin-top: 20px;">
                    <strong>üí° Key Insight:</strong> Weak ties provide access to non-overlapping information networks. With strong ties, your friends all know each other (high overlap), so information is redundant. Weak ties connect you to different social circles, dramatically expanding your reach. This is why Granovetter found that 83.4% of jobs came through weak/moderate ties!
                </div>
            </div>

            <!-- Animated Triadic Closure Demo -->
            <div class="section">
                <h2>üé¨ Triadic Closure Animation</h2>
                <p style="font-size: 1.1em; line-height: 1.7; color: #4b5563;">Watch how "forbidden triads" form and understand why they create information redundancy. This is one of Granovetter's key theoretical insights, visualized with all 16 triad types from the Holland & Leinhardt classification.</p>

                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); padding: 35px; border-radius: 20px; margin-top: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.08);">

                    <!-- Scenario Tabs -->
                    <div style="display: flex; gap: 12px; margin-bottom: 30px; flex-wrap: wrap;">
                        <button id="scenario-basic" class="control-btn" onclick="TriadicClosure.loadScenario('basic')"
                                style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); padding: 15px 30px; font-size: 1.05em; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);">
                            üìä Basic Triad
                        </button>
                        <button id="scenario-weakStrong" class="control-btn secondary" onclick="TriadicClosure.loadScenario('weakStrong')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üåâ Weak ‚Üí Strong
                        </button>
                        <button id="scenario-multiple" class="control-btn secondary" onclick="TriadicClosure.loadScenario('multiple')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üìà Dense vs Sparse
                        </button>
                        <button id="scenario-whatIf" class="control-btn secondary" onclick="TriadicClosure.loadScenario('whatIf')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üîÆ What If?
                        </button>
                    </div>

                    <!-- What If Scenario Builder (shown only in whatIf mode) -->
                    <div id="whatif-builder" style="display: none; background: linear-gradient(135deg, #fef3c7 0%, #fef08a 100%); padding: 25px; border-radius: 12px; margin-bottom: 25px; border: 3px solid #f59e0b;">
                        <h3 style="margin: 0 0 20px 0; color: #92400e; font-size: 1.3em;">üîÆ Build Your Own Scenario</h3>
                        <p style="margin: 0 0 20px 0; color: #78350f; line-height: 1.7;">
                            Experiment with different network configurations and see what Granovetter's theory predicts!
                        </p>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                            <!-- A-B Connection -->
                            <div style="padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h4 style="margin: 0 0 15px 0; color: #1f2937; font-size: 1.1em;">A ‚Üî B Connection</h4>
                                <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                                    <button onclick="TriadicClosure.whatIf.toggleEdge('ab')" id="whatif-toggle-ab"
                                            class="control-btn" style="flex: 1; padding: 12px; font-size: 0.95em; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                        ‚úì Connected
                                    </button>
                                </div>
                                <div id="whatif-type-ab" style="display: flex; gap: 8px;">
                                    <button onclick="TriadicClosure.whatIf.setType('ab', 'strong')" id="whatif-ab-strong"
                                            class="control-btn" style="flex: 1; padding: 10px; font-size: 0.9em; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                                        üí™ Strong
                                    </button>
                                    <button onclick="TriadicClosure.whatIf.setType('ab', 'weak')" id="whatif-ab-weak"
                                            class="control-btn secondary" style="flex: 1; padding: 10px; font-size: 0.9em;">
                                        ü§ù Weak
                                    </button>
                                </div>
                            </div>

                            <!-- B-C Connection -->
                            <div style="padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h4 style="margin: 0 0 15px 0; color: #1f2937; font-size: 1.1em;">B ‚Üî C Connection</h4>
                                <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                                    <button onclick="TriadicClosure.whatIf.toggleEdge('bc')" id="whatif-toggle-bc"
                                            class="control-btn secondary" style="flex: 1; padding: 12px; font-size: 0.95em;">
                                        ‚úó Disconnected
                                    </button>
                                </div>
                                <div id="whatif-type-bc" style="display: none; gap: 8px;">
                                    <button onclick="TriadicClosure.whatIf.setType('bc', 'strong')" id="whatif-bc-strong"
                                            class="control-btn" style="flex: 1; padding: 10px; font-size: 0.9em; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                                        üí™ Strong
                                    </button>
                                    <button onclick="TriadicClosure.whatIf.setType('bc', 'weak')" id="whatif-bc-weak"
                                            class="control-btn secondary" style="flex: 1; padding: 10px; font-size: 0.9em;">
                                        ü§ù Weak
                                    </button>
                                </div>
                            </div>

                            <!-- A-C Connection -->
                            <div style="padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h4 style="margin: 0 0 15px 0; color: #1f2937; font-size: 1.1em;">A ‚Üî C Connection</h4>
                                <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                                    <button onclick="TriadicClosure.whatIf.toggleEdge('ac')" id="whatif-toggle-ac"
                                            class="control-btn secondary" style="flex: 1; padding: 12px; font-size: 0.95em;">
                                        ‚úó Disconnected
                                    </button>
                                </div>
                                <div id="whatif-type-ac" style="display: none; gap: 8px;">
                                    <button onclick="TriadicClosure.whatIf.setType('ac', 'strong')" id="whatif-ac-strong"
                                            class="control-btn" style="flex: 1; padding: 10px; font-size: 0.9em; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                                        üí™ Strong
                                    </button>
                                    <button onclick="TriadicClosure.whatIf.setType('ac', 'weak')" id="whatif-ac-weak"
                                            class="control-btn secondary" style="flex: 1; padding: 10px; font-size: 0.9em;">
                                        ü§ù Weak
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Granovetter's Prediction -->
                        <div id="whatif-prediction" style="margin-top: 25px; padding: 20px; background: white; border-radius: 10px; border-left: 5px solid #8b5cf6;">
                            <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 1.15em;">üìä Granovetter's Prediction</h4>
                            <div id="whatif-prediction-text" style="color: #4b5563; line-height: 1.8; font-size: 0.95em;">
                                Select connections above to see what the theory predicts...
                            </div>
                        </div>

                        <!-- Quick Presets -->
                        <div style="margin-top: 20px; padding: 18px; background: rgba(255,255,255,0.7); border-radius: 10px;">
                            <h4 style="margin: 0 0 12px 0; color: #1f2937; font-size: 1em;">‚ö° Quick Presets:</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button onclick="TriadicClosure.whatIf.loadPreset('forbiddenTriad')" class="control-btn secondary" style="padding: 10px 20px; font-size: 0.9em;">
                                    ‚ö†Ô∏è Forbidden Triad
                                </button>
                                <button onclick="TriadicClosure.whatIf.loadPreset('completeClosure')" class="control-btn secondary" style="padding: 10px 20px; font-size: 0.9em;">
                                    üî¥ Complete Closure
                                </button>
                                <button onclick="TriadicClosure.whatIf.loadPreset('perfectBridge')" class="control-btn secondary" style="padding: 10px 20px; font-size: 0.9em;">
                                    üåâ Perfect Bridge
                                </button>
                                <button onclick="TriadicClosure.whatIf.loadPreset('weakBridge')" class="control-btn secondary" style="padding: 10px 20px; font-size: 0.9em;">
                                    üü¢ Weak Bridge
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Main Visualization Area with Live Metrics -->
                    <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 25px; margin-bottom: 30px;">

                        <!-- Left: Animation Container -->
                        <div style="background: white; padding: 35px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
                            <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 30px; position: relative;">
                                <!-- SVG Animation with Enhanced Visual Effects -->
                                <svg id="triad-animation" width="100%" height="450" viewBox="0 0 600 450" style="max-width: 650px;">
                                    <defs>
                                        <!-- Enhanced gradients for nodes -->
                                        <linearGradient id="nodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#1e40af;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="nodeGradActive" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                                        </linearGradient>

                                        <!-- Glow effects for edges -->
                                        <filter id="edgeGlow">
                                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>

                                        <filter id="strongGlow">
                                            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
                                            <feColorMatrix in="coloredBlur" type="matrix" values="0 0 0 0 0.11 0 0 0 0 0.235 0 0 0 0 0.447 0 0 0 0.5 0"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>

                                        <filter id="weakGlow">
                                            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
                                            <feColorMatrix in="coloredBlur" type="matrix" values="0 0 0 0 0.063 0 0 0 0 0.725 0 0 0 0 0.506 0 0 0 0.5 0"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>

                                        <!-- Drop shadow for nodes -->
                                        <filter id="nodeShadow" x="-50%" y="-50%" width="200%" height="200%">
                                            <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.25"/>
                                        </filter>

                                        <!-- Pulse animation -->
                                        <radialGradient id="pulseGrad">
                                            <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:0.8" />
                                            <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0" />
                                        </radialGradient>
                                    </defs>

                                    <!-- Background grid (subtle) -->
                                    <g opacity="0.08">
                                        <line x1="0" y1="150" x2="600" y2="150" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="0" y1="300" x2="600" y2="300" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="150" y1="0" x2="150" y2="400" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="300" y1="0" x2="300" y2="400" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="450" y1="0" x2="450" y2="400" stroke="#cbd5e1" stroke-width="1"/>
                                    </g>

                                    <!-- Edges (drawn first, behind nodes) -->
                                    <g id="edges-group">
                                        <!-- A-B edge glow layer -->
                                        <line id="edge-ab-glow" x1="200" y1="300" x2="400" y2="300"
                                              stroke="#3b82f6" stroke-width="0" stroke-linecap="round" opacity="0"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />

                                        <!-- A-B edge main -->
                                        <line id="edge-ab" x1="200" y1="300" x2="400" y2="300"
                                              stroke="#1e3c72" stroke-width="0" stroke-linecap="round"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />

                                        <!-- B-C edge glow layer -->
                                        <line id="edge-bc-glow" x1="400" y1="300" x2="300" y2="100"
                                              stroke="#3b82f6" stroke-width="0" stroke-linecap="round" opacity="0"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />

                                        <!-- B-C edge main -->
                                        <line id="edge-bc" x1="400" y1="300" x2="300" y2="100"
                                              stroke="#1e3c72" stroke-width="0" stroke-linecap="round"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />

                                        <!-- A-C edge glow layer (the closure) -->
                                        <line id="edge-ac-glow" x1="200" y1="300" x2="300" y2="100"
                                              stroke="#10b981" stroke-width="0" stroke-linecap="round" opacity="0"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />

                                        <!-- A-C edge main (the closure) -->
                                        <line id="edge-ac" x1="200" y1="300" x2="300" y2="100"
                                              stroke="#10b981" stroke-width="0" stroke-linecap="round" stroke-dasharray="8,8" opacity="0"
                                              style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);" />
                                    </g>

                                    <!-- Nodes (drawn last, on top) -->
                                    <g id="nodes-group">
                                        <!-- Node A pulse effect -->
                                        <circle id="pulse-a" cx="200" cy="300" r="50" fill="url(#pulseGrad)" opacity="0">
                                            <animate attributeName="r" from="45" to="60" dur="1.5s" repeatCount="indefinite"/>
                                            <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" repeatCount="indefinite"/>
                                        </circle>

                                        <!-- Node A -->
                                        <circle id="node-a" cx="200" cy="300" r="45" fill="url(#nodeGrad)" stroke="white" stroke-width="4"
                                                filter="url(#nodeShadow)" opacity="1"
                                                style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1); cursor: pointer;" />
                                        <text id="label-a" x="200" y="310" text-anchor="middle" fill="white" font-size="24" font-weight="bold" opacity="1"
                                              style="transition: opacity 0.6s ease; pointer-events: none;">A</text>

                                        <!-- Node B pulse effect -->
                                        <circle id="pulse-b" cx="400" cy="300" r="50" fill="url(#pulseGrad)" opacity="0">
                                            <animate attributeName="r" from="45" to="60" dur="1.5s" repeatCount="indefinite"/>
                                            <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" repeatCount="indefinite"/>
                                        </circle>

                                        <!-- Node B -->
                                        <circle id="node-b" cx="400" cy="300" r="45" fill="url(#nodeGrad)" stroke="white" stroke-width="4"
                                                filter="url(#nodeShadow)" opacity="1"
                                                style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1); cursor: pointer;" />
                                        <text id="label-b" x="400" y="310" text-anchor="middle" fill="white" font-size="24" font-weight="bold" opacity="1"
                                              style="transition: opacity 0.6s ease; pointer-events: none;">B</text>

                                        <!-- Node C pulse effect -->
                                        <circle id="pulse-c" cx="300" cy="100" r="50" fill="url(#pulseGrad)" opacity="0">
                                            <animate attributeName="r" from="45" to="60" dur="1.5s" repeatCount="indefinite"/>
                                            <animate attributeName="opacity" from="0.6" to="0" dur="1.5s" repeatCount="indefinite"/>
                                        </circle>

                                        <!-- Node C -->
                                        <circle id="node-c" cx="300" cy="100" r="45" fill="url(#nodeGrad)" stroke="white" stroke-width="4"
                                                filter="url(#nodeShadow)" opacity="1"
                                                style="transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1); cursor: pointer;" />
                                        <text id="label-c" x="300" y="110" text-anchor="middle" fill="white" font-size="24" font-weight="bold" opacity="1"
                                              style="transition: opacity 0.6s ease; pointer-events: none;">C</text>
                                    </g>

                                    <!-- Legend -->
                                    <g id="legend" transform="translate(20, 20)">
                                        <rect width="180" height="85" fill="white" rx="8" opacity="0.95" filter="url(#nodeShadow)"/>
                                        <text x="15" y="25" font-size="13" font-weight="bold" fill="#374151">Tie Types:</text>
                                        <line x1="15" y1="40" x2="50" y2="40" stroke="#1e3c72" stroke-width="3" stroke-linecap="round"/>
                                        <text x="60" y="45" font-size="12" fill="#6b7280">Strong Tie</text>
                                        <line x1="15" y1="60" x2="50" y2="60" stroke="#10b981" stroke-width="2" stroke-linecap="round" stroke-dasharray="6,4"/>
                                        <text x="60" y="65" font-size="12" fill="#6b7280">Weak Tie</text>
                                    </g>
                                </svg>
                            </div>

                            <!-- Enhanced Timeline Scrubber -->
                            <div style="margin: 25px 0;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 0.9em; color: #6b7280; font-weight: 600; min-width: 60px;">Timeline</span>
                                    <div style="flex: 1; position: relative; height: 36px; background: #f1f5f9; border-radius: 18px; padding: 6px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);">
                                        <!-- Progress segments -->
                                        <div id="timeline-progress" style="position: absolute; top: 6px; left: 6px; height: 24px; background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%); border-radius: 12px; width: 0%; transition: width 0.3s ease; box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);"></div>
                                        <!-- Scrubber input -->
                                        <input type="range" id="timeline-scrubber" min="0" max="3" value="0" step="1"
                                               oninput="TriadicClosure.scrubToStep(parseInt(this.value))"
                                               style="position: relative; width: 100%; height: 24px; -webkit-appearance: none; background: transparent; cursor: pointer; z-index: 10;">
                                    </div>
                                    <span id="timeline-label" style="font-size: 0.9em; color: #3b82f6; font-weight: 700; min-width: 70px; text-align: right;">Step 1/4</span>
                                </div>
                                <!-- Step markers -->
                                <div id="step-markers" style="display: flex; justify-content: space-between; margin-top: 8px; padding: 0 70px; font-size: 0.75em; color: #94a3b8;">
                                    <!-- Populated by JS -->
                                </div>
                            </div>

                            <!-- Animation Controls with Speed -->
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 15px; flex-wrap: wrap; margin-top: 25px; padding: 20px; background: #f8fafc; border-radius: 12px;">
                                <div style="display: flex; gap: 10px; flex: 1; justify-content: center;">
                                    <button id="btn-play" class="control-btn" onclick="TriadicClosure.play()"
                                            style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 14px 32px; font-size: 1.05em; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">
                                        ‚ñ∂Ô∏è Play
                                    </button>
                                    <button id="btn-pause" class="control-btn secondary" onclick="TriadicClosure.pause()"
                                            style="padding: 14px 32px; font-size: 1.05em; display: none;">
                                        ‚è∏Ô∏è Pause
                                    </button>
                                    <button class="control-btn secondary" onclick="TriadicClosure.reset()"
                                            style="padding: 14px 32px; font-size: 1.05em;">
                                        üîÑ Reset
                                    </button>
                                    <button class="control-btn secondary" onclick="TriadicClosure.prevStep()"
                                            style="padding: 14px 28px; font-size: 1.05em;">
                                        ‚èÆÔ∏è
                                    </button>
                                    <button class="control-btn secondary" onclick="TriadicClosure.nextStep()"
                                            style="padding: 14px 28px; font-size: 1.05em;">
                                        ‚è≠Ô∏è
                                    </button>
                                </div>

                                <!-- Speed Control -->
                                <div style="display: flex; align-items: center; gap: 10px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
                                    <span style="font-size: 0.9em; color: #6b7280; font-weight: 600;">Speed:</span>
                                    <button class="control-btn secondary" onclick="TriadicClosure.setSpeed(0.5)" id="speed-0.5" style="padding: 8px 16px; font-size: 0.9em;">
                                        0.5x
                                    </button>
                                    <button class="control-btn" onclick="TriadicClosure.setSpeed(1)" id="speed-1" style="padding: 8px 16px; font-size: 0.9em; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                                        1x
                                    </button>
                                    <button class="control-btn secondary" onclick="TriadicClosure.setSpeed(2)" id="speed-2" style="padding: 8px 16px; font-size: 0.9em;">
                                        2x
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Live Metrics Panel -->
                        <div style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
                            <h3 style="margin: 0 0 20px 0; font-size: 1.15em; color: #1f2937; border-bottom: 3px solid #3b82f6; padding-bottom: 12px;">üìä Live Network State</h3>

                            <!-- Current Triad Type -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <div style="font-size: 0.85em; color: #1e40af; font-weight: 600; margin-bottom: 6px;">TRIAD TYPE</div>
                                <div id="live-triad-type" style="font-size: 1.8em; font-weight: 800; color: #1e3a8a; font-family: monospace; letter-spacing: 1px;">003</div>
                                <div id="live-triad-name" style="font-size: 0.9em; color: #3b82f6; margin-top: 4px; font-weight: 500;">Empty</div>
                            </div>

                            <!-- M-A-N Breakdown -->
                            <div style="margin-bottom: 20px;">
                                <div style="font-size: 0.85em; color: #6b7280; font-weight: 600; margin-bottom: 10px;">M-A-N CLASSIFICATION</div>

                                <div style="margin-bottom: 12px; display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 8px; height: 8px; background: #3b82f6; border-radius: 50%;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 0.8em; color: #64748b; margin-bottom: 3px;">Mutual</div>
                                        <div id="live-mutual" style="font-size: 1.3em; font-weight: 700; color: #1e40af;">0</div>
                                    </div>
                                </div>

                                <div style="margin-bottom: 12px; display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 0.8em; color: #64748b; margin-bottom: 3px;">Asymmetric</div>
                                        <div id="live-asymmetric" style="font-size: 1.3em; font-weight: 700; color: #7c3aed;">0</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 8px; height: 8px; background: #94a3b8; border-radius: 50%;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 0.8em; color: #64748b; margin-bottom: 3px;">Null</div>
                                        <div id="live-null" style="font-size: 1.3em; font-weight: 700; color: #475569;">3</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Connection Strength -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-size: 0.85em; color: #065f46; font-weight: 600; margin-bottom: 8px;">TIE STRENGTH</div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                    <span style="font-size: 0.8em; color: #047857;">Strong</span>
                                    <span id="live-strong-count" style="font-size: 0.9em; font-weight: 700; color: #065f46;">0</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 0.8em; color: #047857;">Weak</span>
                                    <span id="live-weak-count" style="font-size: 0.9em; font-weight: 700; color: #065f46;">0</span>
                                </div>
                            </div>

                            <!-- Closure Status -->
                            <div id="closure-status" style="padding: 15px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 10px; border-left: 4px solid #f59e0b;">
                                <div style="font-size: 0.85em; color: #92400e; font-weight: 600; margin-bottom: 6px;">STATUS</div>
                                <div id="closure-status-text" style="font-size: 0.95em; color: #78350f; line-height: 1.5; font-weight: 500;">Open structure</div>
                            </div>

                            <!-- Key Insight -->
                            <div id="live-insight" style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border-radius: 10px; border-left: 4px solid #ef4444;">
                                <div style="font-size: 0.85em; color: #991b1b; font-weight: 600; margin-bottom: 6px;">üí° KEY INSIGHT</div>
                                <div style="font-size: 0.9em; color: #7f1d1d; line-height: 1.6;">Completely disconnected - no information flow possible.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Explanation Cards -->
                    <div id="explanation-cards" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <!-- Cards will be populated by JavaScript -->
                    </div>

                    <!-- Theory Section -->
                    <div style="margin-top: 30px; padding: 25px; background: white; border-radius: 12px; border-left: 5px solid #8b5cf6;">
                        <h3 style="margin-top: 0; color: #6d28d9; font-size: 1.3em;">üß† Why Forbidden Triads Matter</h3>

                        <div class="grid" style="margin-top: 20px;">
                            <div style="padding: 20px; background: #f5f3ff; border-radius: 10px;">
                                <h4 style="color: #6d28d9; margin-top: 0;">‚úÖ Research Principle (Granovetter)</h4>
                                <p style="line-height: 1.8; margin: 0;">
                                    If person A has a <strong>strong tie</strong> with B, and B has a <strong>strong tie</strong> with C, then A and C will likely form a tie too. This is "triadic closure" - creating a closed triangle.
                                </p>
                            </div>

                            <div style="padding: 20px; background: #fef2f2; border-radius: 10px;">
                                <h4 style="color: #dc2626; margin-top: 0;">‚ö†Ô∏è The Problem: Redundancy</h4>
                                <p style="line-height: 1.8; margin: 0;">
                                    When triads close, <strong>information becomes redundant</strong>. If A, B, and C all know each other, any news A hears will likely reach B and C through the same path. No new information flows.
                                </p>
                            </div>

                            <div style="padding: 20px; background: #f0fdf4; border-radius: 10px;">
                                <h4 style="color: #16a34a; margin-top: 0;">üí° Solution: Weak Ties as Bridges</h4>
                                <p style="line-height: 1.8; margin: 0;">
                                    <strong>Weak ties resist triadic closure.</strong> If A-B is weak, and B-C is strong, A and C are unlikely to meet. This keeps the network open, preventing redundancy and allowing novel information to flow.
                                </p>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 18px; background: #fffbeb; border-radius: 10px; border-left: 4px solid #f59e0b;">
                            <p style="margin: 0; line-height: 1.8; color: #92400e;">
                                <strong>üìñ Granovetter's Insight:</strong> "Forbidden triads" (where strong ties resist closure) are rare because strong ties naturally lead to introductions. Networks with many strong ties become dense clusters with high redundancy. Weak ties prevent this, keeping the network open and information-rich.
                            </p>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Information Diffusion Simulator -->
            <div class="section">
                <h2>üì° Information Diffusion Simulator</h2>
                <p style="font-size: 1.1em; line-height: 1.7; color: #4b5563;">Watch how information spreads through networks with different tie strengths. See firsthand why weak ties are more effective at spreading novel information across social boundaries.</p>

                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); padding: 35px; border-radius: 20px; margin-top: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.08);">

                    <!-- Scenario Selection -->
                    <div style="display: flex; gap: 12px; margin-bottom: 30px; flex-wrap: wrap;">
                        <button id="diffusion-dense" class="control-btn" onclick="InformationDiffusion.loadScenario('dense')"
                                style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); padding: 15px 30px; font-size: 1.05em; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);">
                            üî¥ Dense Network
                        </button>
                        <button id="diffusion-bridge" class="control-btn secondary" onclick="InformationDiffusion.loadScenario('bridge')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üåâ Bridge Network
                        </button>
                        <button id="diffusion-weak" class="control-btn secondary" onclick="InformationDiffusion.loadScenario('weak')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üü¢ Weak Ties
                        </button>
                        <button id="diffusion-compare" class="control-btn secondary" onclick="InformationDiffusion.loadScenario('compare')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            ‚öñÔ∏è Compare
                        </button>
                    </div>

                    <!-- Main Visualization Area -->
                    <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 25px; margin-bottom: 30px;">

                        <!-- Left: Diffusion Animation -->
                        <div style="background: white; padding: 35px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">

                            <!-- SVG Network Visualization -->
                            <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 25px; position: relative;">
                                <svg id="diffusion-svg" width="100%" height="500" viewBox="0 0 700 500" style="max-width: 750px;">
                                    <defs>
                                        <!-- Gradients -->
                                        <linearGradient id="infoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="receivedGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="pendingGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#64748b;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#475569;stop-opacity:1" />
                                        </linearGradient>

                                        <!-- Glow effects -->
                                        <filter id="infoGlow">
                                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>

                                        <!-- Drop shadow -->
                                        <filter id="dropShadow" x="-50%" y="-50%" width="200%" height="200%">
                                            <feDropShadow dx="0" dy="3" stdDeviation="5" flood-opacity="0.3"/>
                                        </filter>

                                        <!-- Arrow marker for information flow -->
                                        <marker id="flowArrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                                            <polygon points="0 0, 12 6, 0 12" fill="#f59e0b" />
                                        </marker>
                                    </defs>

                                    <!-- Background grid -->
                                    <g opacity="0.05">
                                        <line x1="0" y1="125" x2="700" y2="125" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="0" y1="250" x2="700" y2="250" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="0" y1="375" x2="700" y2="375" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="175" y1="0" x2="175" y2="500" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="350" y1="0" x2="350" y2="500" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="525" y1="0" x2="525" y2="500" stroke="#cbd5e1" stroke-width="1"/>
                                    </g>

                                    <!-- Edges group (drawn dynamically) -->
                                    <g id="diffusion-edges"></g>

                                    <!-- Flow animations group (information traveling) -->
                                    <g id="diffusion-flows"></g>

                                    <!-- Nodes group (drawn dynamically) -->
                                    <g id="diffusion-nodes"></g>

                                    <!-- Legend -->
                                    <g transform="translate(20, 20)">
                                        <rect width="200" height="105" fill="white" rx="8" opacity="0.95" filter="url(#dropShadow)"/>
                                        <text x="15" y="25" font-size="13" font-weight="bold" fill="#374151">Information State:</text>

                                        <circle cx="25" cy="45" r="8" fill="url(#infoGrad)"/>
                                        <text x="40" y="50" font-size="12" fill="#6b7280">Source/Sending</text>

                                        <circle cx="25" cy="68" r="8" fill="url(#receivedGrad)"/>
                                        <text x="40" y="73" font-size="12" fill="#6b7280">Received</text>

                                        <circle cx="25" cy="91" r="8" fill="url(#pendingGrad)"/>
                                        <text x="40" y="96" font-size="12" fill="#6b7280">Not Yet Reached</text>
                                    </g>
                                </svg>
                            </div>

                            <!-- Timeline and Controls -->
                            <div style="margin: 25px 0;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
                                    <span style="font-size: 0.9em; color: #6b7280; font-weight: 600; min-width: 60px;">Progress</span>
                                    <div style="flex: 1; position: relative; height: 36px; background: #f1f5f9; border-radius: 18px; padding: 6px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);">
                                        <div id="diffusion-progress" style="position: absolute; top: 6px; left: 6px; height: 24px; background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%); border-radius: 12px; width: 0%; transition: width 0.5s ease; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.4);"></div>
                                    </div>
                                    <span id="diffusion-progress-label" style="font-size: 0.9em; color: #f59e0b; font-weight: 700; min-width: 80px; text-align: right;">Step 0/10</span>
                                </div>
                            </div>

                            <!-- Animation Controls -->
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 15px; flex-wrap: wrap; padding: 20px; background: #f8fafc; border-radius: 12px;">
                                <div style="display: flex; gap: 10px; flex: 1; justify-content: center;">
                                    <button id="diffusion-play" class="control-btn" onclick="InformationDiffusion.play()"
                                            style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 14px 32px; font-size: 1.05em; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                                        ‚ñ∂Ô∏è Start
                                    </button>
                                    <button id="diffusion-pause" class="control-btn secondary" onclick="InformationDiffusion.pause()"
                                            style="padding: 14px 32px; font-size: 1.05em; display: none;">
                                        ‚è∏Ô∏è Pause
                                    </button>
                                    <button class="control-btn secondary" onclick="InformationDiffusion.reset()"
                                            style="padding: 14px 32px; font-size: 1.05em;">
                                        üîÑ Reset
                                    </button>
                                    <button class="control-btn secondary" onclick="InformationDiffusion.step()"
                                            style="padding: 14px 32px; font-size: 1.05em;">
                                        ‚è≠Ô∏è Step
                                    </button>
                                </div>

                                <!-- Speed Control -->
                                <div style="display: flex; align-items: center; gap: 10px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
                                    <span style="font-size: 0.9em; color: #6b7280; font-weight: 600;">Speed:</span>
                                    <button class="control-btn secondary" onclick="InformationDiffusion.setSpeed(0.5)" id="diffusion-speed-0.5" style="padding: 8px 16px; font-size: 0.9em;">
                                        0.5x
                                    </button>
                                    <button class="control-btn" onclick="InformationDiffusion.setSpeed(1)" id="diffusion-speed-1" style="padding: 8px 16px; font-size: 0.9em; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                        1x
                                    </button>
                                    <button class="control-btn secondary" onclick="InformationDiffusion.setSpeed(2)" id="diffusion-speed-2" style="padding: 8px 16px; font-size: 0.9em;">
                                        2x
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Live Metrics Panel -->
                        <div style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
                            <h3 style="margin: 0 0 20px 0; font-size: 1.15em; color: #1f2937; border-bottom: 3px solid #f59e0b; padding-bottom: 12px;">üìä Diffusion Metrics</h3>

                            <!-- Current Step -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); border-radius: 10px; border-left: 4px solid #f59e0b;">
                                <div style="font-size: 0.85em; color: #92400e; font-weight: 600; margin-bottom: 6px;">TIME STEP</div>
                                <div id="diffusion-step" style="font-size: 1.8em; font-weight: 800; color: #d97706; font-family: monospace;">0</div>
                            </div>

                            <!-- Nodes Reached -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-size: 0.85em; color: #065f46; font-weight: 600; margin-bottom: 8px;">REACH</div>
                                <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                    <span style="font-size: 2em; font-weight: 800; color: #059669;" id="diffusion-reached">1</span>
                                    <span style="font-size: 0.9em; color: #047857;">/ <span id="diffusion-total">7</span> nodes</span>
                                </div>
                                <div id="diffusion-percent" style="margin-top: 8px; font-size: 1.1em; font-weight: 600; color: #16a34a;">14%</div>
                            </div>

                            <!-- Messages Sent -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <div style="font-size: 0.85em; color: #1e40af; font-weight: 600; margin-bottom: 8px;">MESSAGES</div>
                                <div style="font-size: 1.6em; font-weight: 700; color: #2563eb;" id="diffusion-messages">0</div>
                                <div style="font-size: 0.85em; color: #3b82f6; margin-top: 4px;">transmissions</div>
                            </div>

                            <!-- Efficiency Score -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border-radius: 10px; border-left: 4px solid #ef4444;">
                                <div style="font-size: 0.85em; color: #991b1b; font-weight: 600; margin-bottom: 8px;">REDUNDANCY</div>
                                <div style="font-size: 1.5em; font-weight: 700; color: #dc2626;" id="diffusion-redundancy">0%</div>
                                <div style="font-size: 0.8em; color: #7f1d1d; margin-top: 4px;">duplicate messages</div>
                            </div>

                            <!-- Status -->
                            <div id="diffusion-status" style="padding: 15px; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 10px; border-left: 4px solid #64748b;">
                                <div style="font-size: 0.85em; color: #475569; font-weight: 600; margin-bottom: 6px;">STATUS</div>
                                <div id="diffusion-status-text" style="font-size: 0.95em; color: #1e293b; line-height: 1.5; font-weight: 500;">Ready to start</div>
                            </div>
                        </div>
                    </div>

                    <!-- Scenario Explanation -->
                    <div id="diffusion-explanation" style="padding: 25px; background: white; border-radius: 12px; border-left: 5px solid #8b5cf6; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                        <h4 style="margin: 0 0 15px 0; color: #6d28d9; font-size: 1.2em;">üìñ Scenario: Dense Network</h4>
                        <p id="diffusion-description" style="margin: 0; line-height: 1.8; color: #4b5563;">
                            All nodes are connected with <strong>strong ties</strong>. While information spreads quickly to neighbors, the high overlap means lots of redundant messages. Everyone receives the same information multiple times.
                        </p>
                    </div>

                    <!-- Research Context -->
                    <div style="margin-top: 25px; padding: 25px; background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); border-radius: 12px; border-left: 5px solid #f59e0b;">
                        <h4 style="margin: 0 0 15px 0; color: #92400e; font-size: 1.2em;">üî¨ Research Finding</h4>
                        <p style="margin: 0; line-height: 1.8; color: #78350f;">
                            <strong>Granovetter (1973):</strong> Weak ties serve as bridges between social clusters, dramatically increasing information reach while reducing redundancy. In dense networks with strong ties, information circulates within the same group repeatedly. Weak ties break through to new social circles, providing access to novel information that wouldn't reach you through your close friends.
                        </p>
                    </div>

                </div>
            </div>

            <!-- Bridge Identification Tool -->
            <div class="section">
                <h2>üåâ Bridge Identification Tool</h2>
                <p style="font-size: 1.1em; line-height: 1.7; color: #4b5563;">Discover which connections are critical for network cohesion. Click edges to remove them and see how bridges hold social networks together. Understand why weak ties that act as bridges are so valuable.</p>

                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); padding: 35px; border-radius: 20px; margin-top: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.08);">

                    <!-- Scenario Selection -->
                    <div style="display: flex; gap: 12px; margin-bottom: 30px; flex-wrap: wrap;">
                        <button id="bridge-social" class="control-btn" onclick="BridgeIdentifier.loadScenario('social')"
                                style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); padding: 15px 30px; font-size: 1.05em; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);">
                            üë• Social Network
                        </button>
                        <button id="bridge-professional" class="control-btn secondary" onclick="BridgeIdentifier.loadScenario('professional')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üíº Professional Network
                        </button>
                        <button id="bridge-community" class="control-btn secondary" onclick="BridgeIdentifier.loadScenario('community')"
                                style="padding: 15px 30px; font-size: 1.05em;">
                            üèòÔ∏è Community Network
                        </button>
                    </div>

                    <!-- Instruction Banner -->
                    <div style="margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 12px; border-left: 5px solid #3b82f6;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 2em;">üëÜ</div>
                            <div>
                                <h4 style="margin: 0 0 8px 0; color: #1e40af; font-size: 1.1em;">How to Use</h4>
                                <p style="margin: 0; color: #1e3a8a; line-height: 1.6;">
                                    <strong>Click edges</strong> to remove/restore them and see how the network changes.
                                    <strong>Bridges</strong> are highlighted in red - these connections hold the network together!
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Main Visualization Area -->
                    <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 25px; margin-bottom: 30px;">

                        <!-- Left: Interactive Network -->
                        <div style="background: white; padding: 35px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">

                            <!-- SVG Network Visualization -->
                            <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 25px; position: relative;">
                                <svg id="bridge-svg" width="100%" height="550" viewBox="0 0 700 550" style="max-width: 750px; cursor: pointer;">
                                    <defs>
                                        <!-- Gradients -->
                                        <linearGradient id="bridgeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="localBridgeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="normalEdgeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#94a3b8;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#64748b;stop-opacity:1" />
                                        </linearGradient>

                                        <linearGradient id="bridgeNodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
                                        </linearGradient>

                                        <!-- Filters -->
                                        <filter id="bridgeGlow">
                                            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>

                                        <filter id="nodeShadowBridge" x="-50%" y="-50%" width="200%" height="200%">
                                            <feDropShadow dx="0" dy="3" stdDeviation="5" flood-opacity="0.3"/>
                                        </filter>
                                    </defs>

                                    <!-- Background grid -->
                                    <g opacity="0.05">
                                        <line x1="0" y1="137" x2="700" y2="137" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="0" y1="275" x2="700" y2="275" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="0" y1="412" x2="700" y2="412" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="175" y1="0" x2="175" y2="550" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="350" y1="0" x2="350" y2="550" stroke="#cbd5e1" stroke-width="1"/>
                                        <line x1="525" y1="0" x2="525" y2="550" stroke="#cbd5e1" stroke-width="1"/>
                                    </g>

                                    <!-- Edges group (drawn dynamically, clickable) -->
                                    <g id="bridge-edges"></g>

                                    <!-- Nodes group (drawn dynamically) -->
                                    <g id="bridge-nodes"></g>

                                    <!-- Legend -->
                                    <g transform="translate(20, 20)">
                                        <rect width="220" height="135" fill="white" rx="8" opacity="0.95" filter="url(#nodeShadowBridge)"/>
                                        <text x="15" y="25" font-size="13" font-weight="bold" fill="#374151">Edge Types:</text>

                                        <line x1="20" y1="45" x2="55" y2="45" stroke="#ef4444" stroke-width="4"/>
                                        <text x="65" y="50" font-size="12" fill="#6b7280">Critical Bridge</text>

                                        <line x1="20" y1="68" x2="55" y2="68" stroke="#f59e0b" stroke-width="3"/>
                                        <text x="65" y="73" font-size="12" fill="#6b7280">Local Bridge</text>

                                        <line x1="20" y1="91" x2="55" y2="91" stroke="#94a3b8" stroke-width="2"/>
                                        <text x="65" y="96" font-size="12" fill="#6b7280">Regular Edge</text>

                                        <line x1="20" y1="114" x2="55" y2="114" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="4,4" opacity="0.5"/>
                                        <text x="65" y="119" font-size="12" fill="#6b7280">Removed</text>
                                    </g>
                                </svg>
                            </div>

                            <!-- Network Controls -->
                            <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; padding: 20px; background: #f8fafc; border-radius: 12px;">
                                <button class="control-btn" onclick="BridgeIdentifier.reset()"
                                        style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); padding: 14px 32px; font-size: 1.05em; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);">
                                    üîÑ Reset Network
                                </button>
                                <button class="control-btn secondary" onclick="BridgeIdentifier.removeAllBridges()"
                                        style="padding: 14px 32px; font-size: 1.05em;">
                                    ‚ùå Remove All Bridges
                                </button>
                                <button class="control-btn secondary" onclick="BridgeIdentifier.highlightCritical()"
                                        style="padding: 14px 32px; font-size: 1.05em;">
                                    üí° Highlight Critical
                                </button>
                            </div>
                        </div>

                        <!-- Right: Live Metrics Panel -->
                        <div style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.06);">
                            <h3 style="margin: 0 0 20px 0; font-size: 1.15em; color: #1f2937; border-bottom: 3px solid #8b5cf6; padding-bottom: 12px;">üìä Bridge Metrics</h3>

                            <!-- Connected Components -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-radius: 10px; border-left: 4px solid #10b981;">
                                <div style="font-size: 0.85em; color: #065f46; font-weight: 600; margin-bottom: 6px;">CONNECTIVITY</div>
                                <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                    <span style="font-size: 2em; font-weight: 800; color: #059669;" id="bridge-components">1</span>
                                    <span style="font-size: 0.9em; color: #047857;">component(s)</span>
                                </div>
                                <div id="bridge-connected-status" style="margin-top: 8px; font-size: 0.9em; font-weight: 600; color: #16a34a;">‚úÖ Fully Connected</div>
                            </div>

                            <!-- Critical Bridges -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border-radius: 10px; border-left: 4px solid #ef4444;">
                                <div style="font-size: 0.85em; color: #991b1b; font-weight: 600; margin-bottom: 8px;">CRITICAL BRIDGES</div>
                                <div style="font-size: 1.6em; font-weight: 700; color: #dc2626;" id="bridge-critical-count">0</div>
                                <div style="font-size: 0.85em; color: #7f1d1d; margin-top: 4px;">edges disconnect network</div>
                            </div>

                            <!-- Local Bridges -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); border-radius: 10px; border-left: 4px solid #f59e0b;">
                                <div style="font-size: 0.85em; color: #92400e; font-weight: 600; margin-bottom: 8px;">LOCAL BRIDGES</div>
                                <div style="font-size: 1.6em; font-weight: 700; color: #d97706;" id="bridge-local-count">0</div>
                                <div style="font-size: 0.85em; color: #78350f; margin-top: 4px;">long-distance ties</div>
                            </div>

                            <!-- Betweenness Score -->
                            <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 10px; border-left: 4px solid #3b82f6;">
                                <div style="font-size: 0.85em; color: #1e40af; font-weight: 600; margin-bottom: 8px;">AVG BETWEENNESS</div>
                                <div style="font-size: 1.5em; font-weight: 700; color: #2563eb;" id="bridge-betweenness">0.0</div>
                                <div style="font-size: 0.8em; color: #1e3a8a; margin-top: 4px;">edge centrality score</div>
                            </div>

                            <!-- Current Selection -->
                            <div id="bridge-selection" style="padding: 15px; background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 10px; border-left: 4px solid #8b5cf6;">
                                <div style="font-size: 0.85em; color: #6b21a8; font-weight: 600; margin-bottom: 6px;">SELECTED EDGE</div>
                                <div id="bridge-selection-text" style="font-size: 0.95em; color: #581c87; line-height: 1.5; font-weight: 500;">Click an edge to analyze</div>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Panel -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px;">
                        <!-- Bridge Explanation -->
                        <div style="padding: 25px; background: white; border-radius: 12px; border-left: 5px solid #ef4444; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                            <h4 style="margin: 0 0 15px 0; color: #dc2626; font-size: 1.2em;">üî¥ Critical Bridges</h4>
                            <p style="margin: 0; line-height: 1.8; color: #4b5563;">
                                <strong>Graph theory definition:</strong> An edge whose removal <strong>increases the number of connected components</strong>.
                                If you remove a critical bridge, parts of the network become unreachable from each other.
                                These are the most vulnerable points in social networks.
                            </p>
                        </div>

                        <!-- Local Bridge Explanation -->
                        <div style="padding: 25px; background: white; border-radius: 12px; border-left: 5px solid #f59e0b; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                            <h4 style="margin: 0 0 15px 0; color: #d97706; font-size: 1.2em;">üü° Local Bridges (Granovetter)</h4>
                            <p style="margin: 0; line-height: 1.8; color: #4b5563;">
                                <strong>Granovetter's definition:</strong> An edge where the two endpoints have <strong>no common neighbors</strong>.
                                Local bridges are typically weak ties that connect distant parts of a network,
                                providing access to novel information that wouldn't reach you through your close friends.
                            </p>
                        </div>
                    </div>

                    <!-- Research Context -->
                    <div style="margin-top: 25px; padding: 25px; background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 12px; border-left: 5px solid #8b5cf6;">
                        <h4 style="margin: 0 0 15px 0; color: #6b21a8; font-size: 1.2em;">üî¨ Research Finding</h4>
                        <p style="margin: 0; line-height: 1.8; color: #581c87;">
                            <strong>Granovetter (1973):</strong> "All bridges are weak ties, but not all weak ties are bridges."
                            Weak ties that act as bridges are especially valuable because they provide the <strong>only path</strong>
                            to information in distant social circles. When you remove a bridge, you lose access to entire clusters of people.
                            This is why maintaining even infrequently-contacted acquaintances can be so important for opportunities like job searches.
                        </p>
                    </div>

                </div>
            </div>

            <!-- Attribution -->
            <div class="attribution">
                <p><strong>Interactive Tool:</strong> Based on network analysis principles from Granovetter (1973)</p>
                <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">All calculations use graph theory algorithms to measure real network properties</p>
            </div>
        </div>
    </div>

    <script>
        // Page Switching
        function switchPage(pageId, button) {
            // Hide all pages
            document.getElementById('main').style.display = 'none';
            document.getElementById('process').style.display = 'none';
            document.getElementById('analysis').style.display = 'none';
            document.getElementById('interactive').style.display = 'none';

            // Show selected page
            document.getElementById(pageId).style.display = 'block';

            // Update active button
            const buttons = document.querySelectorAll('.page-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            // Initialize simulator if switching to interactive page
            if (pageId === 'interactive' && !NetworkSimulator.canvas) {
                setTimeout(() => NetworkSimulator.init(), 100);
            }

            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Tab Switching for Methodology
        function showMethodTab(tabId) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabId).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const button = document.querySelector('.dark-mode-toggle');
            if (document.body.classList.contains('dark-mode')) {
                button.textContent = '‚òÄÔ∏è Light Mode';
            } else {
                button.textContent = 'üåô Dark Mode';
            }
        }

        // ========================================
        // INTERACTIVE NETWORK SIMULATOR
        // Commercial BI-Quality Tool
        // ========================================

        const NetworkSimulator = {
            nodes: [],
            edges: [],
            selectedNode: null,
            draggedNode: null,
            canvas: null,
            ctx: null,
            isDrawingMode: false,
            tempEdgeStart: null,
            edgeType: 'weak', // 'weak' or 'strong'
            nodeIdCounter: 0,

            init() {
                this.canvas = document.getElementById('networkCanvas');
                if (!this.canvas) return;

                this.ctx = this.canvas.getContext('2d');
                this.setupCanvas();
                this.setupEventListeners();
                this.loadPresetNetwork('basic');

                // Force initial render
                setTimeout(() => {
                    this.setupCanvas();
                    this.render();
                }, 50);
            },

            setupCanvas() {
                const rect = this.canvas.getBoundingClientRect();
                // Ensure canvas has minimum dimensions
                this.canvas.width = rect.width > 0 ? rect.width : 800;
                this.canvas.height = rect.height > 0 ? rect.height : 600;
                this.render();
            },

            setupEventListeners() {
                this.canvas.addEventListener('mousedown', this.handleMouseDown.bind(this));
                this.canvas.addEventListener('mousemove', this.handleMouseMove.bind(this));
                this.canvas.addEventListener('mouseup', this.handleMouseUp.bind(this));
                this.canvas.addEventListener('dblclick', this.handleDoubleClick.bind(this));

                window.addEventListener('resize', () => {
                    this.setupCanvas();
                });
            },

            handleMouseDown(e) {
                const pos = this.getMousePos(e);
                const clickedNode = this.getNodeAtPosition(pos.x, pos.y);

                if (this.isDrawingMode) {
                    if (clickedNode) {
                        if (!this.tempEdgeStart) {
                            // First click - select starting node
                            this.tempEdgeStart = clickedNode;
                            this.selectedNode = clickedNode;
                            this.canvas.style.cursor = 'crosshair';
                            console.log('Selected start node:', clickedNode.label);
                        } else {
                            // Second click - create edge
                            if (clickedNode !== this.tempEdgeStart) {
                                this.addEdge(this.tempEdgeStart, clickedNode, this.edgeType);
                                console.log('Created edge:', this.tempEdgeStart.label, '->', clickedNode.label);
                            }
                            this.tempEdgeStart = null;
                            this.selectedNode = null;
                        }
                    } else {
                        // Clicked empty space - cancel edge drawing
                        this.tempEdgeStart = null;
                        this.selectedNode = null;
                    }
                } else {
                    if (clickedNode) {
                        this.draggedNode = clickedNode;
                        this.selectedNode = clickedNode;
                        this.canvas.style.cursor = 'grabbing';
                    } else {
                        this.selectedNode = null;
                    }
                }
                this.render();
            },

            handleMouseMove(e) {
                const pos = this.getMousePos(e);

                if (this.draggedNode && !this.isDrawingMode) {
                    // Only allow dragging when not in drawing mode
                    this.draggedNode.x = pos.x;
                    this.draggedNode.y = pos.y;
                    this.render();
                } else if (this.tempEdgeStart && this.isDrawingMode) {
                    // Draw temporary edge line when in drawing mode
                    this.render();
                    this.ctx.save();
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.tempEdgeStart.x, this.tempEdgeStart.y);
                    this.ctx.lineTo(pos.x, pos.y);
                    this.ctx.strokeStyle = this.edgeType === 'strong' ? '#1e3c72' : '#94a3b8';
                    this.ctx.lineWidth = this.edgeType === 'strong' ? 4 : 2;
                    if (this.edgeType === 'weak') {
                        this.ctx.setLineDash([5, 5]);
                    }
                    this.ctx.stroke();
                    this.ctx.restore();
                } else {
                    // Update cursor based on hover and mode
                    const hoverNode = this.getNodeAtPosition(pos.x, pos.y);
                    if (this.isDrawingMode) {
                        this.canvas.style.cursor = hoverNode ? 'pointer' : 'crosshair';
                    } else {
                        this.canvas.style.cursor = hoverNode ? 'move' : 'default';
                    }
                }
            },

            handleMouseUp(e) {
                // Only handle drag completion, edge creation is in handleMouseDown
                if (this.draggedNode) {
                    this.draggedNode = null;
                    this.updateMetrics();
                }

                // Reset cursor based on mode
                if (this.isDrawingMode) {
                    this.canvas.style.cursor = 'crosshair';
                } else {
                    this.canvas.style.cursor = 'default';
                }

                this.render();
            },

            handleDoubleClick(e) {
                const pos = this.getMousePos(e);
                const clickedNode = this.getNodeAtPosition(pos.x, pos.y);

                if (!clickedNode) {
                    this.addNode(pos.x, pos.y);
                }
            },

            getMousePos(e) {
                const rect = this.canvas.getBoundingClientRect();
                return {
                    x: e.clientX - rect.left,
                    y: e.clientY - rect.top
                };
            },

            getNodeAtPosition(x, y) {
                return this.nodes.find(node => {
                    const dx = node.x - x;
                    const dy = node.y - y;
                    return Math.sqrt(dx * dx + dy * dy) < node.radius;
                });
            },

            addNode(x, y, label = null) {
                const node = {
                    id: this.nodeIdCounter++,
                    x: x,
                    y: y,
                    radius: 20,
                    label: label || `P${this.nodeIdCounter}`,
                    color: '#1e3c72'
                };
                this.nodes.push(node);
                this.render();
                this.updateMetrics();
            },

            addEdge(node1, node2, type = 'weak') {
                // Check if edge already exists
                const exists = this.edges.some(e =>
                    (e.from === node1 && e.to === node2) ||
                    (e.from === node2 && e.to === node1)
                );

                if (!exists) {
                    this.edges.push({
                        from: node1,
                        to: node2,
                        type: type,
                        strength: type === 'strong' ? 1 : 0.3
                    });
                    this.render();
                    this.updateMetrics();
                }
            },

            removeSelectedNode() {
                if (this.selectedNode) {
                    // Remove all edges connected to this node
                    this.edges = this.edges.filter(e =>
                        e.from !== this.selectedNode && e.to !== this.selectedNode
                    );
                    // Remove the node
                    this.nodes = this.nodes.filter(n => n !== this.selectedNode);
                    this.selectedNode = null;
                    this.render();
                    this.updateMetrics();
                }
            },

            clearNetwork() {
                this.nodes = [];
                this.edges = [];
                this.selectedNode = null;
                this.draggedNode = null;
                this.tempEdgeStart = null;
                this.nodeIdCounter = 0;
                this.render();
                this.updateMetrics();
            },

            loadPresetNetwork(type) {
                this.clearNetwork();

                // Ensure canvas is properly sized before creating network
                this.setupCanvas();

                const w = this.canvas.width;
                const h = this.canvas.height;
                const centerX = w / 2;
                const centerY = h / 2;

                if (type === 'basic') {
                    // You (center) with 3 close friends (strong ties)
                    this.addNode(centerX, centerY, 'YOU');
                    this.addNode(centerX - 120, centerY - 80, 'Friend A');
                    this.addNode(centerX + 120, centerY - 80, 'Friend B');
                    this.addNode(centerX, centerY + 120, 'Friend C');

                    // Strong ties
                    this.addEdge(this.nodes[0], this.nodes[1], 'strong');
                    this.addEdge(this.nodes[0], this.nodes[2], 'strong');
                    this.addEdge(this.nodes[0], this.nodes[3], 'strong');

                    // Triadic closure
                    this.addEdge(this.nodes[1], this.nodes[2], 'strong');
                    this.addEdge(this.nodes[2], this.nodes[3], 'strong');
                }

                if (type === 'bridges') {
                    // Left cluster
                    this.addNode(150, centerY, 'YOU');
                    this.addNode(100, centerY - 80, 'A1');
                    this.addNode(100, centerY + 80, 'A2');

                    // Strong ties in left cluster
                    this.addEdge(this.nodes[0], this.nodes[1], 'strong');
                    this.addEdge(this.nodes[0], this.nodes[2], 'strong');
                    this.addEdge(this.nodes[1], this.nodes[2], 'strong');

                    // Bridge person
                    this.addNode(centerX + 100, centerY, 'Bridge');
                    this.addEdge(this.nodes[0], this.nodes[3], 'weak');

                    // Right cluster
                    this.addNode(w - 150, centerY - 80, 'B1');
                    this.addNode(w - 150, centerY + 80, 'B2');
                    this.addNode(w - 100, centerY, 'B3');

                    // Strong ties in right cluster
                    this.addEdge(this.nodes[3], this.nodes[4], 'strong');
                    this.addEdge(this.nodes[3], this.nodes[5], 'strong');
                    this.addEdge(this.nodes[4], this.nodes[6], 'strong');
                    this.addEdge(this.nodes[5], this.nodes[6], 'strong');
                }

                if (type === 'realistic') {
                    // Create a realistic mixed network
                    const positions = [
                        {x: centerX, y: centerY, label: 'YOU'},
                        // Close circle (strong ties)
                        {x: centerX - 100, y: centerY - 60, label: 'Family'},
                        {x: centerX + 100, y: centerY - 60, label: 'Best Friend'},
                        {x: centerX - 80, y: centerY + 80, label: 'Colleague'},
                        // Weak ties (bridges)
                        {x: 120, y: 150, label: 'Former Classmate'},
                        {x: w - 120, y: 150, label: 'Industry Contact'},
                        {x: 120, y: h - 120, label: 'Neighbor'},
                        {x: w - 120, y: h - 120, label: 'Acquaintance'},
                        // Extended network
                        {x: 80, y: 300, label: 'Friend of Friend'},
                        {x: w - 80, y: 300, label: 'LinkedIn Connection'}
                    ];

                    positions.forEach(p => this.addNode(p.x, p.y, p.label));

                    // Strong ties (close circle)
                    this.addEdge(this.nodes[0], this.nodes[1], 'strong');
                    this.addEdge(this.nodes[0], this.nodes[2], 'strong');
                    this.addEdge(this.nodes[0], this.nodes[3], 'strong');
                    this.addEdge(this.nodes[1], this.nodes[2], 'strong'); // Triadic closure

                    // Weak ties (bridges to other clusters)
                    this.addEdge(this.nodes[0], this.nodes[4], 'weak');
                    this.addEdge(this.nodes[0], this.nodes[5], 'weak');
                    this.addEdge(this.nodes[0], this.nodes[6], 'weak');
                    this.addEdge(this.nodes[0], this.nodes[7], 'weak');

                    // Extended connections
                    this.addEdge(this.nodes[4], this.nodes[8], 'weak');
                    this.addEdge(this.nodes[5], this.nodes[9], 'weak');
                }

                // Force render after loading preset
                setTimeout(() => {
                    this.render();
                    this.updateMetrics();
                }, 10);
            },

            render() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // Draw edges first
                this.edges.forEach(edge => {
                    this.drawEdge(edge);
                });

                // Draw nodes on top
                this.nodes.forEach(node => {
                    this.drawNode(node);
                });
            },

            drawEdge(edge) {
                this.ctx.save();
                this.ctx.beginPath();
                this.ctx.moveTo(edge.from.x, edge.from.y);
                this.ctx.lineTo(edge.to.x, edge.to.y);

                if (edge.type === 'strong') {
                    this.ctx.strokeStyle = '#1e3c72';
                    this.ctx.lineWidth = 4;
                    this.ctx.setLineDash([]);
                } else {
                    this.ctx.strokeStyle = '#94a3b8';
                    this.ctx.lineWidth = 2;
                    this.ctx.setLineDash([5, 5]);
                }

                this.ctx.stroke();
                this.ctx.restore();
            },

            drawNode(node) {
                this.ctx.save();

                // Draw selection glow
                if (node === this.selectedNode) {
                    this.ctx.shadowColor = '#fbbf24';
                    this.ctx.shadowBlur = 15;
                }

                // Draw node circle
                this.ctx.beginPath();
                this.ctx.arc(node.x, node.y, node.radius, 0, Math.PI * 2);
                this.ctx.fillStyle = node.color;
                this.ctx.fill();

                // Draw border
                this.ctx.strokeStyle = node === this.selectedNode ? '#fbbf24' : '#fff';
                this.ctx.lineWidth = node === this.selectedNode ? 3 : 2;
                this.ctx.stroke();

                this.ctx.shadowBlur = 0;

                // Draw label
                this.ctx.fillStyle = '#fff';
                this.ctx.font = 'bold 11px -apple-system, sans-serif';
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                this.ctx.fillText(node.label, node.x, node.y);

                this.ctx.restore();
            },

            setEdgeType(type) {
                this.edgeType = type;
                // Update button states
                document.querySelectorAll('.edge-type-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById(`edge-${type}`).classList.add('active');
            },

            toggleDrawMode() {
                this.isDrawingMode = !this.isDrawingMode;
                const btn = document.getElementById('draw-mode-btn');
                if (this.isDrawingMode) {
                    btn.classList.add('active');
                    btn.textContent = '‚úèÔ∏è Drawing Mode (ON)';
                    this.canvas.style.cursor = 'crosshair';
                } else {
                    btn.classList.remove('active');
                    btn.textContent = '‚úèÔ∏è Enable Drawing Mode';
                    this.canvas.style.cursor = 'default';
                }
            },

            // Network Analysis Metrics
            calculateMetrics() {
                const n = this.nodes.length;
                const e = this.edges.length;

                if (n === 0) {
                    return {
                        nodeCount: 0,
                        edgeCount: 0,
                        density: 0,
                        avgDegree: 0,
                        strongTieRatio: 0,
                        weakTieRatio: 0,
                        bridgeCount: 0,
                        clusteringCoefficient: 0
                    };
                }

                const maxPossibleEdges = (n * (n - 1)) / 2;
                const density = maxPossibleEdges > 0 ? e / maxPossibleEdges : 0;
                const avgDegree = n > 0 ? (2 * e) / n : 0;

                const strongTies = this.edges.filter(e => e.type === 'strong').length;
                const weakTies = this.edges.filter(e => e.type === 'weak').length;

                const strongTieRatio = e > 0 ? strongTies / e : 0;
                const weakTieRatio = e > 0 ? weakTies / e : 0;

                const bridgeCount = this.countBridges();
                const clusteringCoefficient = this.calculateClustering();

                return {
                    nodeCount: n,
                    edgeCount: e,
                    density: density,
                    avgDegree: avgDegree,
                    strongTieRatio: strongTieRatio,
                    weakTieRatio: weakTieRatio,
                    bridgeCount: bridgeCount,
                    clusteringCoefficient: clusteringCoefficient
                };
            },

            countBridges() {
                let bridges = 0;

                this.edges.forEach(edge => {
                    // An edge is a bridge if removing it disconnects the graph
                    // Simplified: check if it's the only path between two clusters
                    if (this.isBridge(edge)) {
                        bridges++;
                    }
                });

                return bridges;
            },

            isBridge(edge) {
                // Simplified bridge detection
                // A tie is more likely to be a bridge if it's weak and connects otherwise unconnected groups
                if (edge.type !== 'weak') return false;

                // Check if the two nodes have any common neighbors
                const neighbors1 = this.getNeighbors(edge.from);
                const neighbors2 = this.getNeighbors(edge.to);

                const commonNeighbors = neighbors1.filter(n => neighbors2.includes(n));

                // If they have no common neighbors (except through this edge), it's likely a bridge
                return commonNeighbors.length === 0;
            },

            getNeighbors(node) {
                return this.edges
                    .filter(e => e.from === node || e.to === node)
                    .map(e => e.from === node ? e.to : e.from);
            },

            calculateClustering() {
                if (this.nodes.length < 3) return 0;

                let totalClustering = 0;

                this.nodes.forEach(node => {
                    const neighbors = this.getNeighbors(node);
                    const k = neighbors.length;

                    if (k < 2) return;

                    let actualEdges = 0;
                    for (let i = 0; i < neighbors.length; i++) {
                        for (let j = i + 1; j < neighbors.length; j++) {
                            if (this.areConnected(neighbors[i], neighbors[j])) {
                                actualEdges++;
                            }
                        }
                    }

                    const possibleEdges = (k * (k - 1)) / 2;
                    const clustering = possibleEdges > 0 ? actualEdges / possibleEdges : 0;
                    totalClustering += clustering;
                });

                return totalClustering / this.nodes.length;
            },

            areConnected(node1, node2) {
                return this.edges.some(e =>
                    (e.from === node1 && e.to === node2) ||
                    (e.from === node2 && e.to === node1)
                );
            },

            updateMetrics() {
                const metrics = this.calculateMetrics();

                document.getElementById('metric-nodes').textContent = metrics.nodeCount;
                document.getElementById('metric-edges').textContent = metrics.edgeCount;
                document.getElementById('metric-density').textContent = (metrics.density * 100).toFixed(1) + '%';
                document.getElementById('metric-avgdegree').textContent = metrics.avgDegree.toFixed(1);
                document.getElementById('metric-strong').textContent = (metrics.strongTieRatio * 100).toFixed(0) + '%';
                document.getElementById('metric-weak').textContent = (metrics.weakTieRatio * 100).toFixed(0) + '%';
                document.getElementById('metric-bridges').textContent = metrics.bridgeCount;
                document.getElementById('metric-clustering').textContent = (metrics.clusteringCoefficient * 100).toFixed(1) + '%';

                // Update quality indicator
                this.updateQualityIndicator(metrics);
            },

            updateQualityIndicator(metrics) {
                const indicator = document.getElementById('network-quality');
                if (!indicator) return;

                // Good network: high weak tie ratio, some bridges, moderate clustering
                let score = 0;

                if (metrics.weakTieRatio > 0.4) score += 35;
                else if (metrics.weakTieRatio > 0.2) score += 20;

                if (metrics.bridgeCount > 2) score += 30;
                else if (metrics.bridgeCount > 0) score += 15;

                if (metrics.clusteringCoefficient > 0.3 && metrics.clusteringCoefficient < 0.7) score += 20;
                if (metrics.density > 0.15 && metrics.density < 0.5) score += 15;

                let quality = 'Poor';
                let color = '#ef4444';

                if (score >= 70) {
                    quality = 'Excellent';
                    color = '#10b981';
                } else if (score >= 50) {
                    quality = 'Good';
                    color = '#3b82f6';
                } else if (score >= 30) {
                    quality = 'Fair';
                    color = '#f59e0b';
                }

                indicator.textContent = quality;
                indicator.style.background = color;
            }
        };

        // ========================================
        // JOB SEARCH PROBABILITY CALCULATOR
        // ========================================

        const JobSearchCalculator = {
            // Empirical data from Granovetter (1973)
            baseline: {
                strong: 0.167,    // 16.7%
                moderate: 0.556,  // 55.6%
                weak: 0.278       // 27.8%
            },

            values: {
                strong: 33,
                moderate: 34,
                weak: 33
            },

            init() {
                this.calculate();
            },

            updateSlider(type, value) {
                const numValue = parseInt(value);
                this.values[type] = numValue;

                // Auto-normalize to 100%
                this.normalize(type);

                // Update UI
                this.updateSliderUI();

                // Recalculate
                this.calculate();
            },

            normalize(changedType) {
                const total = this.values.strong + this.values.moderate + this.values.weak;

                if (total === 0) {
                    // Reset to equal distribution
                    this.values.strong = 33;
                    this.values.moderate = 34;
                    this.values.weak = 33;
                    return;
                }

                if (total !== 100) {
                    // Proportionally adjust the other two
                    const others = total - this.values[changedType];
                    if (others > 0) {
                        const types = ['strong', 'moderate', 'weak'].filter(t => t !== changedType);
                        const ratio1 = this.values[types[0]] / others;
                        const ratio2 = this.values[types[1]] / others;

                        const remaining = 100 - this.values[changedType];
                        this.values[types[0]] = Math.round(remaining * ratio1);
                        this.values[types[1]] = 100 - this.values[changedType] - this.values[types[0]];
                    } else {
                        // If others are 0, split remaining equally
                        const types = ['strong', 'moderate', 'weak'].filter(t => t !== changedType);
                        const remaining = 100 - this.values[changedType];
                        this.values[types[0]] = Math.floor(remaining / 2);
                        this.values[types[1]] = remaining - this.values[types[0]];
                    }
                }
            },

            updateSliderUI() {
                // Update values
                document.getElementById('strong-value').textContent = this.values.strong + '%';
                document.getElementById('moderate-value').textContent = this.values.moderate + '%';
                document.getElementById('weak-value').textContent = this.values.weak + '%';

                // Update sliders
                const strongSlider = document.getElementById('strong-slider');
                const moderateSlider = document.getElementById('moderate-slider');
                const weakSlider = document.getElementById('weak-slider');

                if (strongSlider) {
                    strongSlider.value = this.values.strong;
                    strongSlider.style.background = `linear-gradient(to right, #e74c3c 0%, #e74c3c ${this.values.strong}%, #e0e6ed ${this.values.strong}%, #e0e6ed 100%)`;
                }

                if (moderateSlider) {
                    moderateSlider.value = this.values.moderate;
                    moderateSlider.style.background = `linear-gradient(to right, #3498db 0%, #3498db ${this.values.moderate}%, #e0e6ed ${this.values.moderate}%, #e0e6ed 100%)`;
                }

                if (weakSlider) {
                    weakSlider.value = this.values.weak;
                    weakSlider.style.background = `linear-gradient(to right, #2ecc71 0%, #2ecc71 ${this.values.weak}%, #e0e6ed ${this.values.weak}%, #e0e6ed 100%)`;
                }

                // Update total
                const total = this.values.strong + this.values.moderate + this.values.weak;
                document.getElementById('total-percentage').textContent = total + '%';
            },

            calculate() {
                // Calculate expected job leads based on user's network composition
                // Higher weights for weak/moderate ties (per Granovetter's findings)
                const userStrong = this.values.strong / 100;
                const userModerate = this.values.moderate / 100;
                const userWeak = this.values.weak / 100;

                // Calculate expected leads proportional to baseline success rates
                const strongLeads = userStrong * this.baseline.strong;
                const moderateLeads = userModerate * this.baseline.moderate;
                const weakLeads = userWeak * this.baseline.weak;

                const totalLeads = strongLeads + moderateLeads + weakLeads;

                // Normalize to percentages
                const strongPct = totalLeads > 0 ? (strongLeads / totalLeads) * 100 : 0;
                const moderatePct = totalLeads > 0 ? (moderateLeads / totalLeads) * 100 : 0;
                const weakPct = totalLeads > 0 ? (weakLeads / totalLeads) * 100 : 0;

                // Calculate success probability relative to baseline
                // Baseline is if network matches empirical distribution perfectly
                const baselineScore = this.baseline.strong * this.baseline.strong +
                                     this.baseline.moderate * this.baseline.moderate +
                                     this.baseline.weak * this.baseline.weak;

                const userScore = userStrong * this.baseline.strong +
                                 userModerate * this.baseline.moderate +
                                 userWeak * this.baseline.weak;

                const successProbability = (userScore / baselineScore) * 100;

                // Update display
                this.updateResults(successProbability, strongPct, moderatePct, weakPct);
            },

            updateResults(successProb, strongPct, moderatePct, weakPct) {
                // Update probability display
                const probElement = document.getElementById('success-probability');
                const barElement = document.getElementById('probability-bar');

                if (probElement) {
                    probElement.textContent = successProb.toFixed(0) + '%';

                    // Color based on probability
                    if (successProb >= 100) {
                        probElement.style.color = '#10b981';
                    } else if (successProb >= 80) {
                        probElement.style.color = '#3b82f6';
                    } else if (successProb >= 60) {
                        probElement.style.color = '#f59e0b';
                    } else {
                        probElement.style.color = '#ef4444';
                    }
                }

                // Update progress bar
                if (barElement) {
                    const width = Math.min(successProb, 100);
                    barElement.style.width = width + '%';

                    let label = '';
                    let bgColor = '';

                    if (successProb >= 100) {
                        label = 'Excellent';
                        bgColor = 'linear-gradient(90deg, #10b981 0%, #059669 100%)';
                    } else if (successProb >= 80) {
                        label = 'Good';
                        bgColor = 'linear-gradient(90deg, #3b82f6 0%, #2563eb 100%)';
                    } else if (successProb >= 60) {
                        label = 'Fair';
                        bgColor = 'linear-gradient(90deg, #f59e0b 0%, #d97706 100%)';
                    } else {
                        label = 'Below Average';
                        bgColor = 'linear-gradient(90deg, #ef4444 0%, #dc2626 100%)';
                    }

                    barElement.textContent = label;
                    barElement.style.background = bgColor;
                }

                // Update breakdown
                document.getElementById('strong-leads').textContent = strongPct.toFixed(0) + '%';
                document.getElementById('moderate-leads').textContent = moderatePct.toFixed(0) + '%';
                document.getElementById('weak-leads').textContent = weakPct.toFixed(0) + '%';

                // Update comparison text
                this.updateComparison(successProb);
            },

            updateComparison(successProb) {
                const comparisonText = document.getElementById('comparison-text');
                if (!comparisonText) return;

                const strongDiff = this.values.strong - (this.baseline.strong * 100);
                const weakDiff = this.values.weak - (this.baseline.weak * 100);

                let message = '';

                if (successProb >= 105) {
                    message = `üéâ <strong>Excellent network composition!</strong> Your network has a higher proportion of weak ties (${this.values.weak}%) compared to the study baseline (${(this.baseline.weak * 100).toFixed(1)}%). This gives you access to more diverse, non-redundant job information.`;
                } else if (successProb >= 95 && successProb < 105) {
                    message = `‚úÖ <strong>Well-balanced network.</strong> Your network composition closely matches the empirical findings from Granovetter's study. This balance provides good access to job opportunities.`;
                } else if (strongDiff > 20) {
                    message = `‚ö†Ô∏è <strong>Too many strong ties.</strong> Your network has ${this.values.strong}% strong ties versus the study's ${(this.baseline.strong * 100).toFixed(1)}%. Strong ties provide redundant information since they know the same people. Consider expanding your weak ties for more diverse opportunities.`;
                } else if (weakDiff < -10) {
                    message = `üí° <strong>Room for improvement.</strong> Your network has only ${this.values.weak}% weak ties. Granovetter's study showed ${(this.baseline.weak * 100).toFixed(1)}% of jobs came through weak ties. Reconnecting with distant contacts could improve your job search success.`;
                } else {
                    message = `üìä <strong>Moderate network diversity.</strong> Your network composition differs from the study baseline. Success rate: ${successProb.toFixed(0)}% of baseline effectiveness.`;
                }

                comparisonText.innerHTML = message;
            }
        };

        // ========================================
        // INFORMATION REACH CALCULATOR
        // ========================================

        const ReachCalculator = {
            strongCount: 5,
            weakCount: 15,
            overlapPercent: 50,

            init() {
                this.calculate();
            },

            updateOverlap(value) {
                this.overlapPercent = parseInt(value);
                document.getElementById('overlap-display').textContent = value + '%';
                this.calculate();
            },

            calculate() {
                // Get input values
                const strongInput = document.getElementById('strong-ties-count');
                const weakInput = document.getElementById('weak-ties-count');

                if (strongInput) this.strongCount = parseInt(strongInput.value) || 0;
                if (weakInput) this.weakCount = parseInt(weakInput.value) || 0;

                // Calculate overlap
                // Strong ties have high overlap (they know each other)
                // Weak ties have low overlap (different social circles)
                const strongOverlap = this.overlapPercent / 100;
                const weakOverlap = Math.max(0, (this.overlapPercent - 40) / 100); // Weak ties have ~40% less overlap

                // Calculate unique reach
                // For strong ties: accounting for high overlap/redundancy
                const strongUnique = this.strongCount * (1 - strongOverlap * 0.8);

                // For weak ties: accounting for low overlap
                const weakUnique = this.weakCount * (1 - weakOverlap * 0.3);

                const totalUnique = Math.round(strongUnique + weakUnique);
                const redundant = (this.strongCount + this.weakCount) - totalUnique;

                // Calculate extended network (2nd degree connections)
                // Assuming each person knows ~10 others on average
                const extendedReach = Math.round(totalUnique * 10);

                // Update display
                this.updateDisplay(totalUnique, extendedReach, redundant);

                // Calculate scenarios
                this.calculateScenarios();
            },

            updateDisplay(totalUnique, extendedReach, redundant) {
                // Main reach number
                const totalReachEl = document.getElementById('total-reach');
                if (totalReachEl) {
                    totalReachEl.textContent = totalUnique;

                    // Color based on reach
                    if (totalUnique >= 30) {
                        totalReachEl.style.color = '#10b981';
                    } else if (totalUnique >= 15) {
                        totalReachEl.style.color = '#3b82f6';
                    } else {
                        totalReachEl.style.color = '#f59e0b';
                    }
                }

                // Update visualization labels
                const directLabel = document.getElementById('reach-label-direct');
                const extendedLabel = document.getElementById('reach-label-extended');

                if (directLabel) directLabel.textContent = `Direct: ${totalUnique}`;
                if (extendedLabel) extendedLabel.textContent = `Extended: ~${extendedReach}`;

                // Update circles - scale based on network size
                const outerCircle = document.getElementById('reach-circle-outer');
                const middleCircle = document.getElementById('reach-circle-middle');

                if (outerCircle) {
                    const outerRadius = Math.min(140, 60 + totalUnique * 2);
                    outerCircle.setAttribute('r', outerRadius);
                }

                if (middleCircle) {
                    const middleRadius = Math.min(90, 40 + totalUnique);
                    middleCircle.setAttribute('r', middleRadius);
                }

                // Update breakdown
                document.getElementById('strong-reach').textContent = this.strongCount;
                document.getElementById('weak-reach').textContent = this.weakCount;
                document.getElementById('unique-reach').textContent = totalUnique;

                // Update overlap info
                const strongOverlapPct = Math.round(this.overlapPercent * 0.8);
                const weakOverlapPct = Math.max(0, Math.round((this.overlapPercent - 40) * 0.3));

                document.getElementById('strong-overlap-info').textContent = `High overlap (~${strongOverlapPct}%)`;
                document.getElementById('weak-overlap-info').textContent = `Low overlap (~${weakOverlapPct}%)`;

                const redundancyPct = ((redundant / (this.strongCount + this.weakCount)) * 100).toFixed(0);
                document.getElementById('redundancy-info').textContent = `${redundant} redundant (${redundancyPct}%)`;
            },

            calculateScenarios() {
                const totalContacts = this.strongCount + this.weakCount;

                // Scenario 1: All strong ties (high overlap ~80%)
                const allStrongUnique = Math.round(totalContacts * (1 - 0.8 * 0.8));

                // Scenario 2: All weak ties (low overlap ~10%)
                const allWeakUnique = Math.round(totalContacts * (1 - 0.1 * 0.3));

                // Current network
                const currentUnique = parseInt(document.getElementById('unique-reach').textContent);

                // Update scenario displays
                document.getElementById('scenario-all-strong').textContent = allStrongUnique;
                document.getElementById('scenario-all-weak').textContent = allWeakUnique;
                document.getElementById('scenario-current').textContent = currentUnique;

                // Comparison message
                const comparisonEl = document.getElementById('scenario-comparison');
                if (comparisonEl) {
                    let message = '';
                    const percentOfOptimal = (currentUnique / allWeakUnique) * 100;

                    if (percentOfOptimal >= 90) {
                        message = `üéâ <strong>${percentOfOptimal.toFixed(0)}% of optimal!</strong> Excellent diversity`;
                    } else if (percentOfOptimal >= 70) {
                        message = `‚úÖ <strong>${percentOfOptimal.toFixed(0)}% of optimal</strong> - Good balance`;
                    } else if (percentOfOptimal >= 50) {
                        message = `‚ö†Ô∏è <strong>${percentOfOptimal.toFixed(0)}% of optimal</strong> - More weak ties needed`;
                    } else {
                        message = `‚ùå <strong>${percentOfOptimal.toFixed(0)}% of optimal</strong> - Too much overlap`;
                    }

                    comparisonEl.innerHTML = message;
                }
            }
        };

        // ========================================
        // TRIADIC CLOSURE ANIMATION
        // Holland & Leinhardt 16 Triads Classification
        // ========================================

        const TriadicClosure = {
            // 16 Triads (Holland & Leinhardt 1976): M-A-N notation
            // M = Mutual ties, A = Asymmetric ties, N = Null ties
            triads: {
                '003': { name: 'Empty', description: 'No ties at all - completely disconnected', mutual: 0, asymmetric: 0, null: 3 },
                '012': { name: 'Asymmetric', description: 'Single directed tie A‚ÜíB', mutual: 0, asymmetric: 1, null: 2 },
                '102': { name: 'Mutual', description: 'Single mutual tie A‚ÜîB', mutual: 1, asymmetric: 0, null: 2 },
                '021D': { name: 'Out-star', description: 'A‚ÜíB, A‚ÜíC (A broadcasts)', mutual: 0, asymmetric: 2, null: 1 },
                '021U': { name: 'In-star', description: 'B‚ÜíA, C‚ÜíA (A receives)', mutual: 0, asymmetric: 2, null: 1 },
                '021C': { name: 'Cycle', description: 'A‚ÜíB‚ÜíC (no closure)', mutual: 0, asymmetric: 2, null: 1 },
                '111D': { name: 'Mutual + Out', description: 'A‚ÜîB, A‚ÜíC', mutual: 1, asymmetric: 1, null: 1 },
                '111U': { name: 'Mutual + In', description: 'A‚ÜîB, C‚ÜíA', mutual: 1, asymmetric: 1, null: 1 },
                '030T': { name: 'Transitive', description: 'A‚ÜíB‚ÜíC, A‚ÜíC (closed path)', mutual: 0, asymmetric: 3, null: 0 },
                '030C': { name: 'Cyclic', description: 'A‚ÜíB‚ÜíC‚ÜíA (full cycle)', mutual: 0, asymmetric: 3, null: 0 },
                '201': { name: 'Two Mutual', description: 'A‚ÜîB, A‚ÜîC (no B-C)', mutual: 2, asymmetric: 0, null: 1 },
                '120D': { name: 'Mixed Out', description: 'A‚ÜîB, A‚ÜíC, B‚ÜíC', mutual: 1, asymmetric: 2, null: 0 },
                '120U': { name: 'Mixed In', description: 'A‚ÜîB, C‚ÜíA, C‚ÜíB', mutual: 1, asymmetric: 2, null: 0 },
                '120C': { name: 'Mixed Cycle', description: 'A‚ÜîB, A‚ÜíC, C‚ÜíB', mutual: 1, asymmetric: 2, null: 0 },
                '210': { name: 'Almost Complete', description: 'A‚ÜîB, A‚ÜîC, B‚ÜíC', mutual: 2, asymmetric: 1, null: 0 },
                '300': { name: 'Complete', description: 'A‚ÜîB, A‚ÜîC, B‚ÜîC (full closure)', mutual: 3, asymmetric: 0, null: 0 }
            },

            // Animation state
            currentScenario: 'basic',
            currentStep: 0,
            isPlaying: false,
            playInterval: null,
            playbackSpeed: 1, // 0.5x, 1x, or 2x

            // Scenarios demonstrating Granovetter's principles
            scenarios: {
                basic: {
                    name: 'Basic Triadic Closure',
                    steps: [
                        {
                            triad: '003',
                            edges: { ab: false, bc: false, ac: false },
                            title: 'Three Disconnected People',
                            explanation: 'A, B, and C have no relationship. This is triad type <strong>003</strong> (0 mutual, 0 asymmetric, 3 null ties).',
                            principle: 'Starting point: completely disconnected network.'
                        },
                        {
                            triad: '102',
                            edges: { ab: true, bc: false, ac: false },
                            abType: 'strong',
                            title: 'A-B Form Strong Tie',
                            explanation: 'A and B develop a <strong>strong tie</strong> (see each other ‚â•2x/week). Now triad type <strong>102</strong> (1 mutual, 0 asymmetric, 2 null).',
                            principle: 'Strong ties involve frequent contact and emotional closeness.'
                        },
                        {
                            triad: '201',
                            edges: { ab: true, bc: true, ac: false },
                            abType: 'strong',
                            bcType: 'strong',
                            title: 'B-C Form Strong Tie',
                            explanation: 'B and C also form a <strong>strong tie</strong>. Now triad type <strong>201</strong> (2 mutual, 0 asymmetric, 1 null). This is the "forbidden triad" setup!',
                            principle: '‚ö†Ô∏è Granovetter\'s Key Finding: When A-B strong AND B-C strong, triadic closure is highly likely.'
                        },
                        {
                            triad: '300',
                            edges: { ab: true, bc: true, ac: true },
                            abType: 'strong',
                            bcType: 'strong',
                            acType: 'strong',
                            title: 'Triadic Closure Forms!',
                            explanation: 'A and C meet through B and form a tie. Now triad type <strong>300</strong> (3 mutual, 0 asymmetric, 0 null) - complete closure!',
                            principle: '‚ùå PROBLEM: Now all three share the same information. High redundancy, no novel information flows.'
                        }
                    ]
                },

                weakStrong: {
                    name: 'Weak Tie Prevents Closure',
                    steps: [
                        {
                            triad: '003',
                            edges: { ab: false, bc: false, ac: false },
                            title: 'Three Disconnected People',
                            explanation: 'Starting with A, B, C disconnected (triad <strong>003</strong>).',
                            principle: 'Weak ties behave differently than strong ties in closure dynamics.'
                        },
                        {
                            triad: '102',
                            edges: { ab: true, bc: false, ac: false },
                            abType: 'weak',
                            title: 'A-B Form Weak Tie',
                            explanation: 'A and B develop a <strong>weak tie</strong> (see each other ‚â§1x/year). Still triad <strong>102</strong>.',
                            principle: 'Weak ties involve infrequent contact, less emotional closeness.'
                        },
                        {
                            triad: '201',
                            edges: { ab: true, bc: true, ac: false },
                            abType: 'weak',
                            bcType: 'strong',
                            title: 'B-C Form Strong Tie',
                            explanation: 'B and C form a <strong>strong tie</strong>. Now A-B weak, B-C strong (triad <strong>201</strong>).',
                            principle: 'üí° Critical Difference: A-B is WEAK, not strong.'
                        },
                        {
                            triad: '201',
                            edges: { ab: true, bc: true, ac: false },
                            abType: 'weak',
                            bcType: 'strong',
                            title: 'Closure Resisted!',
                            explanation: 'A and C are <strong>unlikely to meet</strong> because A-B is weak. Triad stays <strong>201</strong> - open structure.',
                            principle: '‚úÖ BENEFIT: B acts as a BRIDGE. A gets novel information from C\'s network through B. Low redundancy!'
                        }
                    ]
                },

                multiple: {
                    name: 'Dense vs Sparse Networks',
                    steps: [
                        {
                            triad: '003',
                            edges: { ab: false, bc: false, ac: false },
                            title: 'Starting Configuration',
                            explanation: 'Three people, no ties yet (triad <strong>003</strong>).',
                            principle: 'Network structure affects information flow and access to resources.'
                        },
                        {
                            triad: '300',
                            edges: { ab: true, bc: true, ac: true },
                            abType: 'strong',
                            bcType: 'strong',
                            acType: 'strong',
                            title: 'Dense Network (All Strong)',
                            explanation: 'All three form <strong>strong ties</strong> (triad <strong>300</strong> - complete closure). Network density = 100%.',
                            principle: '‚ùå Dense networks create echo chambers. Everyone knows everyone, same information circulates.'
                        },
                        {
                            triad: '201',
                            edges: { ab: true, bc: true, ac: false },
                            abType: 'weak',
                            bcType: 'weak',
                            title: 'Sparse Network (Weak Ties)',
                            explanation: 'Only weak ties exist (triad <strong>201</strong> - open structure). Network density = 67%.',
                            principle: '‚úÖ Sparse networks with weak ties provide access to diverse information sources.'
                        },
                        {
                            triad: '201',
                            edges: { ab: true, bc: true, ac: false },
                            abType: 'weak',
                            bcType: 'weak',
                            title: 'Granovetter\'s Finding',
                            explanation: '<strong>83.4%</strong> of jobs found through moderate/weak ties (N=54), NOT strong ties!',
                            principle: 'üìä EMPIRICAL DATA: Weak ties more effective for job search than strong ties.'
                        }
                    ]
                },

                whatIf: {
                    name: 'What If Scenario Builder',
                    steps: [
                        {
                            triad: '102',
                            edges: { ab: true, bc: false, ac: false },
                            abType: 'strong',
                            title: 'Custom Scenario',
                            explanation: 'Build your own network configuration using the controls above!',
                            principle: 'Experiment to understand how tie strength affects closure dynamics.'
                        }
                    ]
                }
            },

            // What If scenario builder module
            whatIf: {
                state: {
                    ab: { connected: true, type: 'strong' },
                    bc: { connected: false, type: 'strong' },
                    ac: { connected: false, type: 'strong' }
                },

                toggleEdge(edgeId) {
                    this.state[edgeId].connected = !this.state[edgeId].connected;
                    this.updateUI();
                    this.updateVisualization();
                    this.updatePrediction();
                },

                setType(edgeId, type) {
                    this.state[edgeId].type = type;
                    this.updateUI();
                    this.updateVisualization();
                    this.updatePrediction();
                },

                updateUI() {
                    ['ab', 'bc', 'ac'].forEach(edgeId => {
                        const toggleBtn = document.getElementById(`whatif-toggle-${edgeId}`);
                        const typeDiv = document.getElementById(`whatif-type-${edgeId}`);
                        const strongBtn = document.getElementById(`whatif-${edgeId}-strong`);
                        const weakBtn = document.getElementById(`whatif-${edgeId}-weak`);

                        if (this.state[edgeId].connected) {
                            toggleBtn.textContent = '‚úì Connected';
                            toggleBtn.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                            toggleBtn.classList.remove('secondary');
                            typeDiv.style.display = 'flex';

                            if (this.state[edgeId].type === 'strong') {
                                strongBtn.style.background = 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)';
                                strongBtn.classList.remove('secondary');
                                weakBtn.style.background = '';
                                weakBtn.classList.add('secondary');
                            } else {
                                weakBtn.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                                weakBtn.classList.remove('secondary');
                                strongBtn.style.background = '';
                                strongBtn.classList.add('secondary');
                            }
                        } else {
                            toggleBtn.textContent = '‚úó Disconnected';
                            toggleBtn.style.background = '';
                            toggleBtn.classList.add('secondary');
                            typeDiv.style.display = 'none';
                        }
                    });
                },

                updateVisualization() {
                    TriadicClosure.updateEdge('ab', this.state.ab.connected, this.state.ab.type);
                    TriadicClosure.updateEdge('bc', this.state.bc.connected, this.state.bc.type);
                    TriadicClosure.updateEdge('ac', this.state.ac.connected, this.state.ac.type);

                    // Update live metrics
                    const step = this.generateStepData();
                    TriadicClosure.updateLiveMetrics(step);
                },

                generateStepData() {
                    // Determine triad type based on current state
                    const edges = {
                        ab: this.state.ab.connected,
                        bc: this.state.bc.connected,
                        ac: this.state.ac.connected
                    };

                    let triad = '003'; // default: no connections
                    let mutual = 0;

                    if (edges.ab) mutual++;
                    if (edges.bc) mutual++;
                    if (edges.ac) mutual++;

                    if (mutual === 0) triad = '003';
                    else if (mutual === 1) triad = '102';
                    else if (mutual === 2) triad = '201';
                    else if (mutual === 3) triad = '300';

                    return {
                        triad: triad,
                        edges: edges,
                        abType: this.state.ab.type,
                        bcType: this.state.bc.type,
                        acType: this.state.ac.type
                    };
                },

                updatePrediction() {
                    const predictionEl = document.getElementById('whatif-prediction-text');
                    if (!predictionEl) return;

                    const ab = this.state.ab;
                    const bc = this.state.bc;
                    const ac = this.state.ac;

                    let prediction = '';

                    // No connections
                    if (!ab.connected && !bc.connected && !ac.connected) {
                        prediction = `
                            <strong>Current State:</strong> Completely disconnected (Triad <strong>003</strong>)<br><br>
                            <strong style="color: #6b7280;">Prediction:</strong> No information flow possible. These three people have no relationship.
                        `;
                    }
                    // One connection only
                    else if ((ab.connected && !bc.connected && !ac.connected) ||
                             (!ab.connected && bc.connected && !ac.connected) ||
                             (!ab.connected && !bc.connected && ac.connected)) {
                        prediction = `
                            <strong>Current State:</strong> Single connection (Triad <strong>102</strong>)<br><br>
                            <strong style="color: #3b82f6;">Prediction:</strong> Information can flow between two nodes. The third person remains isolated from this dyad.
                        `;
                    }
                    // Two connections (Forbidden Triad setup)
                    else if (ab.connected && bc.connected && !ac.connected) {
                        if (ab.type === 'strong' && bc.type === 'strong') {
                            prediction = `
                                <strong>Current State:</strong> Forbidden Triad! (Triad <strong>201</strong>)<br><br>
                                <strong style="color: #dc2626;">‚ö†Ô∏è Granovetter's Prediction:</strong> This configuration is <strong>highly unstable</strong>.
                                Since A-B is strong AND B-C is strong, triadic closure pressure is HIGH.
                                A and C will likely meet through B and form a tie, closing the triad to <strong>300</strong>.<br><br>
                                <strong style="color: #7c3aed;">Expected Outcome:</strong> Complete closure (echo chamber, high redundancy).
                            `;
                        } else if (ab.type === 'weak' || bc.type === 'weak') {
                            const weakEdge = ab.type === 'weak' ? 'A-B' : 'B-C';
                            prediction = `
                                <strong>Current State:</strong> Open triad with weak tie (Triad <strong>201</strong>)<br><br>
                                <strong style="color: #10b981;">‚úÖ Granovetter's Prediction:</strong> The <strong>${weakEdge} weak tie</strong> resists closure!
                                Weak ties involve infrequent contact, so A and C are unlikely to meet through B.<br><br>
                                <strong style="color: #16a34a;">Expected Outcome:</strong> B acts as a <strong>bridge</strong>, providing A and C access to
                                non-overlapping information networks. Low redundancy, high novelty!
                            `;
                        }
                    }
                    else if (ab.connected && !bc.connected && ac.connected) {
                        prediction = `
                            <strong>Current State:</strong> A connected to both B and C (Triad <strong>201</strong>)<br><br>
                            <strong style="color: #3b82f6;">Prediction:</strong> A is the central node connecting B and C.
                            If A-B and A-C are both strong, B and C will likely meet through A and form a tie.
                        `;
                    }
                    else if (!ab.connected && bc.connected && ac.connected) {
                        prediction = `
                            <strong>Current State:</strong> C connected to both A and B (Triad <strong>201</strong>)<br><br>
                            <strong style="color: #3b82f6;">Prediction:</strong> C is the central node connecting A and B.
                            If B-C and A-C are both strong, A and B will likely meet through C and form a tie.
                        `;
                    }
                    // Complete closure
                    else if (ab.connected && bc.connected && ac.connected) {
                        const allStrong = ab.type === 'strong' && bc.type === 'strong' && ac.type === 'strong';
                        const allWeak = ab.type === 'weak' && bc.type === 'weak' && ac.type === 'weak';

                        if (allStrong) {
                            prediction = `
                                <strong>Current State:</strong> Complete closure, all strong ties (Triad <strong>300</strong>)<br><br>
                                <strong style="color: #dc2626;">‚ùå Problem:</strong> This is a fully closed network - an echo chamber.
                                All three people know each other well and share the same information.<br><br>
                                <strong style="color: #ef4444;">Impact:</strong> <strong>HIGH redundancy, LOW access to novel information.</strong>
                                Bad for job search (remember: 83.4% of jobs came through weak/moderate ties, not strong ties!).
                            `;
                        } else if (allWeak) {
                            prediction = `
                                <strong>Current State:</strong> Complete closure, all weak ties (Triad <strong>300</strong>)<br><br>
                                <strong style="color: #f59e0b;">Unusual configuration!</strong> Having weak ties to people who also know each other weakly
                                creates some redundancy, but less than strong ties.<br><br>
                                <strong style="color: #d97706;">Impact:</strong> Moderate redundancy. Not as bad as all-strong, but not optimal for information diversity.
                            `;
                        } else {
                            prediction = `
                                <strong>Current State:</strong> Complete closure, mixed tie strengths (Triad <strong>300</strong>)<br><br>
                                <strong style="color: #8b5cf6;">Mixed outcome.</strong> The network is closed, creating some redundancy.
                                However, the weak ties provide some degree of access to different information sources.<br><br>
                                <strong style="color: #7c3aed;">Impact:</strong> Moderate redundancy with limited novelty.
                            `;
                        }
                    }

                    predictionEl.innerHTML = prediction;
                },

                loadPreset(presetName) {
                    switch (presetName) {
                        case 'forbiddenTriad':
                            this.state.ab = { connected: true, type: 'strong' };
                            this.state.bc = { connected: true, type: 'strong' };
                            this.state.ac = { connected: false, type: 'strong' };
                            break;
                        case 'completeClosure':
                            this.state.ab = { connected: true, type: 'strong' };
                            this.state.bc = { connected: true, type: 'strong' };
                            this.state.ac = { connected: true, type: 'strong' };
                            break;
                        case 'perfectBridge':
                            this.state.ab = { connected: true, type: 'weak' };
                            this.state.bc = { connected: true, type: 'strong' };
                            this.state.ac = { connected: false, type: 'strong' };
                            break;
                        case 'weakBridge':
                            this.state.ab = { connected: true, type: 'weak' };
                            this.state.bc = { connected: true, type: 'weak' };
                            this.state.ac = { connected: false, type: 'weak' };
                            break;
                    }

                    this.updateUI();
                    this.updateVisualization();
                    this.updatePrediction();
                }
            },

            init() {
                this.loadScenario('basic');
            },

            loadScenario(scenarioName) {
                this.currentScenario = scenarioName;
                this.currentStep = 0;
                this.pause();

                // Update scenario button states
                document.querySelectorAll('[id^="scenario-"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById(`scenario-${scenarioName}`).classList.add('active');

                // Handle What If scenario specially
                const whatIfBuilder = document.getElementById('whatif-builder');
                if (scenarioName === 'whatIf') {
                    if (whatIfBuilder) {
                        whatIfBuilder.style.display = 'block';
                        // Initialize What If module
                        this.whatIf.updateUI();
                        this.whatIf.updateVisualization();
                        this.whatIf.updatePrediction();
                    }
                } else {
                    if (whatIfBuilder) {
                        whatIfBuilder.style.display = 'none';
                    }
                    this.renderStep();
                }
            },

            renderStep() {
                const scenario = this.scenarios[this.currentScenario];
                const step = scenario.steps[this.currentStep];

                // Update SVG edges with enhanced animations
                this.updateEdge('ab', step.edges.ab, step.abType);
                this.updateEdge('bc', step.edges.bc, step.bcType);
                this.updateEdge('ac', step.edges.ac, step.acType);

                // Update explanation cards
                this.updateExplanation(step);

                // Update timeline scrubber
                const scrubber = document.getElementById('timeline-scrubber');
                if (scrubber) {
                    scrubber.max = scenario.steps.length - 1;
                    scrubber.value = this.currentStep;
                }

                // Update timeline progress bar
                const progressBar = document.getElementById('timeline-progress');
                if (progressBar) {
                    const progressPct = (this.currentStep / (scenario.steps.length - 1)) * 100;
                    progressBar.style.width = progressPct + '%';
                }

                // Update timeline label
                const timelineLabel = document.getElementById('timeline-label');
                if (timelineLabel) {
                    timelineLabel.textContent = `Step ${this.currentStep + 1}/${scenario.steps.length}`;
                }

                // Update live metrics panel
                this.updateLiveMetrics(step);

                // Update step markers (if needed)
                this.updateStepMarkers();
            },

            updateEdge(edgeId, visible, type = 'strong') {
                const edge = document.getElementById(`edge-${edgeId}`);
                const edgeGlow = document.getElementById(`edge-${edgeId}-glow`);
                if (!edge) return;

                if (visible) {
                    // Main edge
                    edge.style.opacity = '1';
                    edge.style.strokeDasharray = type === 'weak' ? '8,8' : '0';
                    edge.style.stroke = type === 'strong' ? '#1e3c72' : '#10b981';
                    edge.style.strokeWidth = type === 'strong' ? '5' : '3';

                    // Glow layer
                    if (edgeGlow) {
                        edgeGlow.style.opacity = '0.4';
                        edgeGlow.style.strokeDasharray = type === 'weak' ? '8,8' : '0';
                        edgeGlow.style.stroke = type === 'strong' ? '#3b82f6' : '#10b981';
                        edgeGlow.style.strokeWidth = type === 'strong' ? '12' : '8';
                    }
                } else {
                    edge.style.opacity = '0';
                    edge.style.strokeWidth = '0';
                    if (edgeGlow) {
                        edgeGlow.style.opacity = '0';
                        edgeGlow.style.strokeWidth = '0';
                    }
                }
            },

            updateExplanation(step) {
                const cardsContainer = document.getElementById('explanation-cards');

                cardsContainer.innerHTML = `
                    <div style="padding: 25px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 12px; border-left: 5px solid #3b82f6;">
                        <h4 style="margin: 0 0 12px 0; color: #1e40af; font-size: 1.3em;">
                            ${step.title}
                        </h4>
                        <p style="margin: 0; line-height: 1.8; color: #1e3a8a;">
                            ${step.explanation}
                        </p>
                    </div>

                    <div style="padding: 25px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 12px; border-left: 5px solid #f59e0b;">
                        <h4 style="margin: 0 0 12px 0; color: #92400e; font-size: 1.3em;">
                            üìñ Granovetter's Principle
                        </h4>
                        <p style="margin: 0; line-height: 1.8; color: #78350f;">
                            ${step.principle}
                        </p>
                    </div>

                    <div style="padding: 25px; background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); border-radius: 12px; border-left: 5px solid #6b7280;">
                        <h4 style="margin: 0 0 12px 0; color: #374151; font-size: 1.3em;">
                            üî¨ Triad Classification
                        </h4>
                        <p style="margin: 0 0 8px 0; line-height: 1.8; color: #1f2937;">
                            <strong>Type ${step.triad}:</strong> ${this.triads[step.triad].name}
                        </p>
                        <p style="margin: 0; line-height: 1.8; color: #4b5563; font-size: 0.95em;">
                            ${this.triads[step.triad].description}
                        </p>
                        <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 8px; font-family: monospace; font-size: 0.9em; color: #374151;">
                            M=${this.triads[step.triad].mutual} (Mutual ties) |
                            A=${this.triads[step.triad].asymmetric} (Asymmetric) |
                            N=${this.triads[step.triad].null} (Null ties)
                        </div>
                    </div>
                `;
            },

            play() {
                if (this.isPlaying) return;

                this.isPlaying = true;
                const baseInterval = 2500; // Base: 2.5 seconds
                const interval = baseInterval / this.playbackSpeed;

                // Update button states
                document.getElementById('btn-play').style.display = 'none';
                document.getElementById('btn-pause').style.display = 'inline-block';

                this.playInterval = setInterval(() => {
                    this.nextStep();
                    if (this.currentStep === this.scenarios[this.currentScenario].steps.length - 1) {
                        this.pause();
                    }
                }, interval);
            },

            pause() {
                this.isPlaying = false;
                if (this.playInterval) {
                    clearInterval(this.playInterval);
                    this.playInterval = null;
                }

                // Update button states
                document.getElementById('btn-play').style.display = 'inline-block';
                document.getElementById('btn-pause').style.display = 'none';
            },

            reset() {
                this.pause();
                this.currentStep = 0;
                this.renderStep();
            },

            nextStep() {
                const scenario = this.scenarios[this.currentScenario];
                if (this.currentStep < scenario.steps.length - 1) {
                    this.currentStep++;
                    this.renderStep();
                }
            },

            prevStep() {
                if (this.currentStep > 0) {
                    this.currentStep--;
                    this.renderStep();
                }
            },

            // New BI Features

            setSpeed(speed) {
                this.playbackSpeed = speed;

                // Update speed button states
                ['0.5', '1', '2'].forEach(s => {
                    const btn = document.getElementById(`speed-${s}`);
                    if (btn) {
                        if (parseFloat(s) === speed) {
                            btn.classList.remove('secondary');
                            btn.style.background = 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)';
                            btn.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.3)';
                        } else {
                            btn.classList.add('secondary');
                            btn.style.background = '';
                            btn.style.boxShadow = '';
                        }
                    }
                });

                // Restart playback if currently playing
                if (this.isPlaying) {
                    this.pause();
                    this.play();
                }
            },

            scrubToStep(stepIndex) {
                this.pause();
                this.currentStep = stepIndex;
                this.renderStep();
            },

            updateLiveMetrics(step) {
                // Update triad type
                const triadTypeEl = document.getElementById('live-triad-type');
                const triadNameEl = document.getElementById('live-triad-name');
                if (triadTypeEl && triadNameEl) {
                    triadTypeEl.textContent = step.triad;
                    triadNameEl.textContent = this.triads[step.triad].name;
                }

                // Update M-A-N breakdown
                const mutualEl = document.getElementById('live-mutual');
                const asymmetricEl = document.getElementById('live-asymmetric');
                const nullEl = document.getElementById('live-null');
                if (mutualEl && asymmetricEl && nullEl) {
                    mutualEl.textContent = this.triads[step.triad].mutual;
                    asymmetricEl.textContent = this.triads[step.triad].asymmetric;
                    nullEl.textContent = this.triads[step.triad].null;
                }

                // Count strong and weak ties
                let strongCount = 0;
                let weakCount = 0;
                if (step.edges.ab) {
                    if (step.abType === 'strong') strongCount++;
                    else weakCount++;
                }
                if (step.edges.bc) {
                    if (step.bcType === 'strong') strongCount++;
                    else weakCount++;
                }
                if (step.edges.ac) {
                    if (step.acType === 'strong') strongCount++;
                    else weakCount++;
                }

                // Update tie strength counts
                const strongCountEl = document.getElementById('live-strong-count');
                const weakCountEl = document.getElementById('live-weak-count');
                if (strongCountEl && weakCountEl) {
                    strongCountEl.textContent = strongCount;
                    weakCountEl.textContent = weakCount;
                }

                // Update closure status
                const closureStatusEl = document.getElementById('closure-status-text');
                if (closureStatusEl) {
                    if (step.triad === '300') {
                        closureStatusEl.innerHTML = 'üî¥ <strong>Complete Closure</strong> - High redundancy';
                        document.getElementById('closure-status').style.background = 'linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)';
                        document.getElementById('closure-status').style.borderLeftColor = '#ef4444';
                    } else if (step.triad === '201' && step.edges.ab && step.edges.bc && !step.edges.ac) {
                        closureStatusEl.innerHTML = 'üü° <strong>Potential Closure</strong> - Depends on tie strength';
                        document.getElementById('closure-status').style.background = 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)';
                        document.getElementById('closure-status').style.borderLeftColor = '#f59e0b';
                    } else if (step.edges.ab || step.edges.bc || step.edges.ac) {
                        closureStatusEl.innerHTML = 'üü¢ <strong>Open Structure</strong> - Good information flow';
                        document.getElementById('closure-status').style.background = 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)';
                        document.getElementById('closure-status').style.borderLeftColor = '#10b981';
                    } else {
                        closureStatusEl.innerHTML = '‚ö™ <strong>No Connections</strong> - Isolated nodes';
                        document.getElementById('closure-status').style.background = 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)';
                        document.getElementById('closure-status').style.borderLeftColor = '#94a3b8';
                    }
                }

                // Update key insight
                const insightEl = document.getElementById('live-insight');
                if (insightEl) {
                    let insightText = '';
                    let insightColor = '#fef2f2';
                    let borderColor = '#ef4444';

                    if (step.triad === '003') {
                        insightText = 'Completely disconnected - no information flow possible.';
                        insightColor = '#f8fafc';
                        borderColor = '#94a3b8';
                    } else if (step.triad === '102') {
                        insightText = 'Single connection formed - information can now flow between two nodes.';
                        insightColor = '#eff6ff';
                        borderColor = '#3b82f6';
                    } else if (step.triad === '201') {
                        if (weakCount > 0) {
                            insightText = 'Open structure with weak tie(s) - B acts as a bridge providing novel information to A and C!';
                            insightColor = '#f0fdf4';
                            borderColor = '#10b981';
                        } else {
                            insightText = 'Forbidden triad! Two strong ties but no closure (yet). Highly unstable - closure likely to form.';
                            insightColor = '#fef3c7';
                            borderColor = '#f59e0b';
                        }
                    } else if (step.triad === '300') {
                        insightText = 'Complete closure - all three connected. High redundancy means limited access to novel information.';
                        insightColor = '#fef2f2';
                        borderColor = '#ef4444';
                    }

                    insightEl.querySelector('div:last-child').textContent = insightText;
                    insightEl.style.background = `linear-gradient(135deg, ${insightColor} 0%, ${insightColor} 100%)`;
                    insightEl.style.borderLeftColor = borderColor;
                }
            },

            updateStepMarkers() {
                const markersEl = document.getElementById('step-markers');
                if (!markersEl) return;

                const scenario = this.scenarios[this.currentScenario];
                const steps = scenario.steps;

                let markersHTML = '';
                steps.forEach((step, index) => {
                    const triadInfo = this.triads[step.triad];
                    markersHTML += `<span style="opacity: ${index === this.currentStep ? 1 : 0.5}; font-weight: ${index === this.currentStep ? 'bold' : 'normal'}; color: ${index === this.currentStep ? '#3b82f6' : '#94a3b8'};">${step.triad}</span>`;
                });

                markersEl.innerHTML = markersHTML;
            }
        };

        // ========================================
        // INFORMATION DIFFUSION SIMULATOR
        // ========================================

        const InformationDiffusion = {
            // State
            currentScenario: 'dense',
            currentStep: 0,
            isPlaying: false,
            playInterval: null,
            playbackSpeed: 1,

            // Network configurations
            networks: {
                dense: {
                    name: 'Dense Network (Strong Ties)',
                    nodes: [
                        { id: 1, x: 350, y: 100, label: 'A' },
                        { id: 2, x: 200, y: 200, label: 'B' },
                        { id: 3, x: 500, y: 200, label: 'C' },
                        { id: 4, x: 150, y: 350, label: 'D' },
                        { id: 5, x: 350, y: 350, label: 'E' },
                        { id: 6, x: 550, y: 350, label: 'F' },
                        { id: 7, x: 350, y: 450, label: 'G' }
                    ],
                    edges: [
                        { from: 1, to: 2, type: 'strong' },
                        { from: 1, to: 3, type: 'strong' },
                        { from: 2, to: 3, type: 'strong' },
                        { from: 2, to: 4, type: 'strong' },
                        { from: 2, to: 5, type: 'strong' },
                        { from: 3, to: 5, type: 'strong' },
                        { from: 3, to: 6, type: 'strong' },
                        { from: 4, to: 5, type: 'strong' },
                        { from: 5, to: 6, type: 'strong' },
                        { from: 5, to: 7, type: 'strong' },
                        { from: 4, to: 7, type: 'strong' },
                        { from: 6, to: 7, type: 'strong' }
                    ],
                    source: 1,
                    description: 'All nodes connected with <strong>strong ties</strong>. High overlap creates redundancy - information spreads quickly within the cluster but reaches the same people multiple times.'
                },

                bridge: {
                    name: 'Bridge Network (Weak Bridge)',
                    nodes: [
                        { id: 1, x: 150, y: 150, label: 'A' },
                        { id: 2, x: 250, y: 100, label: 'B' },
                        { id: 3, x: 250, y: 200, label: 'C' },
                        { id: 4, x: 350, y: 250, label: 'D' }, // Bridge
                        { id: 5, x: 450, y: 200, label: 'E' },
                        { id: 6, x: 550, y: 150, label: 'F' },
                        { id: 7, x: 450, y: 300, label: 'G' }
                    ],
                    edges: [
                        { from: 1, to: 2, type: 'strong' },
                        { from: 1, to: 3, type: 'strong' },
                        { from: 2, to: 3, type: 'strong' },
                        { from: 3, to: 4, type: 'weak' }, // Bridge connection
                        { from: 4, to: 5, type: 'weak' }, // Bridge connection
                        { from: 5, to: 6, type: 'strong' },
                        { from: 5, to: 7, type: 'strong' },
                        { from: 6, to: 7, type: 'strong' }
                    ],
                    source: 1,
                    description: 'Node D acts as a <strong>bridge</strong> with weak ties connecting two clusters. Information flows across social boundaries, reaching novel social circles with minimal redundancy.'
                },

                weak: {
                    name: 'Weak Ties Network',
                    nodes: [
                        { id: 1, x: 350, y: 100, label: 'A' },
                        { id: 2, x: 200, y: 200, label: 'B' },
                        { id: 3, x: 500, y: 200, label: 'C' },
                        { id: 4, x: 150, y: 350, label: 'D' },
                        { id: 5, x: 350, y: 350, label: 'E' },
                        { id: 6, x: 550, y: 350, label: 'F' },
                        { id: 7, x: 350, y: 450, label: 'G' }
                    ],
                    edges: [
                        { from: 1, to: 2, type: 'weak' },
                        { from: 1, to: 3, type: 'weak' },
                        { from: 2, to: 4, type: 'weak' },
                        { from: 3, to: 6, type: 'weak' },
                        { from: 4, to: 5, type: 'weak' },
                        { from: 5, to: 7, type: 'weak' },
                        { from: 6, to: 7, type: 'weak' }
                    ],
                    source: 1,
                    description: 'Only <strong>weak ties</strong> connect nodes. Sparse connections mean slower spread but <strong>high diversity</strong> - each person reaches completely new social circles.'
                }
            },

            // Diffusion state
            nodeStates: new Map(), // id -> { hasInfo: bool, receivedAt: step, timesReceived: count }
            messages: [],
            totalMessages: 0,

            init() {
                this.loadScenario('dense');
            },

            loadScenario(scenarioName) {
                this.currentScenario = scenarioName;
                this.reset();

                // Update button states
                ['dense', 'bridge', 'weak', 'compare'].forEach(name => {
                    const btn = document.getElementById(`diffusion-${name}`);
                    if (btn) {
                        if (name === scenarioName) {
                            btn.classList.remove('secondary');
                            const colors = {
                                'dense': 'background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);',
                                'bridge': 'background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);',
                                'weak': 'background: linear-gradient(135deg, #10b981 0%, #059669 100%); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);',
                                'compare': 'background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);'
                            };
                            btn.style = `padding: 15px 30px; font-size: 1.05em; ${colors[name]}`;
                        } else {
                            btn.classList.add('secondary');
                            btn.style = 'padding: 15px 30px; font-size: 1.05em;';
                        }
                    }
                });

                // Update explanation
                const network = this.networks[scenarioName];
                document.getElementById('diffusion-description').innerHTML = network.description;
                document.querySelector('#diffusion-explanation h4').textContent = `üìñ Scenario: ${network.name}`;

                this.renderNetwork();
            },

            reset() {
                this.currentStep = 0;
                this.totalMessages = 0;
                this.pause();

                const network = this.networks[this.currentScenario];

                // Reset node states
                this.nodeStates.clear();
                network.nodes.forEach(node => {
                    this.nodeStates.set(node.id, {
                        hasInfo: node.id === network.source,
                        receivedAt: node.id === network.source ? 0 : null,
                        timesReceived: node.id === network.source ? 1 : 0
                    });
                });

                this.messages = [];
                this.renderNetwork();
                this.updateMetrics();
            },

            renderNetwork() {
                const network = this.networks[this.currentScenario];
                const edgesGroup = document.getElementById('diffusion-edges');
                const nodesGroup = document.getElementById('diffusion-nodes');

                if (!edgesGroup || !nodesGroup) return;

                // Clear existing
                edgesGroup.innerHTML = '';
                nodesGroup.innerHTML = '';

                // Draw edges
                network.edges.forEach(edge => {
                    const fromNode = network.nodes.find(n => n.id === edge.from);
                    const toNode = network.nodes.find(n => n.id === edge.to);

                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', fromNode.x);
                    line.setAttribute('y1', fromNode.y);
                    line.setAttribute('x2', toNode.x);
                    line.setAttribute('y2', toNode.y);
                    line.setAttribute('stroke', edge.type === 'strong' ? '#cbd5e1' : '#d1d5db');
                    line.setAttribute('stroke-width', edge.type === 'strong' ? '3' : '2');
                    line.setAttribute('stroke-dasharray', edge.type === 'weak' ? '5,5' : '0');
                    line.setAttribute('opacity', '0.6');
                    edgesGroup.appendChild(line);
                });

                // Draw nodes
                network.nodes.forEach(node => {
                    const state = this.nodeStates.get(node.id);

                    // Node circle
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', node.x);
                    circle.setAttribute('cy', node.y);
                    circle.setAttribute('r', '35');

                    if (state.hasInfo) {
                        circle.setAttribute('fill', 'url(#receivedGrad)');
                    } else {
                        circle.setAttribute('fill', 'url(#pendingGrad)');
                    }

                    circle.setAttribute('stroke', 'white');
                    circle.setAttribute('stroke-width', '3');
                    circle.setAttribute('filter', 'url(#dropShadow)');
                    circle.style.transition = 'all 0.6s ease';
                    nodesGroup.appendChild(circle);

                    // Label
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', node.x);
                    text.setAttribute('y', node.y + 6);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', 'white');
                    text.setAttribute('font-size', '20');
                    text.setAttribute('font-weight', 'bold');
                    text.setAttribute('pointer-events', 'none');
                    text.textContent = node.label;
                    nodesGroup.appendChild(text);

                    // Received count badge (if received multiple times)
                    if (state.timesReceived > 1) {
                        const badge = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        badge.setAttribute('cx', node.x + 20);
                        badge.setAttribute('cy', node.y - 20);
                        badge.setAttribute('r', '12');
                        badge.setAttribute('fill', '#ef4444');
                        badge.setAttribute('stroke', 'white');
                        badge.setAttribute('stroke-width', '2');
                        nodesGroup.appendChild(badge);

                        const badgeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                        badgeText.setAttribute('x', node.x + 20);
                        badgeText.setAttribute('y', node.y - 16);
                        badgeText.setAttribute('text-anchor', 'middle');
                        badgeText.setAttribute('fill', 'white');
                        badgeText.setAttribute('font-size', '12');
                        badgeText.setAttribute('font-weight', 'bold');
                        badgeText.textContent = state.timesReceived;
                        nodesGroup.appendChild(badgeText);
                    }
                });
            },

            step() {
                const network = this.networks[this.currentScenario];
                this.currentStep++;

                // Find nodes that have info and can send
                const sendingNodes = [];
                this.nodeStates.forEach((state, nodeId) => {
                    if (state.hasInfo) {
                        sendingNodes.push(nodeId);
                    }
                });

                // For each sending node, send to neighbors
                sendingNodes.forEach(senderId => {
                    // Find neighbors
                    const neighbors = network.edges
                        .filter(e => e.from === senderId || e.to === senderId)
                        .map(e => e.from === senderId ? e.to : e.from);

                    neighbors.forEach(neighborId => {
                        const neighborState = this.nodeStates.get(neighborId);

                        // Send message
                        this.totalMessages++;

                        // Mark as received if not yet received
                        if (!neighborState.hasInfo) {
                            neighborState.hasInfo = true;
                            neighborState.receivedAt = this.currentStep;
                        }

                        neighborState.timesReceived++;
                    });
                });

                this.renderNetwork();
                this.updateMetrics();

                // Check if complete
                let allReached = true;
                this.nodeStates.forEach(state => {
                    if (!state.hasInfo) allReached = false;
                });

                if (allReached) {
                    this.pause();
                    document.getElementById('diffusion-status-text').innerHTML = '<strong>üéâ Complete!</strong> All nodes reached.';
                }
            },

            updateMetrics() {
                const network = this.networks[this.currentScenario];

                // Count nodes reached
                let reached = 0;
                this.nodeStates.forEach(state => {
                    if (state.hasInfo) reached++;
                });

                const total = network.nodes.length;
                const percent = ((reached / total) * 100).toFixed(0);

                // Update UI
                document.getElementById('diffusion-step').textContent = this.currentStep;
                document.getElementById('diffusion-reached').textContent = reached;
                document.getElementById('diffusion-total').textContent = total;
                document.getElementById('diffusion-percent').textContent = `${percent}%`;
                document.getElementById('diffusion-messages').textContent = this.totalMessages;

                // Calculate redundancy
                const redundancy = reached > 0 ? (((this.totalMessages - reached) / this.totalMessages) * 100).toFixed(0) : 0;
                document.getElementById('diffusion-redundancy').textContent = `${redundancy}%`;

                // Update progress bar
                const progress = (reached / total) * 100;
                document.getElementById('diffusion-progress').style.width = `${progress}%`;
                document.getElementById('diffusion-progress-label').textContent = `Step ${this.currentStep}/${total * 2}`;

                // Update status
                if (reached < total) {
                    document.getElementById('diffusion-status-text').textContent = `Spreading... ${reached}/${total} nodes reached`;
                }
            },

            play() {
                if (this.isPlaying) return;

                this.isPlaying = true;
                const baseInterval = 1000;
                const interval = baseInterval / this.playbackSpeed;

                document.getElementById('diffusion-play').style.display = 'none';
                document.getElementById('diffusion-pause').style.display = 'inline-block';

                this.playInterval = setInterval(() => {
                    this.step();

                    // Check if all reached
                    const network = this.networks[this.currentScenario];
                    let allReached = true;
                    this.nodeStates.forEach(state => {
                        if (!state.hasInfo) allReached = false;
                    });

                    if (allReached || this.currentStep >= network.nodes.length * 2) {
                        this.pause();
                    }
                }, interval);
            },

            pause() {
                this.isPlaying = false;
                if (this.playInterval) {
                    clearInterval(this.playInterval);
                    this.playInterval = null;
                }

                document.getElementById('diffusion-play').style.display = 'inline-block';
                document.getElementById('diffusion-pause').style.display = 'none';
            },

            setSpeed(speed) {
                this.playbackSpeed = speed;

                // Update button states
                ['0.5', '1', '2'].forEach(s => {
                    const btn = document.getElementById(`diffusion-speed-${s}`);
                    if (btn) {
                        if (parseFloat(s) === speed) {
                            btn.classList.remove('secondary');
                            btn.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
                            btn.style.boxShadow = '0 4px 12px rgba(245, 158, 11, 0.3)';
                        } else {
                            btn.classList.add('secondary');
                            btn.style.background = '';
                            btn.style.boxShadow = '';
                        }
                    }
                });

                if (this.isPlaying) {
                    this.pause();
                    this.play();
                }
            }
        };

        // ========================================
        // BRIDGE IDENTIFICATION TOOL
        // ========================================

        const BridgeIdentifier = {
            currentScenario: 'social',
            selectedEdge: null,
            highlightMode: false,

            // Network configurations
            networks: {
                social: {
                    name: 'Social Network',
                    nodes: [
                        { id: 1, x: 150, y: 150, label: 'Alice' },
                        { id: 2, x: 300, y: 100, label: 'Bob' },
                        { id: 3, x: 300, y: 200, label: 'Carol' },
                        { id: 4, x: 450, y: 150, label: 'Dave' },  // Bridge
                        { id: 5, x: 550, y: 100, label: 'Eve' },
                        { id: 6, x: 550, y: 200, label: 'Frank' },
                        { id: 7, x: 350, y: 350, label: 'Grace' },
                        { id: 8, x: 200, y: 400, label: 'Henry' }
                    ],
                    edges: [
                        { id: 1, from: 1, to: 2, type: 'strong', active: true },
                        { id: 2, from: 1, to: 3, type: 'strong', active: true },
                        { id: 3, from: 2, to: 3, type: 'strong', active: true },
                        { id: 4, from: 3, to: 4, type: 'weak', active: true },  // Local bridge
                        { id: 5, from: 4, to: 5, type: 'strong', active: true },
                        { id: 6, from: 4, to: 6, type: 'strong', active: true },
                        { id: 7, from: 5, to: 6, type: 'strong', active: true },
                        { id: 8, from: 3, to: 7, type: 'weak', active: true },  // Local bridge
                        { id: 9, from: 7, to: 8, type: 'strong', active: true }
                    ]
                },

                professional: {
                    name: 'Professional Network',
                    nodes: [
                        { id: 1, x: 150, y: 200, label: 'CEO' },
                        { id: 2, x: 300, y: 150, label: 'CTO' },
                        { id: 3, x: 300, y: 250, label: 'CFO' },
                        { id: 4, x: 450, y: 100, label: 'Dev1' },
                        { id: 5, x: 450, y: 200, label: 'Dev2' },
                        { id: 6, x: 450, y: 300, label: 'Acc1' },
                        { id: 7, x: 600, y: 150, label: 'Ops' },
                        { id: 8, x: 600, y: 250, label: 'Sales' }
                    ],
                    edges: [
                        { id: 1, from: 1, to: 2, type: 'strong', active: true },
                        { id: 2, from: 1, to: 3, type: 'strong', active: true },
                        { id: 3, from: 2, to: 3, type: 'weak', active: true },
                        { id: 4, from: 2, to: 4, type: 'strong', active: true },
                        { id: 5, from: 2, to: 5, type: 'strong', active: true },
                        { id: 6, from: 3, to: 6, type: 'strong', active: true },
                        { id: 7, from: 4, to: 7, type: 'weak', active: true },  // Bridge
                        { id: 8, from: 6, to: 8, type: 'weak', active: true },  // Bridge
                        { id: 9, from: 7, to: 8, type: 'weak', active: true }
                    ]
                },

                community: {
                    name: 'Community Network',
                    nodes: [
                        { id: 1, x: 150, y: 150, label: 'N1' },
                        { id: 2, x: 150, y: 250, label: 'N2' },
                        { id: 3, x: 250, y: 200, label: 'N3' },
                        { id: 4, x: 400, y: 150, label: 'N4' },  // Super bridge
                        { id: 5, x: 550, y: 100, label: 'N5' },
                        { id: 6, x: 550, y: 200, label: 'N6' },
                        { id: 7, x: 400, y: 300, label: 'N7' },
                        { id: 8, x: 550, y: 350, label: 'N8' },
                        { id: 9, x: 650, y: 300, label: 'N9' }
                    ],
                    edges: [
                        { id: 1, from: 1, to: 2, type: 'strong', active: true },
                        { id: 2, from: 1, to: 3, type: 'strong', active: true },
                        { id: 3, from: 2, to: 3, type: 'strong', active: true },
                        { id: 4, from: 3, to: 4, type: 'weak', active: true },  // Critical bridge
                        { id: 5, from: 4, to: 5, type: 'strong', active: true },
                        { id: 6, from: 4, to: 6, type: 'strong', active: true },
                        { id: 7, from: 5, to: 6, type: 'strong', active: true },
                        { id: 8, from: 4, to: 7, type: 'weak', active: true },  // Critical bridge
                        { id: 9, from: 7, to: 8, type: 'strong', active: true },
                        { id: 10, from: 8, to: 9, type: 'strong', active: true }
                    ]
                }
            },

            init() {
                this.loadScenario('social');
            },

            loadScenario(scenarioName) {
                this.currentScenario = scenarioName;
                this.selectedEdge = null;
                this.highlightMode = false;

                // Reset all edges to active
                const network = this.networks[scenarioName];
                network.edges.forEach(edge => edge.active = true);

                // Update button states
                ['social', 'professional', 'community'].forEach(name => {
                    const btn = document.getElementById(`bridge-${name}`);
                    if (btn) {
                        if (name === scenarioName) {
                            btn.classList.remove('secondary');
                            btn.style = 'background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); padding: 15px 30px; font-size: 1.05em; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);';
                        } else {
                            btn.classList.add('secondary');
                            btn.style = 'padding: 15px 30px; font-size: 1.05em;';
                        }
                    }
                });

                this.analyzeNetwork();
                this.renderNetwork();
            },

            reset() {
                const network = this.networks[this.currentScenario];
                network.edges.forEach(edge => edge.active = true);
                this.selectedEdge = null;
                this.highlightMode = false;
                this.analyzeNetwork();
                this.renderNetwork();
            },

            analyzeNetwork() {
                const network = this.networks[this.currentScenario];

                // Count connected components
                const components = this.countComponents();

                // Identify critical bridges
                const criticalBridges = this.findCriticalBridges();

                // Identify local bridges
                const localBridges = this.findLocalBridges();

                // Calculate average betweenness
                const avgBetweenness = this.calculateAvgBetweenness();

                // Update UI
                document.getElementById('bridge-components').textContent = components;
                document.getElementById('bridge-critical-count').textContent = criticalBridges.length;
                document.getElementById('bridge-local-count').textContent = localBridges.length;
                document.getElementById('bridge-betweenness').textContent = avgBetweenness.toFixed(2);

                // Update status
                const statusEl = document.getElementById('bridge-connected-status');
                if (components === 1) {
                    statusEl.textContent = '‚úÖ Fully Connected';
                    statusEl.style.color = '#16a34a';
                } else {
                    statusEl.textContent = `‚ö†Ô∏è ${components} Disconnected Parts`;
                    statusEl.style.color = '#dc2626';
                }

                return { criticalBridges, localBridges };
            },

            countComponents() {
                const network = this.networks[this.currentScenario];
                const visited = new Set();
                let components = 0;

                const dfs = (nodeId) => {
                    visited.add(nodeId);
                    network.edges
                        .filter(e => e.active && (e.from === nodeId || e.to === nodeId))
                        .forEach(e => {
                            const neighbor = e.from === nodeId ? e.to : e.from;
                            if (!visited.has(neighbor)) {
                                dfs(neighbor);
                            }
                        });
                };

                network.nodes.forEach(node => {
                    if (!visited.has(node.id)) {
                        components++;
                        dfs(node.id);
                    }
                });

                return components;
            },

            findCriticalBridges() {
                const network = this.networks[this.currentScenario];
                const criticalBridges = [];
                const originalComponents = this.countComponents();

                network.edges.forEach(edge => {
                    if (!edge.active) return;

                    // Temporarily remove edge
                    edge.active = false;
                    const newComponents = this.countComponents();
                    edge.active = true;

                    // If components increased, it's a bridge
                    if (newComponents > originalComponents) {
                        criticalBridges.push(edge.id);
                    }
                });

                return criticalBridges;
            },

            findLocalBridges() {
                const network = this.networks[this.currentScenario];
                const localBridges = [];

                network.edges.forEach(edge => {
                    if (!edge.active) return;

                    // Get neighbors of both endpoints
                    const neighborsFrom = new Set(
                        network.edges
                            .filter(e => e.active && e.id !== edge.id && (e.from === edge.from || e.to === edge.from))
                            .map(e => e.from === edge.from ? e.to : e.from)
                    );

                    const neighborsTo = new Set(
                        network.edges
                            .filter(e => e.active && e.id !== edge.id && (e.from === edge.to || e.to === edge.to))
                            .map(e => e.from === edge.to ? e.to : e.from)
                    );

                    // Check if they have common neighbors
                    let hasCommonNeighbor = false;
                    for (const n of neighborsFrom) {
                        if (neighborsTo.has(n)) {
                            hasCommonNeighbor = true;
                            break;
                        }
                    }

                    if (!hasCommonNeighbor) {
                        localBridges.push(edge.id);
                    }
                });

                return localBridges;
            },

            calculateAvgBetweenness() {
                const network = this.networks[this.currentScenario];
                const activeEdges = network.edges.filter(e => e.active);
                if (activeEdges.length === 0) return 0;

                // Simplified betweenness: count shortest paths through each edge
                let totalBetweenness = 0;
                activeEdges.forEach(edge => {
                    totalBetweenness += this.edgeBetweenness(edge);
                });

                return totalBetweenness / activeEdges.length;
            },

            edgeBetweenness(edge) {
                // Simplified: count how many node pairs have this edge on shortest path
                const network = this.networks[this.currentScenario];
                let count = 0;

                // For efficiency, use a simple heuristic: edges with high degree endpoints have higher betweenness
                const degreeFrom = network.edges.filter(e => e.active && (e.from === edge.from || e.to === edge.from)).length;
                const degreeTo = network.edges.filter(e => e.active && (e.from === edge.to || e.to === edge.to)).length;

                return (degreeFrom + degreeTo) / 2;
            },

            renderNetwork() {
                const network = this.networks[this.currentScenario];
                const edgesGroup = document.getElementById('bridge-edges');
                const nodesGroup = document.getElementById('bridge-nodes');

                if (!edgesGroup || !nodesGroup) return;

                // Clear existing
                edgesGroup.innerHTML = '';
                nodesGroup.innerHTML = '';

                const { criticalBridges, localBridges } = this.analyzeNetwork();

                // Draw edges
                network.edges.forEach(edge => {
                    const fromNode = network.nodes.find(n => n.id === edge.from);
                    const toNode = network.nodes.find(n => n.id === edge.to);

                    // Edge hit area (wider, invisible)
                    const hitArea = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    hitArea.setAttribute('x1', fromNode.x);
                    hitArea.setAttribute('y1', fromNode.y);
                    hitArea.setAttribute('x2', toNode.x);
                    hitArea.setAttribute('y2', toNode.y);
                    hitArea.setAttribute('stroke', 'transparent');
                    hitArea.setAttribute('stroke-width', '20');
                    hitArea.style.cursor = 'pointer';
                    hitArea.onclick = () => this.toggleEdge(edge.id);
                    edgesGroup.appendChild(hitArea);

                    // Visible edge
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', fromNode.x);
                    line.setAttribute('y1', fromNode.y);
                    line.setAttribute('x2', toNode.x);
                    line.setAttribute('y2', toNode.y);

                    let strokeColor = '#94a3b8';
                    let strokeWidth = '2';
                    let opacity = edge.active ? '1' : '0.3';

                    if (edge.active) {
                        if (criticalBridges.includes(edge.id)) {
                            strokeColor = '#ef4444';
                            strokeWidth = '5';
                        } else if (localBridges.includes(edge.id)) {
                            strokeColor = '#f59e0b';
                            strokeWidth = '4';
                        }
                    }

                    line.setAttribute('stroke', strokeColor);
                    line.setAttribute('stroke-width', strokeWidth);
                    line.setAttribute('opacity', opacity);
                    line.setAttribute('stroke-linecap', 'round');
                    line.setAttribute('stroke-dasharray', edge.active ? '0' : '5,5');
                    line.style.transition = 'all 0.3s ease';
                    line.style.pointerEvents = 'none';

                    edgesGroup.appendChild(line);
                });

                // Draw nodes
                network.nodes.forEach(node => {
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', node.x);
                    circle.setAttribute('cy', node.y);
                    circle.setAttribute('r', '30');
                    circle.setAttribute('fill', 'url(#bridgeNodeGrad)');
                    circle.setAttribute('stroke', 'white');
                    circle.setAttribute('stroke-width', '3');
                    circle.setAttribute('filter', 'url(#nodeShadowBridge)');
                    nodesGroup.appendChild(circle);

                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', node.x);
                    text.setAttribute('y', node.y + 5);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', 'white');
                    text.setAttribute('font-size', '14');
                    text.setAttribute('font-weight', 'bold');
                    text.setAttribute('pointer-events', 'none');
                    text.textContent = node.label;
                    nodesGroup.appendChild(text);
                });
            },

            toggleEdge(edgeId) {
                const network = this.networks[this.currentScenario];
                const edge = network.edges.find(e => e.id === edgeId);
                if (!edge) return;

                edge.active = !edge.active;
                this.selectedEdge = edgeId;

                // Update selection info
                const fromNode = network.nodes.find(n => n.id === edge.from);
                const toNode = network.nodes.find(n => n.id === edge.to);

                const selectionText = document.getElementById('bridge-selection-text');
                if (edge.active) {
                    selectionText.innerHTML = `<strong>${fromNode.label} ‚Üî ${toNode.label}</strong><br>Active (click to remove)`;
                } else {
                    selectionText.innerHTML = `<strong>${fromNode.label} ‚Üî ${toNode.label}</strong><br>Removed (click to restore)`;
                }

                this.renderNetwork();
            },

            removeAllBridges() {
                const network = this.networks[this.currentScenario];
                const { criticalBridges } = this.analyzeNetwork();

                criticalBridges.forEach(bridgeId => {
                    const edge = network.edges.find(e => e.id === bridgeId);
                    if (edge) edge.active = false;
                });

                this.renderNetwork();
            },

            highlightCritical() {
                this.highlightMode = !this.highlightMode;
                this.renderNetwork();
            }
        };

        // ========================================
        // MODE TOGGLE (Research vs Illustrative)
        // ========================================

        let currentMode = 'illustrative';

        function toggleMode(mode) {
            currentMode = mode;

            // Update button states
            const illustrativeBtn = document.getElementById('mode-illustrative');
            const researchBtn = document.getElementById('mode-research');
            const description = document.getElementById('mode-description');

            if (mode === 'illustrative') {
                illustrativeBtn.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
                illustrativeBtn.classList.remove('secondary');
                researchBtn.style.background = 'linear-gradient(135deg, #64748b 0%, #475569 100%)';
                researchBtn.classList.add('secondary');

                description.innerHTML = `
                    <strong style="color: #d97706;">Current: Illustrative Mode</strong>
                    <p style="margin: 10px 0 0 0; line-height: 1.6;">Shows educational models with conceptual thresholds to help you understand network principles. Calculations are illustrative and based on Granovetter's concepts, but specific numerical thresholds are not empirically validated.</p>
                `;

                // Show all illustrative elements
                document.querySelectorAll('.illustrative-only').forEach(el => {
                    el.style.display = '';
                });
                document.querySelectorAll('.research-warning').forEach(el => {
                    el.style.display = 'none';
                });

            } else {
                illustrativeBtn.style.background = 'linear-gradient(135deg, #64748b 0%, #475569 100%)';
                illustrativeBtn.classList.add('secondary');
                researchBtn.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                researchBtn.classList.remove('secondary');

                description.innerHTML = `
                    <strong style="color: #059669;">Current: Research-Only Mode</strong>
                    <p style="margin: 10px 0 0 0; line-height: 1.6;">Shows only empirically validated findings from Granovetter (1973) and other peer-reviewed research. Qualitative relationships are displayed without numerical thresholds. Illustrative calculations are hidden.</p>
                `;

                // Hide illustrative elements
                document.querySelectorAll('.illustrative-only').forEach(el => {
                    el.style.display = 'none';
                });
                document.querySelectorAll('.research-warning').forEach(el => {
                    el.style.display = 'block';
                });
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            if (document.getElementById('networkCanvas')) {
                NetworkSimulator.init();
            }

            if (document.getElementById('strong-slider')) {
                JobSearchCalculator.init();
            }

            if (document.getElementById('strong-ties-count')) {
                ReachCalculator.init();
            }

            if (document.getElementById('triad-animation')) {
                TriadicClosure.init();
            }

            if (document.getElementById('diffusion-svg')) {
                InformationDiffusion.init();
            }

            if (document.getElementById('bridge-svg')) {
                BridgeIdentifier.init();
            }

            // Set default mode
            toggleMode('illustrative');
        });
    </script>
</body>
</html>
